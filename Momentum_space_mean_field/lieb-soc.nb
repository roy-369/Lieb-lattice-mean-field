(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    223736,       5129]
NotebookOptionsPosition[    211396,       4927]
NotebookOutlinePosition[    211787,       4943]
CellTagsIndexPosition[    211744,       4940]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Set Options", "Subsection",
 CellChangeTimes->{{3.814815516482966*^9, 
  3.814815518871624*^9}},ExpressionUUID->"07d6bec8-9c1e-46a2-ad2c-\
85f77428a471"],

Cell["Automating good looking plots", "Text",
 CellChangeTimes->{{3.815486899338563*^9, 
  3.815486918255589*^9}},ExpressionUUID->"a0560605-83d1-4d4a-9a3b-\
edb14d273790"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetOptions", "[", " ", 
   RowBox[{"DiscretePlot", ",", 
    RowBox[{"Joined", "\[Rule]", " ", "True"}], ",", " ", 
    RowBox[{"Filling", "\[Rule]", " ", "None"}], ",", 
    RowBox[{"Frame", "\[Rule]", " ", "True"}], ",", 
    RowBox[{"LabelStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontSize", "\[Rule]", "18"}], ",", 
       RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}], ",", "Black"}], 
      "}"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetOptions", "[", " ", 
   RowBox[{"ListPlot", ",", 
    RowBox[{"Joined", "\[Rule]", " ", "True"}], ",", " ", 
    RowBox[{"Filling", "\[Rule]", " ", "None"}], ",", 
    RowBox[{"Frame", "\[Rule]", " ", "True"}], ",", 
    RowBox[{"LabelStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontSize", "\[Rule]", "18"}], ",", 
       RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}], ",", "Black"}], 
      "}"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "Medium"}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"Black", ",", "Thick"}], "}"}]}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.795523983687091*^9, 3.795524053435053*^9}, {
  3.804245632637435*^9, 3.804245654217102*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"57f4e770-ffeb-464a-a3f2-12bb8e802f8c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SetOptions", "[", " ", 
    RowBox[{"ListContourPlot", ",", 
     RowBox[{"Frame", "\[Rule]", " ", "True"}], ",", 
     RowBox[{"LabelStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FontSize", "\[Rule]", "18"}], ",", 
        RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}], ",", "Black"}], 
       "}"}]}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}], ";", " ", 
   RowBox[{"SetOptions", "[", " ", 
    RowBox[{"ListDensityPlot", ",", 
     RowBox[{"Frame", "\[Rule]", " ", "True"}], ",", 
     RowBox[{"LabelStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FontSize", "\[Rule]", "18"}], ",", 
        RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}], ",", "Black"}], 
       "}"}]}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}], ";"}], 
  " "}]], "Input",
 CellChangeTimes->{{3.795523983687091*^9, 3.795524053435053*^9}, {
  3.797608872920074*^9, 3.797608893924059*^9}, {3.798814490659062*^9, 
  3.7988145000741367`*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"c8484170-dc42-4388-9bfa-e706337ff35a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SetOptions", "[", " ", 
    RowBox[{"ContourPlot", ",", 
     RowBox[{"Frame", "\[Rule]", " ", "True"}], ",", 
     RowBox[{"LabelStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FontSize", "\[Rule]", "18"}], ",", 
        RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}], ",", "Black"}], 
       "}"}]}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}], ";", " ", 
   RowBox[{"SetOptions", "[", " ", 
    RowBox[{"DensityPlot", ",", 
     RowBox[{"Frame", "\[Rule]", " ", "True"}], ",", 
     RowBox[{"LabelStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FontFamily", "\[Rule]", "\"\<CMU Serif\>\""}], ",", 
        RowBox[{"FontSize", "\[Rule]", "24"}], ",", "Black"}], "}"}]}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}], ";"}], 
  " "}]], "Input",
 CellChangeTimes->{{3.795523983687091*^9, 3.795524053435053*^9}, {
  3.797608872920074*^9, 3.797608893924059*^9}, {3.798814490659062*^9, 
  3.7988145000741367`*^9}, {3.822490398886307*^9, 3.822490401581625*^9}, {
  3.822492379117022*^9, 3.822492379407649*^9}, {3.822492682673697*^9, 
  3.82249268503117*^9}, {3.822492843076188*^9, 3.822492844015418*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"c84f6bab-d191-49b4-97da-328cca6f5599"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Parameters", "Subsection",
 CellChangeTimes->{{3.814815526355921*^9, 
  3.814815530775013*^9}},ExpressionUUID->"521b07db-c761-4814-a452-\
c7a75882d097"],

Cell["Lattice vectors, and basis vectors", "Text",
 CellChangeTimes->{{3.815486959258515*^9, 3.815486991960693*^9}, 
   3.815574952439453*^9},ExpressionUUID->"109ff662-d245-4168-b507-\
4c4fc8be8cee"],

Cell[BoxData[
 RowBox[{
  RowBox[{"a1", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0"}], "}"}]}], ";", 
  RowBox[{"a2", " ", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1"}], "}"}]}], ";", 
  RowBox[{"\[Tau]A", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["1", "2"], ",", "0"}], "}"}]}], ";", 
  RowBox[{"\[Tau]B", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}], ";", " ", 
  RowBox[{"\[Tau]C", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     FractionBox["1", "2"]}], "}"}]}], ";", 
  RowBox[{"\[Tau]vec", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"\[Tau]A", ",", "\[Tau]B", ",", " ", "\[Tau]C"}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7782376773198223`*^9, 3.7782376846375103`*^9}, {
  3.7888779095955067`*^9, 3.788877935042295*^9}, {3.789916165929564*^9, 
  3.789916168841158*^9}, {3.815088597001444*^9, 3.815088608742155*^9}, {
  3.815486964874069*^9, 3.815486998976728*^9}, {3.8155749341053333`*^9, 
  3.815574947688364*^9}, {3.8155749803607388`*^9, 3.815575002934292*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"15ff82a1-8e5b-4911-b659-fff841949832"],

Cell["Reciprocal lattice vectors", "Text",
 CellChangeTimes->{{3.8154870054478617`*^9, 
  3.815487011450121*^9}},ExpressionUUID->"c8d6a7fb-5260-4305-bf4c-\
ca053da22b04"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"LatMat", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"a1", ",", "a2"}], "}"}]}], ";"}], " "}], "\n", 
 RowBox[{
  RowBox[{"ReciLatMat", " ", "=", " ", 
   RowBox[{"2", "\[Pi]", " ", 
    RowBox[{
     RowBox[{"Inverse", "[", "LatMat", "]"}], "\[ConjugateTranspose]"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"b1", " ", "=", " ", 
   RowBox[{"ReciLatMat", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], " ", ";", 
  RowBox[{"b2", " ", "=", " ", 
   RowBox[{"ReciLatMat", "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.778237486576742*^9, 3.77823749632824*^9}, {
  3.81548701397711*^9, 3.8154870174866753`*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"06e050e9-e984-4927-8d8f-de7e65221802"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Delta]f", "=", 
   RowBox[{"N", "[", 
    FractionBox["1", 
     RowBox[{"2", 
      RowBox[{"\[Sqrt]", "2"}]}]], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.824421986577567*^9, 3.824421994517004*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"243d708e-790e-4496-b32e-bfdc3f4d2a79"],

Cell["\<\
kSpan : set of points for k-sums, and rSpan : set of points for r-sums\
\>", "Text",
 CellChangeTimes->{{3.815487024009077*^9, 
  3.815487044172222*^9}},ExpressionUUID->"3fa4ab7f-62b2-44da-9bde-\
b9f6ad7933a2"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"kSpan", "[", "krange_", "]"}], ":=", 
   RowBox[{"N", "[", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"i", "*", "b1"}], "+", 
         RowBox[{"j", "*", "b2"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", "0.999", ",", 
          RowBox[{"1", "/", "krange"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "0", ",", "0.999", ",", 
          RowBox[{"1", "/", "krange"}]}], "}"}]}], "]"}], ",", "1"}], "]"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.814530877387206*^9, 3.8145308955429773`*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"87e3d5d3-a22f-445e-ae66-fc4bc200d674"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"rSpan", "[", "range_", "]"}], ":=", 
   RowBox[{"N", "[", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"i", "*", "a1"}], "+", 
         RowBox[{"j", "*", "a2"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"-", "range"}], ",", "range"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"-", "range"}], ",", "range"}], "}"}]}], "]"}], ",", "1"}], 
     "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.813600539770727*^9, 3.8136005616725197`*^9}, {
  3.813601421754334*^9, 3.813601423253783*^9}, {3.813602488218361*^9, 
  3.813602489770925*^9}, {3.81360252635194*^9, 3.813602535457719*^9}, {
  3.818771007234784*^9, 3.818771013005999*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"778b0bcb-97f8-40f2-adfb-fce8d2ae31ca"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"inp", "[", 
    RowBox[{"a_", ",", "b_"}], "]"}], ":=", " ", 
   RowBox[{
    RowBox[{"Conjugate", "[", "a", "]"}], ".", "b"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.815094401281458*^9, 3.815094412382387*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"30d49982-d56b-4e99-9f7a-01480d359504"],

Cell["\<\
We will play around with k-range and range to check for convergence\
\>", "Text",
 CellChangeTimes->{{3.815487050286512*^9, 3.8154870628687763`*^9}, 
   3.815490112632347*^9},ExpressionUUID->"f8c62d69-2cf7-434a-b29e-\
16b6b5056622"]
}, Closed]],

Cell[CellGroupData[{

Cell["Bloch Hamiltonian", "Subsection",
 CellChangeTimes->{{3.824475546655573*^9, 
  3.824475558234083*^9}},ExpressionUUID->"7b353e65-dd20-44fa-b0f3-\
4b8d69c3346f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"akp", "[", 
    RowBox[{"\[Delta]_", ",", "k_"}], "]"}], " ", ":=", " ", 
   RowBox[{"N", "[", 
    RowBox[{
     FractionBox[
      RowBox[{"1", "+", "\[Delta]"}], "2"], " ", "+", " ", 
     RowBox[{
      FractionBox[
       RowBox[{"1", "-", "\[Delta]"}], "2"], " ", 
      RowBox[{"Exp", "[", 
       RowBox[{"I", " ", "k"}], "]"}]}]}], "]"}]}], ";", 
  RowBox[{
   RowBox[{"akm", "[", 
    RowBox[{"\[Delta]_", ",", "k_"}], "]"}], " ", ":=", " ", 
   RowBox[{"N", "[", 
    RowBox[{
     FractionBox[
      RowBox[{"1", "+", "\[Delta]"}], "2"], " ", "-", "  ", 
     RowBox[{
      FractionBox[
       RowBox[{"1", "-", "\[Delta]"}], "2"], " ", 
      RowBox[{"Exp", "[", 
       RowBox[{"I", " ", "k"}], "]"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.764004860341963*^9, {3.764004922838161*^9, 3.76400497068998*^9}, {
   3.7795461216582623`*^9, 3.779546123605147*^9}, {3.7815429262448874`*^9, 
   3.781542939741127*^9}, 3.82415278248423*^9, {3.8244755739076767`*^9, 
   3.824475587057776*^9}, {3.843143697116642*^9, 3.843143704746256*^9}, {
   3.843144539095167*^9, 3.84314456153981*^9}, {3.84314578053437*^9, 
   3.8431458425512447`*^9}, {3.843299177176813*^9, 3.843299184521215*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"fa4ce392-eb23-4152-ad5f-92c281a2914a"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"akp", "[", 
     RowBox[{"\[Delta]_", ",", "k_"}], "]"}], ":=", 
    RowBox[{"N", "[", 
     RowBox[{
      RowBox[{"Cos", "[", 
       FractionBox["k", "2"], "]"}], " ", "+", " ", 
      RowBox[{"I", " ", "\[Delta]", " ", 
       RowBox[{"Sin", "[", 
        FractionBox["k", "2"], "]"}]}]}], "]"}]}], ";", " ", 
   RowBox[{
    RowBox[{"akm", "[", 
     RowBox[{"\[Delta]_", ",", "k_"}], "]"}], ":=", 
    RowBox[{"N", "[", 
     RowBox[{
      RowBox[{"\[Delta]", " ", 
       RowBox[{"Cos", "[", 
        FractionBox["k", "2"], "]"}]}], " ", "-", " ", 
      RowBox[{"I", "  ", 
       RowBox[{"Sin", "[", 
        FractionBox["k", "2"], "]"}]}]}], "]"}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.843298873842297*^9, 3.8432988875291243`*^9}, {
  3.8432990185276203`*^9, 3.8432990259619083`*^9}, {3.8433003827349453`*^9, 
  3.843300384600471*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"dfbde7e1-93df-4de2-8bcb-675ba6b28a2e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", "hamLieb", "]"}], ";", 
  RowBox[{
   RowBox[{"hamLieb", "[", 
    RowBox[{"\[Lambda]_", ",", "\[Delta]_", ",", "k_"}], "]"}], " ", ":=", 
   " ", 
   RowBox[{
    RowBox[{"hamLieb", "[", 
     RowBox[{"\[Lambda]", ",", "\[Delta]", ",", "k"}], "]"}], " ", "=", " ", 
    RowBox[{"Module", "[", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"kx", " ", "=", 
         RowBox[{"k", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
        RowBox[{"ky", " ", "=", " ", 
         RowBox[{"k", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ",", 
        RowBox[{"\[Delta]x", " ", "=", " ", 
         RowBox[{"\[Delta]", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
        RowBox[{"\[Delta]y", " ", "=", " ", 
         RowBox[{"\[Delta]", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", " ", 
          RowBox[{"-", " ", 
           RowBox[{"akp", "[", 
            RowBox[{"\[Delta]x", ",", 
             RowBox[{"-", "kx"}]}], "]"}]}], ",", " ", 
          RowBox[{"\[Lambda]", "  ", 
           RowBox[{"akm", "[", 
            RowBox[{"\[Delta]x", ",", 
             RowBox[{"-", "kx"}]}], "]"}]}], ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", " ", 
          RowBox[{
           RowBox[{"-", "\[Lambda]"}], " ", 
           RowBox[{"akm", "[", 
            RowBox[{"\[Delta]x", ",", 
             RowBox[{"-", "kx"}]}], "]"}]}], ",", " ", 
          RowBox[{"-", " ", 
           RowBox[{"akp", "[", 
            RowBox[{"\[Delta]x", ",", 
             RowBox[{"-", "kx"}]}], "]"}]}], ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"akp", "[", 
            RowBox[{"\[Delta]x", ",", "kx"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"-", "\[Lambda]"}], " ", 
           RowBox[{"akm", "[", 
            RowBox[{"\[Delta]x", ",", "kx"}], "]"}]}], ",", "0", ",", "0", 
          ",", 
          RowBox[{"-", 
           RowBox[{"akp", "[", 
            RowBox[{"\[Delta]y", ",", "ky"}], "]"}]}], ",", " ", 
          RowBox[{"I", " ", "\[Lambda]", " ", 
           RowBox[{"akm", "[", 
            RowBox[{"\[Delta]y", ",", "ky"}], "]"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Lambda]", " ", 
           RowBox[{"akm", "[", 
            RowBox[{"\[Delta]x", ",", "kx"}], "]"}]}], ",", " ", 
          RowBox[{"-", " ", 
           RowBox[{"akp", "[", 
            RowBox[{"\[Delta]x", ",", "kx"}], "]"}]}], ",", "0", ",", "0", 
          ",", 
          RowBox[{"I", " ", "\[Lambda]", " ", 
           RowBox[{"akm", "[", 
            RowBox[{"\[Delta]y", ",", "ky"}], "]"}]}], ",", " ", 
          RowBox[{"-", " ", 
           RowBox[{"akp", "[", 
            RowBox[{"\[Delta]y", ",", "ky"}], "]"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", " ", 
          RowBox[{"-", " ", 
           RowBox[{"akp", "[", 
            RowBox[{"\[Delta]y", ",", 
             RowBox[{"-", "ky"}]}], "]"}]}], ",", " ", 
          RowBox[{
           RowBox[{"-", "I"}], " ", "\[Lambda]", "  ", 
           RowBox[{"akm", "[", 
            RowBox[{"\[Delta]y", ",", 
             RowBox[{"-", "ky"}]}], "]"}]}], ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", " ", 
          RowBox[{
           RowBox[{"-", "I"}], " ", "\[Lambda]", " ", 
           RowBox[{"akm", "[", 
            RowBox[{"\[Delta]y", ",", 
             RowBox[{"-", "ky"}]}], "]"}]}], ",", " ", 
          RowBox[{"-", " ", 
           RowBox[{"akp", "[", 
            RowBox[{"\[Delta]y", ",", 
             RowBox[{"-", "ky"}]}], "]"}]}], ",", "0", ",", "0"}], "}"}]}], 
       "}"}]}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.756319145758149*^9, 3.756319199391032*^9}, {
   3.756319254823587*^9, 3.756319259201173*^9}, {3.756319348399633*^9, 
   3.756319350388073*^9}, {3.7563253311737843`*^9, 3.7563253386032677`*^9}, 
   3.764004797023674*^9, {3.76400486982804*^9, 3.764004916241989*^9}, {
   3.764004975438292*^9, 3.7640050044324083`*^9}, {3.764024156913117*^9, 
   3.764024160642874*^9}, {3.764029189820718*^9, 3.76402919476404*^9}, {
   3.7640292789658823`*^9, 3.7640293060867*^9}, 3.764032841591424*^9, {
   3.7640883565234137`*^9, 3.764088359465539*^9}, {3.773141580247047*^9, 
   3.773141590793106*^9}, {3.773142347123101*^9, 3.7731423535381727`*^9}, {
   3.773162195172791*^9, 3.773162259226844*^9}, {3.779541394105826*^9, 
   3.7795414148062143`*^9}, {3.779541527327392*^9, 3.779541538584597*^9}, {
   3.7816131320104322`*^9, 3.7816131506671667`*^9}, {3.824152792811678*^9, 
   3.8241527958942337`*^9}, 3.824463448454859*^9, 3.824463706769917*^9, {
   3.824475590185144*^9, 3.824475594462983*^9}, {3.8426969252663918`*^9, 
   3.8426969594022923`*^9}, {3.842697128670679*^9, 3.842697144750228*^9}, {
   3.843143432999749*^9, 3.843143469619462*^9}, {3.843143611718019*^9, 
   3.84314367441998*^9}, {3.843144568138142*^9, 3.843144618893168*^9}, {
   3.8431446664655943`*^9, 3.8431449319766607`*^9}, {3.843149998678993*^9, 
   3.8431500253263063`*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"ca41ad49-43c1-4dff-a854-535549111d73"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Block", "[", " ", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Lambda]", "=", 
       RowBox[{"RandomReal", "[", "]"}]}], ",", 
      RowBox[{"\[Delta]", "=", 
       RowBox[{"RandomReal", "[", 
        RowBox[{"1", ",", "2"}], "]"}]}], ",", 
      RowBox[{"k", "=", 
       RowBox[{"RandomReal", "[", 
        RowBox[{
         RowBox[{"2", "\[Pi]"}], ",", "2"}], "]"}]}]}], "}"}], ",", 
    RowBox[{"hamLieb", "[", 
     RowBox[{"\[Lambda]", ",", "\[Delta]", ",", "k"}], "]"}]}], "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.843299423539338*^9, 3.843299472985465*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"aa5efb6d-c1b4-42eb-9ed8-640a83a43f6b"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", 
      RowBox[{
       RowBox[{"-", "0.8203144848634685`"}], "-", 
       RowBox[{"0.3723231052325164`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.04118578826501025`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.06710435422604491`", " ", "\[ImaginaryI]"}]}], "0", "0"},
     {"0", "0", 
      RowBox[{
       RowBox[{"-", "0.04118578826501025`"}], "+", 
       RowBox[{"0.06710435422604491`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.8203144848634685`"}], "-", 
       RowBox[{"0.3723231052325164`", " ", "\[ImaginaryI]"}]}], "0", "0"},
     {
      RowBox[{
       RowBox[{"-", "0.8203144848634685`"}], "+", 
       RowBox[{"0.3723231052325164`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.04118578826501025`"}], "-", 
       RowBox[{"0.06710435422604491`", " ", "\[ImaginaryI]"}]}], "0", "0", 
      RowBox[{
       RowBox[{"-", "0.555676908361962`"}], "+", 
       RowBox[{"0.3777400269075237`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.06808065418107301`"}], "+", 
       RowBox[{"0.12235292996780067`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.04118578826501025`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.06710435422604491`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.8203144848634685`"}], "+", 
       RowBox[{"0.3723231052325164`", " ", "\[ImaginaryI]"}]}], "0", "0", 
      RowBox[{
       RowBox[{"-", "0.06808065418107301`"}], "+", 
       RowBox[{"0.12235292996780067`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.555676908361962`"}], "+", 
       RowBox[{"0.3777400269075237`", " ", "\[ImaginaryI]"}]}]},
     {"0", "0", 
      RowBox[{
       RowBox[{"-", "0.555676908361962`"}], "-", 
       RowBox[{"0.3777400269075237`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.06808065418107301`"}], "-", 
       RowBox[{"0.12235292996780067`", " ", "\[ImaginaryI]"}]}], "0", "0"},
     {"0", "0", 
      RowBox[{
       RowBox[{"-", "0.06808065418107301`"}], "-", 
       RowBox[{"0.12235292996780067`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.555676908361962`"}], "-", 
       RowBox[{"0.3777400269075237`", " ", "\[ImaginaryI]"}]}], "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.8432994251979933`*^9, 3.843299474722761*^9}, 
   3.843299558860167*^9, 3.843300387583673*^9, 3.8435671746653843`*^9},
 CellLabel->
  "Out[16]//MatrixForm=",ExpressionUUID->"8ee94f92-33be-4d65-a6f1-\
02c49f369594"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Block", "[", " ", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Lambda]", "=", 
      RowBox[{"RandomReal", "[", "]"}]}], ",", 
     RowBox[{"\[Delta]", "=", 
      RowBox[{"RandomReal", "[", 
       RowBox[{"1", ",", "2"}], "]"}]}], ",", 
     RowBox[{"k", "=", 
      RowBox[{"RandomReal", "[", 
       RowBox[{
        RowBox[{"2", "\[Pi]"}], ",", "2"}], "]"}]}]}], "}"}], ",", 
   RowBox[{"HermitianMatrixQ", "[", " ", 
    RowBox[{"hamLieb", "[", 
     RowBox[{"\[Lambda]", ",", "\[Delta]", ",", "k"}], "]"}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.843145563845488*^9, 3.843145625726356*^9}, {
  3.843150029275066*^9, 3.843150031446156*^9}, {3.8432994613626423`*^9, 
  3.843299467078452*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"adb3880e-2bbf-4fd7-a51c-1c49fb4f4796"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.8431455950196323`*^9, 3.8431456270937557`*^9}, 
   3.843145783848523*^9, 3.843145846010182*^9, 3.8431500321165743`*^9, 
   3.8432918060445633`*^9, 3.8432988313139057`*^9, {3.8432990297531967`*^9, 
   3.843299032389187*^9}, {3.843299467836281*^9, 3.843299469082645*^9}, 
   3.843299558880905*^9, 3.843300387615568*^9, 3.8435671746846447`*^9},
 CellLabel->"Out[17]=",ExpressionUUID->"88b4777c-b2df-494e-be54-13a2b3f86196"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "EnerLieb", "]"}], ";", 
  RowBox[{
   RowBox[{"EnerLieb", "[", 
    RowBox[{"\[Lambda]_", ",", "\[Delta]_", ",", "k_"}], "]"}], " ", ":=", 
   " ", 
   RowBox[{
    RowBox[{"EnerLieb", "[", 
     RowBox[{"\[Lambda]", ",", "\[Delta]", ",", "k"}], "]"}], "=", " ", 
    RowBox[{"Chop", "[", "  ", 
     RowBox[{"N", "[", 
      RowBox[{"Sort", "[", 
       RowBox[{"Eigenvalues", "[", 
        RowBox[{"hamLieb", "[", 
         RowBox[{"\[Lambda]", ",", "\[Delta]", ",", "k"}], "]"}], " ", "]"}], 
       "]"}], "]"}], " ", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "ULiebG2", "]"}], ";", 
  RowBox[{
   RowBox[{"ULiebG2", "[", 
    RowBox[{"\[Lambda]_", ",", "\[Delta]_", ",", "k_"}], "]"}], " ", ":=", 
   RowBox[{
    RowBox[{"ULiebG2", "[", 
     RowBox[{"\[Lambda]", ",", "\[Delta]", ",", "k"}], "]"}], "=", 
    RowBox[{"Transpose", "[", 
     RowBox[{"Chop", "[", 
      RowBox[{"N", "[", "   ", 
       RowBox[{
        RowBox[{"Transpose", "[", " ", 
         RowBox[{"SortBy", "[", " ", 
          RowBox[{
           RowBox[{"Transpose", "[", " ", 
            RowBox[{"Eigensystem", "[", " ", 
             RowBox[{"hamLieb", "[", 
              RowBox[{"\[Lambda]", ",", "\[Delta]", ",", "k"}], "]"}], " ", 
             "]"}], " ", "]"}], " ", ",", "First"}], " ", "]"}], " ", "]"}], 
        "[", 
        RowBox[{"[", "2", "]"}], "]"}], " ", "]"}], " ", "]"}], " ", 
     "]"}]}]}], " ", ";"}]}], "Input",
 CellChangeTimes->{{3.7640176268418016`*^9, 3.764017681895791*^9}, {
   3.764021702190728*^9, 3.7640217419991283`*^9}, {3.764022209123415*^9, 
   3.764022240846314*^9}, {3.764022280257329*^9, 3.764022289529965*^9}, {
   3.76402355674361*^9, 3.76402374296489*^9}, {3.764024197834022*^9, 
   3.764024203283678*^9}, {3.764028125703156*^9, 3.764028132354926*^9}, {
   3.764032955658539*^9, 3.7640329669028063`*^9}, {3.773141720007655*^9, 
   3.773141737471712*^9}, {3.773141771580923*^9, 3.7731418460722857`*^9}, {
   3.773142347171556*^9, 3.773142353609971*^9}, {3.77314464335373*^9, 
   3.773144704735252*^9}, 3.773159680500445*^9, {3.77316222330879*^9, 
   3.7731622593013563`*^9}, {3.77954136696187*^9, 3.779541384616116*^9}, {
   3.779541430401513*^9, 3.779541463746334*^9}, {3.779543267484353*^9, 
   3.7795432791404457`*^9}, {3.779546992278311*^9, 3.77954699397375*^9}, {
   3.78161315469163*^9, 3.781613173495525*^9}, {3.787317050366681*^9, 
   3.787317093092341*^9}, {3.7890593724761753`*^9, 3.789059402708638*^9}, {
   3.7890609447420053`*^9, 3.789060946810433*^9}, 3.790275697889707*^9, {
   3.79060990371898*^9, 3.790609931505509*^9}, {3.793459113361217*^9, 
   3.793459166779313*^9}, {3.8244756508572197`*^9, 3.8244756842611027`*^9}, {
   3.842696930705386*^9, 3.842696952258564*^9}, {3.842697148442912*^9, 
   3.842697160459934*^9}, {3.843144935106803*^9, 3.843144960527883*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"541b3bc4-e2f7-4da1-849f-f725c496a9f9"],

Cell[CellGroupData[{

Cell["Plot Band Structure", "Subsubsection",
 CellChangeTimes->{{3.843145007221903*^9, 
  3.8431450100846663`*^9}},ExpressionUUID->"963bec16-021f-432e-bf75-\
faf5817239f6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Gama", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}], ";", " ", 
  RowBox[{"Xpoint", " ", "=", " ", 
   FractionBox["b1", "2"]}], ";", " ", 
  RowBox[{"Mpoint", " ", "=", " ", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"b1", "+", "b2"}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.843145011779606*^9, 3.843145050803084*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"e00ef0bf-99db-4f1c-a8ef-7ac91f3cde50"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BetAB", "[", " ", 
    RowBox[{"a_", ",", " ", "b_"}], "]"}], " ", "=", " ", 
   RowBox[{"Table", "[", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "i"}], ")"}], "*", "a"}], " ", "+", 
      RowBox[{"i", "*", "b"}]}], " ", ",", " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", "0.", ",", "1", ",", "0.01"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.778323704765098*^9, 3.778323751540586*^9}, {
   3.77832378820737*^9, 3.778323795796485*^9}, 3.7794654011099777`*^9, 
   3.7794703294591627`*^9, 3.819500446322987*^9, 3.819500648572233*^9, {
   3.819560414053316*^9, 3.819560414054927*^9}, {3.819560477372995*^9, 
   3.8195605042566643`*^9}, {3.819560534769074*^9, 3.819560536542474*^9}, 
   3.830518801599101*^9, 3.838658680373616*^9, 3.838659090520712*^9},
 CellLabel->"In[21]:=",ExpressionUUID->"25958d7b-b9a9-4c95-8991-5cdc4e5fef2c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"kCut", " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"BetAB", "[", " ", 
      RowBox[{"Gama", ",", "Xpoint"}], "]"}], "  ", ",", 
     RowBox[{"BetAB", "[", 
      RowBox[{"Xpoint", ",", "Mpoint"}], "]"}], ",", " ", 
     RowBox[{"BetAB", "[", 
      RowBox[{"Mpoint", ",", "Gama"}], "]"}]}], " ", "]"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.74810964786203*^9, 3.74810969632237*^9}, {
  3.748109782050322*^9, 3.748109819042285*^9}, {3.7481100210255833`*^9, 
  3.748110060200199*^9}, {3.778323755314966*^9, 3.778323813181221*^9}, {
  3.790683130439394*^9, 3.790683146469689*^9}, {3.790683366208458*^9, 
  3.7906833806849737`*^9}, {3.8195006859454308`*^9, 3.8195006937141542`*^9}, {
  3.83347187019991*^9, 3.833471886517868*^9}, {3.833893575381515*^9, 
  3.833893581082036*^9}, {3.838658532531341*^9, 3.838658548003003*^9}, {
  3.8386586295676527`*^9, 3.838658641219396*^9}, {3.842788124998848*^9, 
  3.8427881284258204`*^9}, {3.843145073606461*^9, 3.843145075057537*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"eb542c25-3330-43db-a07f-edb7fb5f05c2"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PlotDispData", "[", 
    RowBox[{"\[Lambda]_", ",", "\[Delta]_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Table", "[", " ", 
    RowBox[{
     RowBox[{"EnerLieb", "[", 
      RowBox[{"\[Lambda]", ",", "\[Delta]", ",", "k"}], "]"}], "  ", ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "kCut"}], "}"}]}], " ", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.778323827565771*^9, 3.778323872190329*^9}, {
   3.787964421065919*^9, 3.7879644216883087`*^9}, {3.7906830940342817`*^9, 
   3.790683111526882*^9}, {3.791676818584311*^9, 3.791676821577544*^9}, {
   3.791677391359765*^9, 3.791677393298375*^9}, {3.819313525933853*^9, 
   3.819313539186818*^9}, {3.819500467625799*^9, 3.8195005024785013`*^9}, {
   3.819558102312964*^9, 3.8195581047080812`*^9}, {3.8195604140623693`*^9, 
   3.81956041406735*^9}, {3.819560477378539*^9, 3.819560504262815*^9}, {
   3.8196744715308847`*^9, 3.819674487762649*^9}, {3.819674559085837*^9, 
   3.819674566296603*^9}, {3.830360138062561*^9, 3.8303601380684023`*^9}, {
   3.8303614088236094`*^9, 3.83036143818134*^9}, {3.830438176738779*^9, 
   3.83043817968642*^9}, 3.8304699198357677`*^9, {3.83865855717356*^9, 
   3.838658595138267*^9}, {3.8412325928214493`*^9, 3.841232595131571*^9}, {
   3.843145081089974*^9, 3.843145083573535*^9}, {3.843145353396695*^9, 
   3.843145365438648*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"05b47974-6cba-4218-b71b-c7730aa6fd07"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Block", "[", " ", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Lambda]", "=", "0.0"}], ",", 
     RowBox[{"\[Delta]", "=", 
      RowBox[{"{", 
       RowBox[{"0.1", ",", "0.1"}], "}"}]}]}], "}"}], ",", 
   RowBox[{"ListPlot", "[", 
    RowBox[{
     RowBox[{"Table", "[", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"PlotDispData", "[", 
         RowBox[{"\[Lambda]", ",", "\[Delta]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "i"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "6"}], "}"}]}], "]"}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", "Black"}], ",", "\[IndentingNewLine]", 
     RowBox[{"FrameTicks", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "\"\<\[CapitalGamma]\>\""}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"101", ",", "\"\<X\>\""}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"202", ",", "\"\<M\>\""}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"303", ",", "\"\<\[CapitalGamma]\>\""}], "}"}]}], "}"}], 
        ",", "Automatic"}], "}"}]}], ",", 
     RowBox[{"Joined", "\[Rule]", "True"}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"None", ",", "\"\<E/t\>\""}], "}"}]}], ",", 
     RowBox[{"AspectRatio", "\[Rule]", 
      RowBox[{"1", "/", "1"}]}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7783240490155287`*^9, 3.778324155717922*^9}, {
   3.778324207208721*^9, 3.77832425485364*^9}, {3.778325885340757*^9, 
   3.778325909046327*^9}, {3.779378727024583*^9, 3.779378768363958*^9}, {
   3.7793788338068733`*^9, 3.779378838616837*^9}, {3.787661427395136*^9, 
   3.787661469535961*^9}, {3.7877457555223083`*^9, 3.7877457588283653`*^9}, {
   3.7877535153759117`*^9, 3.7877535169034348`*^9}, {3.790683419793323*^9, 
   3.79068352878218*^9}, {3.7916768332246513`*^9, 3.791676841834642*^9}, {
   3.791677403287302*^9, 3.791677404721889*^9}, {3.819500512546789*^9, 
   3.819500641669775*^9}, {3.8195007051956263`*^9, 3.8195007257350473`*^9}, {
   3.819506449169252*^9, 3.819506504531117*^9}, {3.819558098018094*^9, 
   3.819558098490632*^9}, {3.819638347275592*^9, 3.819638367049605*^9}, {
   3.819638402506003*^9, 3.819638414920425*^9}, {3.81963844943221*^9, 
   3.819638462308112*^9}, {3.8196390338845873`*^9, 3.819639052818316*^9}, 
   3.8196399838295307`*^9, {3.819674496499384*^9, 3.819674499718501*^9}, {
   3.83036136332262*^9, 3.830361374191119*^9}, {3.830361441159091*^9, 
   3.830361441287136*^9}, {3.830361600468812*^9, 3.830361637463831*^9}, {
   3.830438173364493*^9, 3.830438187667831*^9}, {3.8305188071894493`*^9, 
   3.830518839584651*^9}, {3.8305188761235533`*^9, 3.83051888480195*^9}, {
   3.830601947267254*^9, 3.8306019517525187`*^9}, {3.8334718543725157`*^9, 
   3.833471855764276*^9}, {3.833471892310598*^9, 3.833471917146336*^9}, {
   3.8334719966034727`*^9, 3.833471996995653*^9}, {3.833473039005505*^9, 
   3.833473048132663*^9}, {3.83388076196933*^9, 3.8338807857885857`*^9}, {
   3.83389329101046*^9, 3.8338932946824303`*^9}, {3.833893587916748*^9, 
   3.833893592367838*^9}, {3.838658585947426*^9, 3.838658770866136*^9}, {
   3.838659096787232*^9, 3.838659103131481*^9}, {3.838993772569561*^9, 
   3.8389937729554777`*^9}, {3.8389938773394527`*^9, 3.838993926995823*^9}, {
   3.840617652278727*^9, 3.840617669477058*^9}, {3.84123259746625*^9, 
   3.8412325996684313`*^9}, {3.8412364103834953`*^9, 3.841236410756145*^9}, {
   3.842351098400609*^9, 3.842351170405456*^9}, {3.842787876157114*^9, 
   3.842787881295014*^9}, {3.842788133531035*^9, 3.842788137736175*^9}, {
   3.843145370186164*^9, 3.843145417483389*^9}, {3.843145515708486*^9, 
   3.843145538451483*^9}, 3.843145793290357*^9, {3.843145853604127*^9, 
   3.843145907619021*^9}, {3.843145973249507*^9, 3.843145990676817*^9}, {
   3.843150038880549*^9, 3.843150046891634*^9}, {3.843299040151825*^9, 
   3.843299054571854*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"3934de57-11ba-4d58-990c-f2d6f65781cf"],

Cell[BoxData[
 GraphicsBox[{{}, {{}, {}, 
    {GrayLevel[0], PointSize[0.004583333333333334], AbsoluteThickness[1.6], 
     LineBox[CompressedData["
1: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
ZWD7W/8GPLCtEg==
      "]]}, 
    {GrayLevel[0], PointSize[0.004583333333333334], AbsoluteThickness[1.6], 
     LineBox[CompressedData["
1:eJxd2HlYjGsfB/CxZU9STvbJUpElsiTKl1RKpWW0T01NzbQ3M+TYTSQKKYoj
S0OIbDmyO4yylRASHS0jlZIWbV5Leb3X+7vf63pP/3R9+vWdb808z/08z63r
H+kc2J3D4UzrxuH85/t/v5oXPJm3SXRE0XGHfgC1iAtvLP7nPtAblG42M41Z
A/dnxSgjDzNrwf6j1emOVGYdLP92zjtvP/NIPLnm5F27l5mL0NOnrHi7mceC
r635emA883iUxlZWa8cw68HWQBYUvoHZAGN7TJFqr2KehK/DTkwbFME8GZVu
J5u9ApmnIsnBbnSnF7MRbG4OQ5sT83SMzRv8fZE18wxU9no5uH4eszGiflwK
aJzGPBOrRe8+O4xjnoVN7ze8Uh/KPBunx+baGPVhnoOX4vEZl7+2k01w0VkW
cPQj81wk5f8c2vE3sylsGx7KruQzz0PF22Tb6uvM86Fvqp+49RSzGc5M9+Gl
7mM2R78c34d6McwLcGHsXZOpUmbgQcv537L5ZDmQ+Umr9aYNmy/E6bx7a2xm
sflCaH87uFbAZfNFyH+cUdWzP5svQkGC9UPT9jaaW8Bjvp2zWgVZboEjOtrF
oY/YfDGMbpzKjbzI5ouhLMo7OzSVzS0Rr917ceBmNreEn+N9b0EIm1th6GSL
+gHObG6F4aEpPSVz2dwaMW9TyxO4bG6NQzU1zyJ6s/kSuBw/uky7sZXmS2Bi
4d2+rYjMscFG+ZvVBTfY3AZdxXcv1irY3BadHa77K2PZ3BZ+PbpDGcbmS3H+
R5lqmzObL0XBOf0nC0zY3A7fvf6IahzF5naQBp8Sp/Zgc3vs7HfNzrauheb2
aB8zsq7nMzLHATFmA0c8z2bzXy5fVXI5lc2XofHe8Rk35Gy+DF82F9hWi9jc
EVGzpJ7m9mQ4YsaWtLMFxuz3HXG9L+fw/uFkpSP2r7+dcrIbyzshT2UxsFvd
Z8o74dj6nC3nC8lyJ/Ds9sivXCMrnRClzt/NPUrmOOOCzTCztjiWdwZPrUhr
7gqWd8YxL5tDHd4s74wgPzvHmdYs74K7e34qvk5neRfkzaposB/F8i7QbkiL
NunL8i6/zo+qXcr2Zsrz4KldoNdQSQYPdS5C8/uFZDkPEmFL2rI7ZCUPHuVz
6vecZ/nluGqTuDvlCMsvR3ap5kP+bpZfDo9tmUmf5Sy/HG49jLNcV7C8K/bP
Opa2R8TyrnDdbZWc6cnyrrgTPi4qfRnLu6Lv2ZWvoy1Z3g0rLvl/s5nP8m5o
sm3O+WnM8m7wnG947eRklnfDhn2nfi7UY3l3dJbzPIu4LO8Oyec0XcFIlndH
x+7+lh90WN4des/HLgkdyvIeEB2rQIMWy3ugddvm4nBm+T+s9MCQs8ZBjUNY
3hPCMU8nSDRZ3hOX79QYtA5ieU8MOTzm0O8DWN4TNbV6Nzt7s7wX+q+7/GJr
d5b3gq9qWDT3X02U98KB/I81pnVkpRc2nokq9npD5nhjrQVPGnOfDG/sixvx
/XIWy3uj33ZeyecDLO+N3Fsr986NZnk+4jWLXySIWJ4PtZ3n/VttWJ6PlJu9
jYINWZ6P53pXbFr6sbwP+l1zVCXWNlLeB8lCAyvre2S5D7iGaPrtCFnpg6/n
LKW9VpE5vmhYE79F047lfbHQtatrIZflfSF8NKl8X0sD5X0RqmNkppVL5ghQ
Pu6ex19JZK4Ax3jGe1N8yBDAfGRAiGIiWSDAbX5Z9LuWT/T6AtjNLzzsfYOs
EODp8wnHteVkpQAjBEmHNBaTVQJI0zKynNTIHD9MU303LHtQT/1+4D22WH91
Kxl++Hx88/TqRWSBH9IHmXWFdH2kfj+ERV65an+NrPCDz5S5rnskZKUfcq1C
2830ySo/2CizipaX1lG/P8Y8PuxWsZvM9UdYxlo11UIy/FGb/DaB31JL/f7Q
XbnsHv8oWe4PoY7B0RoHssIfR6/4Wnd9+0D9/jD1Sut25gRZ5Y8X70MWtzqQ
OUKoH//9QllHDfUL8fC48SDpYTKECHWN8cleRBYIYZ1+79H5mmrqF2JFUv+z
4jiyQojWcQ8O1kwiK4XIbcoSGj+uon4hGtoW9HcNIXMCUPVka4lrHzI3AHus
z3uYn3hP/QGYPXC8QHshWRAAHdEGjeq3ldQfgOT5TlVXosiKAGh1jLiUrE5W
BkDXWXhz+8l31P/r9VVO5w6bkTmBWK2hfrX8pYr6A3Hy/ei9bsFkBGKe6ZYZ
E39UUH8gNpg7H7ccT5YH4q7bylHcpeXUH4gtPp/ViiVl1B8IrdtqL2JTSqk/
ELuqvS15199SvwjumaNK/Ev/pn4RUkuMJvzdVUL9IthXZAVWc8kCEWbyzwzP
XvSG+kWYKovNWxvwmvpFwM3vH1bEFlO/CL0z//imOvWK+kXYVjy5tX9BEfWL
cfp+cvmS5pfUL8bk3Pq2L9pkiFFZwhu33ewF9YvRlfh90lrxc+oXY9zavlEB
yYXUL0a+86Z1TXHPqF+MmSYjI/q2PaF+Mc7smi/pFVxA/UHwjJtQM7U+n/qD
oNXcWW6+IY/6g2DIM50TPvYR9Qdh/OQy3U3lD6g/CMcyio2fXr5P/UHI1Gny
xrl71B8Ebb2cHL38XOoPQm1Yve7XwWROMFJt601r43KoPxjtguQIh9lkBGOA
8KeTznCy4B+WB2Ou9/vhHs5kRTCcuzWNmvCFrAxGP1H2kNJO1h+MUaP9Dui5
09/LCUFGWqxGRwf9P9wQzEqC4+YC+n8RgoknSsz1n9D7IwjBulwzJ3kTvX/y
EDy8fqhCbzK934oQ7J62RS/zNn0eyhCcFMRftWiiz0sVArmb9fyRevT5ckJx
u8tix1M/Oh64obC0jggwO0rHC0IxR/F66eb3dDwJQuHVZ/QNlT47/kLRNLRq
+61wOj4VoTg1yiZ3TzYdz8pfr/cuZW7bdzreVaFYvdLQP9qCzg9OGMIsz0z/
EE/nDzcMh3DoTOlzOr8QBud9xRs1dtL5KAhDx+2mbn9NpfNXHgahv3tCSSFZ
EYaZu7xHOcjY+R+GOJuGPT2H0PqhCkP8txxJ7Z9kTjjclqn/UePE1p9wZFRk
Dm1oIiMcvcRrOj/upPVMEI4sF3XzQgNaD+Xh6EyyTtiVS1aEIzom01GLz9bf
cHQNzpC7trP1NxwKzf7HrHbSes2JQOkG7Uuvddn6H4GMr9nczsts/Y9ATube
W5lL6PohiMDXO+nZRSXs+hOBB7Mbd0QG0/VJEYHEnRItyReyMgKVmhXBj7ew
618ESqoMGlaps+tvJIRCBYL2s+tvJE43XlicMppdzyNxcIuadls6WRCJnbqG
auv02f1FJOK3BaVzT5MVkWj7v/utSFwa57PDyYWsisTbP016zEli908SLNoR
VzfsKVlDAs3+r7p1sPtlrgQ3Y630Hy4mG0nQEeFpF7eR3W9LMDx131qTq2RH
CVLfO7wobCQLfr1e4sp4hwn0vCCR4IVOZPM5T/Z8IUHAlE5xfQI5UYK6ipGh
PXLICgkaBn+La2klZ0mw2aUy5PJ4ej5SStB9k1n+Eh65UAJdafza05vJKgk8
lvkGFF0gN0vQWh4W++Ate76SovuGmPb1avQ8qCFFgYuitG0amSuFXlTDekN3
spEUR+NfTxm9iQwpnhVp8/OPkx2l4JteT5iSRxZI0TllHt/yE1kihdRk15pB
6ux5WYqwfxmciZtKTpRiVSS38KI9WSHF5FVTy7aGkrOkSJn9sKzHdrJSCo0E
g7aJ6eRCKWLmhXh03CKrpLC7u4svfkVuloJbtUu87hN7fpdh5KXwdqPutD+h
IcN2NetDsWz/givDswD3Pusmko1kaDHX7BzA9kMgw8Dfxy2ft5TsKMNf47d2
7+VJFsjwfedW9WAxWSJDpMWLA6IVZLkM7WHRpT/Yfk6iDGUjhusZbiMrZGi9
fbCsOYGcJYPWkZho+xSyUgYz39cZYPtNhTL0SBzTlcf2o1QyOBhF2dSx/apm
Gdj+1r8BNH2rlg==
      "]]}, 
    {GrayLevel[0], PointSize[0.004583333333333334], AbsoluteThickness[1.6], 
     LineBox[CompressedData["
1:eJxdzU1uFlQUBuCDI4YdMHDA4IMQYoiBT0QEBXsBEVF+avnxF7hUioBCKys4
S+gS7hK6hLOELuEuoUswxoH5njM5efLmzXtia2dz+4OIOHck4t//3x2ux+q1
VR7Fa/gY/hAfxwt8Ep/Cp/FH+Az+GJ/FS/wJPo8/xRfwZ/gi/hxfwpfxF/hL
fAVfxV/hddxWnTiukeO4To7jBjmOr8lx3CTH8Q05jlvkOL4lx3GbHMd35Di+
J8dxhxzHXXIc98hx3CfHsbHqhhMXjh/o48SFY5M+Tlw4HtDHiQvHQ/o4ceF4
RB8nLhyP6ePEheNH+jhx4fiJPk5cOH6mjxMXjl/o48SF41f6OHHh+I0+Tlw4
ntDHiQvHU/o4ceF4Rh8nLhx91QvccMeJBy48cTxnHzfcceKBC08cW+zjhjtO
PHDhieN39nHDHSceuPDE8YJ93HDHiQcuPHFss48b7jjxwIUnjpfs44Y7Tjxw
4YnjD/Zxwx0nHrjwxPGKfdxwx4kHLjxxvGYfN9xx4oELTxxv2McNd5x44MIT
x5/s44Y7Tjxw4YnjL/Zxwx0nHrjwxPGWfdxwx4kHLjxxvGMfN9xx4oELTxw7
7OOGO048cOGJY3fVa3iBl7jhDdzxLk68hwfex4UP8MSHOP5e9Rpe4CVueAN3
vIsT7+GB93HhAzzxIY73q17DC7zEDW/gjndx4j088D4ufIAnPvzf/wCMcins

      "]]}, 
    {GrayLevel[0], PointSize[0.004583333333333334], AbsoluteThickness[1.6], 
     LineBox[CompressedData["
1:eJxdzU1uFlQUBuCDI4YdMHDA4IMQYoiBT0QEBXsBEVF+avnxF7hUioBCKys4
S+gS7hK6hLOELuEuoUswxoH5njM5efLmzXtia2dz+4OIOHck4t//3x2ux+q1
VR7Fa/gY/hAfxwt8Ep/Cp/FH+Az+GJ/FS/wJPo8/xRfwZ/gi/hxfwpfxF/hL
fAVfxV/hddxWnTiukeO4To7jBjmOr8lx3CTH8Q05jlvkOL4lx3GbHMd35Di+
J8dxhxzHXXIc98hx3CfHsbHqhhMXjh/o48SFY5M+Tlw4HtDHiQvHQ/o4ceF4
RB8nLhyP6ePEheNH+jhx4fiJPk5cOH6mjxMXjl/o48SF41f6OHHh+I0+Tlw4
ntDHiQvHU/o4ceF4Rh8nLhx91QvccMeJBy48cTxnHzfcceKBC08cW+zjhjtO
PHDhieN39nHDHSceuPDE8YJ93HDHiQcuPHFss48b7jjxwIUnjpfs44Y7Tjxw
4YnjD/Zxwx0nHrjwxPGKfdxwx4kHLjxxvGYfN9xx4oELTxxv2McNd5x44MIT
x5/s44Y7Tjxw4YnjL/Zxwx0nHrjwxPGWfdxwx4kHLjxxvGMfN9xx4oELTxw7
7OOGO048cOGJY3fVa3iBl7jhDdzxLk68hwfex4UP8MSHOP5e9Rpe4CVueAN3
vIsT7+GB93HhAzzxIY73q17DC7zEDW/gjndx4j088D4ufIAnPvzf/wCMcins

      "]]}, 
    {GrayLevel[0], PointSize[0.004583333333333334], AbsoluteThickness[1.6], 
     LineBox[CompressedData["
1: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
Jdjzrf8A/fcT1A==
      "]]}, 
    {GrayLevel[0], PointSize[0.004583333333333334], AbsoluteThickness[1.6], 
     LineBox[CompressedData["
1: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
2P7WfwDeZxSm
      "]]}}, {{}, {}}},
  AspectRatio->1,
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0., 0},
  DisplayFunction->Identity,
  Frame->{{True, True}, {True, True}},
  FrameLabel->{{
     FormBox["\"E/t\"", TraditionalForm], None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {{{1, 
       FormBox["\"\[CapitalGamma]\"", TraditionalForm]}, {101, 
       FormBox["\"X\"", TraditionalForm]}, {202, 
       FormBox["\"M\"", TraditionalForm]}, {303, 
       FormBox["\"\[CapitalGamma]\"", TraditionalForm]}}, {{1, 
       FormBox["\"\[CapitalGamma]\"", TraditionalForm]}, {101, 
       FormBox["\"X\"", TraditionalForm]}, {202, 
       FormBox["\"M\"", TraditionalForm]}, {303, 
       FormBox["\"\[CapitalGamma]\"", TraditionalForm]}}}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImageSize->Medium,
  LabelStyle->{FontSize -> 18, FontFamily -> "Times", 
    GrayLevel[0]},
  Method->{
   "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& )}},
  PlotRange->{{0., 303.}, {-1.4142135623730951`, 1.4142135623730954`}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.843145386738893*^9, 3.843145427541338*^9}, {
   3.843145516105618*^9, 3.843145539426497*^9}, {3.8431457899211493`*^9, 
   3.843145794017469*^9}, {3.843145851219824*^9, 3.843145908946116*^9}, {
   3.8431459600777683`*^9, 3.843145991518474*^9}, {3.843150042089878*^9, 
   3.84315004719217*^9}, 3.843291806850029*^9, 3.843298832215336*^9, {
   3.8432990353369627`*^9, 3.843299054943252*^9}, 3.843299559552238*^9, 
   3.84330038779014*^9, 3.843567175585799*^9},
 CellLabel->"Out[24]=",ExpressionUUID->"3608c241-e951-4fb4-87d7-0b9e74aa8b5a"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Analytic Flat-band Wavefunction", "Subsection",
 CellChangeTimes->{{3.843148185877363*^9, 
  3.843148191941456*^9}},ExpressionUUID->"c0db6db7-a07a-45d8-935c-\
5bf56c671aed"],

Cell[BoxData[
 RowBox[{
  RowBox[{"mat", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "a", ",", " ", "b", ",", " ", "0", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"-", "b"}], ",", " ", "a", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"ac", ",", " ", 
       RowBox[{"-", "bc"}], ",", "0", ",", "0", ",", "x", ",", 
       RowBox[{"I", " ", "y"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"bc", ",", " ", "ac", ",", "0", ",", "0", ",", 
       RowBox[{"I", " ", "y"}], ",", "x"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "xc", ",", " ", 
       RowBox[{
        RowBox[{"-", "I"}], " ", "yc"}], ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{
        RowBox[{"-", "I"}], " ", "yc"}], ",", " ", "xc", ",", "0", ",", "0"}],
       "}"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.843147375650366*^9, 3.843147420725939*^9}, {
  3.843147451367275*^9, 3.843147610504675*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"5bcf155a-c3f5-468b-a0e4-997b89f59807"],

Cell[BoxData[
 RowBox[{
  RowBox[{"vec1", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "bc"}], " ", "x"}], " ", "-", " ", 
        RowBox[{"I", " ", "ac", " ", "y"}]}], ")"}], 
      RowBox[{
       SuperscriptBox["ac", "2"], "+", 
       SuperscriptBox["bc", "2"]}]], ",", 
     FractionBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "ac"}], " ", "x"}], " ", "+", " ", 
        RowBox[{"I", " ", "bc", " ", "y"}]}], ")"}], 
      RowBox[{
       SuperscriptBox["ac", "2"], "+", 
       SuperscriptBox["bc", "2"]}]], " ", ",", "0", ",", "0", ",", "0", ",", 
     "1"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.843392652360798*^9, 3.843392762699297*^9}, {
   3.843395220413493*^9, 3.84339522414501*^9}, 3.843395408238636*^9},
 CellLabel->"In[26]:=",ExpressionUUID->"f0293f60-31aa-48b0-bdaa-261b3acaf7bb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"vec2", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", "1"}], ",", "0", ",", "0", ",", 
     FractionBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "x"}], " ", "bc"}], " ", "-", " ", 
        RowBox[{"I", " ", "y", " ", "ac"}]}], ")"}], 
      RowBox[{
       SuperscriptBox["x", "2"], "+", 
       SuperscriptBox["y", "2"]}]], ",", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "I"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "y"}], " ", "bc"}], " ", "+", " ", 
         RowBox[{"I", " ", "x", " ", "ac"}]}], ")"}]}], 
      RowBox[{
       SuperscriptBox["x", "2"], "+", 
       SuperscriptBox["y", "2"]}]]}], " ", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.843395234483493*^9, 3.8433953432351723`*^9}, {
  3.843395383250471*^9, 3.843395409757921*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"98980d56-b8d1-47cd-9d3b-b1c58248d909"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"mat", ".", 
    RowBox[{"(", 
     RowBox[{"vec1", "+", "vec2"}], ")"}]}], "//", "MatrixForm"}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.8433927641450357`*^9, 3.843392768939986*^9}, {
   3.843392861811687*^9, 3.843392864029428*^9}, 3.843395259470759*^9, {
   3.843395323220661*^9, 3.843395352551482*^9}, {3.843395394727582*^9, 
   3.843395419019497*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"de0a82f5-00e6-4a94-b8a7-79374154d2d7"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"0"},
      {"0"},
      {"0"},
      {"0"},
      {"0"},
      {"0"}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.843392769560643*^9, 3.8433927717008123`*^9}, 
   3.843392864727853*^9, {3.8433952259435062`*^9, 3.843395259957168*^9}, {
   3.8433952962574587`*^9, 3.843395352993672*^9}, {3.843395385595256*^9, 
   3.843395437925565*^9}, 3.843567175915079*^9},
 CellLabel->
  "Out[28]//MatrixForm=",ExpressionUUID->"4b976017-6af0-439a-9167-\
148b1ec2b9ea"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"Eigensystem", "[", "mat", "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.8431476125293293`*^9, 3.843147620636256*^9}, {
  3.843147710387644*^9, 3.843147725236436*^9}, {3.843300397343809*^9, 
  3.843300399737659*^9}, {3.843394383766246*^9, 3.843394384906931*^9}, {
  3.843395426053849*^9, 3.843395427779849*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"d222b2f6-c737-499e-b63a-8393ab2c0449"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"Eigensystem", "[", "mat", "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}], "[", 
   RowBox[{"[", "2", "]"}], "]"}], "*)"}]], "Input",
 CellChangeTimes->{
  3.843147734039688*^9, {3.8433004023181553`*^9, 3.843300404103217*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"813a1f18-93ba-4883-bbf5-bbf53967d8de"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", "waveF", "]"}], ";", 
  RowBox[{
   RowBox[{"waveF", "[", 
    RowBox[{"\[Lambda]_", ",", "\[Delta]_", ",", "k_"}], "]"}], " ", ":=", 
   " ", 
   RowBox[{
    RowBox[{"waveF", "[", 
     RowBox[{"\[Lambda]", ",", "\[Delta]", ",", "k"}], "]"}], "=", 
    RowBox[{"Normalize", "[", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"a", " ", "=", " ", 
          RowBox[{"-", " ", 
           RowBox[{"akp", "[", 
            RowBox[{
             RowBox[{"\[Delta]", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"-", 
              RowBox[{"k", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}]}]}], ",", 
         RowBox[{"b", "=", " ", 
          RowBox[{"\[Lambda]", "  ", 
           RowBox[{"akm", "[", 
            RowBox[{
             RowBox[{"\[Delta]", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"-", 
              RowBox[{"k", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}]}]}], ",", 
         RowBox[{"x", " ", "=", " ", 
          RowBox[{"-", 
           RowBox[{"akp", "[", 
            RowBox[{
             RowBox[{"\[Delta]", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"k", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}], ",", 
         RowBox[{"y", "=", " ", 
          RowBox[{"\[Lambda]", " ", 
           RowBox[{"akm", "[", 
            RowBox[{
             RowBox[{"\[Delta]", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"k", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}]}], "}"}], ",", " ", 
       
       RowBox[{"{", " ", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"-", " ", 
            RowBox[{"Conjugate", "[", "b", "]"}]}], " ", "x"}], " ", "-", " ", 
          RowBox[{"I", " ", 
           RowBox[{"Conjugate", "[", "a", "]"}], " ", "y"}]}], ",", "   ", 
         RowBox[{
          RowBox[{
           RowBox[{"-", " ", 
            RowBox[{"Conjugate", "[", "a", "]"}]}], " ", "x"}], " ", "+", " ", 
          RowBox[{"I", " ", 
           RowBox[{"Conjugate", "[", "b", "]"}], " ", "y"}]}], ",", "0", ",", 
         "0", ",", "0", ",", " ", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"Conjugate", "[", "b", "]"}], "2"], "+", " ", 
          SuperscriptBox[
           RowBox[{"Conjugate", "[", "a", "]"}], "2"]}]}], "}"}]}], "]"}], 
     "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.843147748536458*^9, 3.84314795272078*^9}, {
   3.8431500571244383`*^9, 3.843150068971902*^9}, 3.843395483503084*^9},
 CellLabel->"In[31]:=",ExpressionUUID->"d2ffc4c8-6a93-481c-bd7b-3e61ae3b461f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", "waveF2", "]"}], ";", 
  RowBox[{
   RowBox[{"waveF2", "[", 
    RowBox[{"\[Lambda]_", ",", "\[Delta]_", ",", "k_"}], "]"}], " ", ":=", 
   " ", 
   RowBox[{
    RowBox[{"waveF2", "[", 
     RowBox[{"\[Lambda]", ",", "\[Delta]", ",", "k"}], "]"}], "=", 
    RowBox[{"Normalize", "[", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"a", " ", "=", " ", 
          RowBox[{"-", " ", 
           RowBox[{"akp", "[", 
            RowBox[{
             RowBox[{"\[Delta]", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"-", 
              RowBox[{"k", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}]}]}], ",", 
         RowBox[{"b", "=", " ", 
          RowBox[{"\[Lambda]", "  ", 
           RowBox[{"akm", "[", 
            RowBox[{
             RowBox[{"\[Delta]", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"-", 
              RowBox[{"k", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}]}]}], ",", 
         RowBox[{"x", " ", "=", " ", 
          RowBox[{"-", 
           RowBox[{"akp", "[", 
            RowBox[{
             RowBox[{"\[Delta]", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"k", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}], ",", 
         RowBox[{"y", "=", " ", 
          RowBox[{"\[Lambda]", " ", 
           RowBox[{"akm", "[", 
            RowBox[{
             RowBox[{"\[Delta]", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"k", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}]}], "}"}], ",", " ", 
       
       RowBox[{"{", " ", 
        RowBox[{"0", ",", 
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["x", "2"]}], "-", 
          SuperscriptBox["y", "2"]}], ",", " ", "0", ",", "0", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"-", " ", "x"}], " ", 
           RowBox[{"Conjugate", "[", "b", "]"}]}], " ", "-", " ", 
          RowBox[{"I", " ", "y", " ", 
           RowBox[{"Conjugate", "[", "a", "]"}]}]}], ",", " ", 
         RowBox[{
          RowBox[{"I", " ", "y", " ", 
           RowBox[{"Conjugate", "[", "b", "]"}]}], "+", " ", 
          RowBox[{"x", " ", 
           RowBox[{"Conjugate", "[", "a", "]"}]}]}]}], " ", "}"}]}], "]"}], 
     "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.843147748536458*^9, 3.84314795272078*^9}, {
  3.843148040151705*^9, 3.8431480789901237`*^9}, {3.843148124285325*^9, 
  3.8431481275727453`*^9}, {3.843150072629993*^9, 3.8431500819620934`*^9}, {
  3.843395465177252*^9, 3.843395563256517*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"55f8820f-30f4-4933-813c-9f29cc329311"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Block", "[", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Lambda]", "=", 
        RowBox[{"RandomReal", "[", "]"}]}], ",", 
       RowBox[{"\[Delta]", "=", 
        RowBox[{"RandomReal", "[", 
         RowBox[{"1", ",", "2"}], "]"}]}], ",", 
       RowBox[{"k", "=", 
        RowBox[{"RandomReal", "[", 
         RowBox[{
          RowBox[{"2", "\[Pi]"}], ",", "2"}], "]"}]}]}], "}"}], ",", " ", 
     RowBox[{
      RowBox[{"hamLieb", "[", 
       RowBox[{"\[Lambda]", ",", "\[Delta]", ",", "k"}], "]"}], ".", 
      RowBox[{"waveF", "[", 
       RowBox[{"\[Lambda]", ",", "\[Delta]", ",", "k"}], "]"}]}]}], "]"}], "//",
    "MatrixForm"}], "//", "Chop"}]], "Input",
 CellChangeTimes->{{3.843147956947255*^9, 3.843148023099684*^9}, {
   3.843150085963258*^9, 3.8431500907041616`*^9}, 3.843395588330553*^9},
 CellLabel->"In[33]:=",ExpressionUUID->"c62f079f-9a25-4ba3-ae46-47ed97aa4685"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"0"},
      {"0"},
      {"0"},
      {"0"},
      {"0"},
      {"0"}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.8431479810831347`*^9, 3.8431480233635607`*^9}, 
   3.843148129461236*^9, {3.843150088492297*^9, 3.843150091120975*^9}, 
   3.843291818740735*^9, 3.843298843203533*^9, 3.8432990616846657`*^9, {
   3.843299484041415*^9, 3.843299485211478*^9}, 3.843299571087718*^9, 
   3.84329968290939*^9, 3.843300394732567*^9, {3.843395567867909*^9, 
   3.843395591132105*^9}, 3.8435671760385942`*^9},
 CellLabel->
  "Out[33]//MatrixForm=",ExpressionUUID->"c3ea0ced-4e70-4605-8828-\
e17863fdb1b9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Block", "[", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Lambda]", "=", 
        RowBox[{"RandomReal", "[", "]"}]}], ",", 
       RowBox[{"\[Delta]", "=", 
        RowBox[{"RandomReal", "[", 
         RowBox[{"1", ",", "2"}], "]"}]}], ",", 
       RowBox[{"k", "=", 
        RowBox[{"RandomReal", "[", 
         RowBox[{
          RowBox[{"2", "\[Pi]"}], ",", "2"}], "]"}]}]}], "}"}], ",", " ", 
     RowBox[{
      RowBox[{"hamLieb", "[", 
       RowBox[{"\[Lambda]", ",", "\[Delta]", ",", "k"}], "]"}], ".", 
      RowBox[{"waveF2", "[", 
       RowBox[{"\[Lambda]", ",", "\[Delta]", ",", "k"}], "]"}]}]}], "]"}], "//",
    "MatrixForm"}], "//", "Chop"}]], "Input",
 CellChangeTimes->{{3.843147956947255*^9, 3.843148023099684*^9}, 
   3.843148087914555*^9, {3.843150093628035*^9, 3.8431500959982758`*^9}, {
   3.843395572753598*^9, 3.843395579278881*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"309d1fc9-3236-4f1f-9876-8d0f6b8e5a7c"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"0"},
      {"0"},
      {"0"},
      {"0"},
      {"0"},
      {"0"}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.8431480881747437`*^9, 3.843148090898643*^9}, {
   3.843148131505232*^9, 3.843148132829245*^9}, 3.8431500963532248`*^9, 
   3.843291818750193*^9, 3.843298843214525*^9, 3.8432990617294807`*^9, 
   3.843299571122036*^9, 3.843299682964573*^9, 3.843300394764513*^9, {
   3.843395570333123*^9, 3.843395593130782*^9}, 3.843567176060334*^9},
 CellLabel->
  "Out[34]//MatrixForm=",ExpressionUUID->"392fe22f-6e14-4e91-bf19-\
c57bc0453251"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Block", "[", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Lambda]", "=", "0.6"}], ",", 
       RowBox[{"\[Delta]", "=", 
        RowBox[{"{", 
         RowBox[{"0.5", ",", "0.0"}], "}"}]}], ",", 
       RowBox[{"k", "=", 
        RowBox[{"RandomReal", "[", 
         RowBox[{
          RowBox[{"2", "\[Pi]"}], ",", "2"}], "]"}]}]}], "}"}], ",", " ", 
     RowBox[{
      RowBox[{"hamLieb", "[", 
       RowBox[{"\[Lambda]", ",", "\[Delta]", ",", "k"}], "]"}], ".", 
      RowBox[{"(", 
       RowBox[{"Normalize", "[", 
        RowBox[{
         RowBox[{"waveF", "[", 
          RowBox[{"\[Lambda]", ",", "\[Delta]", ",", "k"}], "]"}], "+", 
         RowBox[{"waveF2", "[", 
          RowBox[{"\[Lambda]", ",", "\[Delta]", ",", "k"}], "]"}]}], "]"}], 
       ")"}]}]}], "]"}], "//", "MatrixForm"}], "//", "Chop"}]], "Input",
 CellChangeTimes->{{3.843147956947255*^9, 3.843148023099684*^9}, {
  3.843150085963258*^9, 3.8431500907041616`*^9}, {3.843309421746578*^9, 
  3.8433094326474743`*^9}, {3.843395599177557*^9, 3.843395602332559*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"8dbde52f-833d-4065-a986-065fc4c64cc5"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"0"},
      {"0"},
      {"0"},
      {"0"},
      {"0"},
      {"0"}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.84330943423238*^9, 3.843309435810438*^9}, {
   3.843395595485197*^9, 3.843395602966937*^9}, 3.843395888942918*^9, 
   3.8435671761413193`*^9},
 CellLabel->
  "Out[35]//MatrixForm=",ExpressionUUID->"b1e60f56-1fe6-4195-87ff-\
644a91fd88a8"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"TRO", " ", "=", " ", 
   RowBox[{"KroneckerProduct", "[", "  ", 
    RowBox[{
     RowBox[{"IdentityMatrix", "[", "3", "]"}], ",", 
     RowBox[{"I", "  ", 
      RowBox[{"PauliMatrix", "[", "2", "]"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8433956262136183`*^9, 3.843395676694468*^9}, {
  3.843395907477312*^9, 3.843395910594388*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"fb7ec486-83cc-4afb-b50e-fb80ce48715a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Block", "[", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Lambda]", "=", "0.6"}], ",", 
       RowBox[{"\[Delta]", "=", 
        RowBox[{"{", 
         RowBox[{"0.5", ",", "0.0"}], "}"}]}], ",", 
       RowBox[{"k", "=", 
        RowBox[{"RandomReal", "[", 
         RowBox[{
          RowBox[{"2", "\[Pi]"}], ",", "2"}], "]"}]}]}], "}"}], ",", " ", 
     RowBox[{
      RowBox[{"hamLieb", "[", 
       RowBox[{"\[Lambda]", ",", "\[Delta]", ",", "k"}], "]"}], ".", 
      RowBox[{"(", 
       RowBox[{"TRO", ".", 
        RowBox[{"Conjugate", "[", 
         RowBox[{"Normalize", "[", 
          RowBox[{
           RowBox[{"waveF", "[", 
            RowBox[{"\[Lambda]", ",", "\[Delta]", ",", 
             RowBox[{"-", "k"}]}], "]"}], "+", 
           RowBox[{"waveF2", "[", 
            RowBox[{"\[Lambda]", ",", "\[Delta]", ",", 
             RowBox[{"-", "k"}]}], "]"}]}], "]"}], "]"}]}], ")"}]}]}], "]"}], 
   "//", "MatrixForm"}], "//", "Chop"}]], "Input",
 CellChangeTimes->{{3.843147956947255*^9, 3.843148023099684*^9}, {
  3.843150085963258*^9, 3.8431500907041616`*^9}, {3.843309421746578*^9, 
  3.8433094326474743`*^9}, {3.843395599177557*^9, 3.843395602332559*^9}, {
  3.843395896648555*^9, 3.843395897235723*^9}, {3.843395933101047*^9, 
  3.843395941270472*^9}, {3.843395971517281*^9, 3.843395977135898*^9}},
 CellLabel->"In[37]:=",ExpressionUUID->"e0bc3e8e-7381-4e81-acae-f7ed8f04ee87"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"0"},
      {"0"},
      {"0"},
      {"0"},
      {"0"},
      {"0"}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.843309442781814*^9, 3.8433094442128468`*^9}, {
   3.8433958245356703`*^9, 3.8433958495562572`*^9}, {3.843395897983626*^9, 
   3.843395985175482*^9}, 3.843567176216976*^9},
 CellLabel->
  "Out[37]//MatrixForm=",ExpressionUUID->"a01c514e-71c6-4ec6-93de-\
3fe85ff3e36e"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Wannier Functions", "Subsection",
 CellChangeTimes->{{3.843148198475766*^9, 
  3.8431482012566357`*^9}},ExpressionUUID->"e4ffa03c-d6e0-4129-a75b-\
62b04b669d13"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", "Psi", "]"}], ";", 
  RowBox[{
   RowBox[{"Psi", "[", 
    RowBox[{"\[Lambda]_", ",", "\[Delta]_", ",", "k_", ",", "band_"}], "]"}], 
   ":=", " ", 
   RowBox[{
    RowBox[{"Psi", "[", 
     RowBox[{"\[Lambda]", ",", "\[Delta]", ",", "k", ",", "band"}], "]"}], 
    "=", 
    RowBox[{"Module", "[", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"vec", " ", "=", 
         RowBox[{"Normalize", "[", 
          RowBox[{
           RowBox[{"waveF", "[", 
            RowBox[{"\[Lambda]", ",", "\[Delta]", ",", "k"}], "]"}], "+", " ", 
           RowBox[{"waveF2", "[", 
            RowBox[{"\[Lambda]", ",", "\[Delta]", ",", "k"}], "]"}]}], 
          "]"}]}], ",", " ", 
        RowBox[{"veck", " ", "=", 
         RowBox[{"Normalize", "[", 
          RowBox[{
           RowBox[{"waveF", "[", 
            RowBox[{"\[Lambda]", ",", "\[Delta]", ",", 
             RowBox[{"-", "k"}]}], "]"}], "+", " ", 
           RowBox[{"waveF2", "[", 
            RowBox[{"\[Lambda]", ",", "\[Delta]", ",", 
             RowBox[{"-", "k"}]}], "]"}]}], "]"}]}]}], "}"}], ",", "  ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"band", "==", "1"}], ",", " ", "vec", ",", 
        RowBox[{"TRO", ".", 
         RowBox[{"Conjugate", "[", "veck", "]"}]}]}], " ", "]"}]}], "]"}]}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.8431482333166037`*^9, 3.843148276048655*^9}, {
  3.843309449453875*^9, 3.843309462389009*^9}, {3.843395684085734*^9, 
  3.8433957040785418`*^9}, {3.843395947273642*^9, 3.843395967500442*^9}},
 CellLabel->"In[38]:=",ExpressionUUID->"760eca93-4128-42ff-b526-795a8dc88336"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Psi", "[", 
   RowBox[{
    RowBox[{"RandomReal", "[", "]"}], ",", 
    RowBox[{"RandomReal", "[", 
     RowBox[{"1", ",", "2"}], "]"}], ",", 
    RowBox[{"RandomReal", "[", 
     RowBox[{
      RowBox[{"2", "\[Pi]"}], ",", "2"}], "]"}], ",", "2"}], "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.843299502857885*^9, 3.843299528314045*^9}},
 CellLabel->"In[39]:=",ExpressionUUID->"eed8ba0f-ccc4-4e23-aa44-831b967cc90a"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{
        RowBox[{"-", "0.5264804104968288`"}], "-", 
        RowBox[{"0.30597232260964885`", " ", "\[ImaginaryI]"}]}]},
      {
       RowBox[{"0.1755738505342162`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.08797159739570896`", " ", "\[ImaginaryI]"}]}]},
      {
       RowBox[{"0.`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]},
      {
       RowBox[{"0.`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]},
      {
       RowBox[{"0.6261783344979712`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.3922701268899435`", " ", "\[ImaginaryI]"}]}]},
      {
       RowBox[{"0.18893679522488852`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.09466712515666026`", " ", "\[ImaginaryI]"}]}]}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.843299516920227*^9, 3.843299530997233*^9}, 
   3.843299571154793*^9, 3.843300394856729*^9, 3.8433094637157297`*^9, 
   3.843395706823207*^9, 3.843395988405573*^9, 3.843567176287093*^9},
 CellLabel->
  "Out[39]//MatrixForm=",ExpressionUUID->"952db435-6ca0-4ec5-871c-\
2d5d33c1e722"]
}, Open  ]],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   RowBox[{"Clear", "[", "WanFuPsi", "]"}], ";", 
   RowBox[{
    RowBox[{"WanFuPsi", "[", 
     RowBox[{
     "\[Lambda]_", ",", "\[Delta]_", ",", "r_", ",", "krange_", ",", 
      "band_"}], "]"}], " ", ":=", " ", 
    RowBox[{
     RowBox[{"WanFuPsi", "[", 
      RowBox[{
      "\[Lambda]", ",", "\[Delta]", ",", "r", ",", "krange", ",", "band"}], 
      "]"}], "=", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"Length", "[", 
        RowBox[{"kSpan", "[", "krange", "]"}], "]"}]], 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "I"}], " ", 
           RowBox[{"k", ".", "r"}]}], "]"}], "  ", 
         RowBox[{"Psi", "[", 
          RowBox[{"\[Lambda]", ",", "\[Delta]", ",", "k", ",", "band"}], 
          "]"}]}], " ", ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", 
          RowBox[{"kSpan", "[", "krange", "]"}]}], "}"}]}], 
       "]"}]}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.8003050187898483`*^9, 3.800305038187955*^9}, {
   3.800305071440014*^9, 3.8003050932081203`*^9}, {3.8003051309213657`*^9, 
   3.800305175728573*^9}, {3.800305244263239*^9, 3.8003052488335457`*^9}, {
   3.800305777673197*^9, 3.800305793435771*^9}, {3.8003062190947857`*^9, 
   3.800306220883829*^9}, {3.80030643800239*^9, 3.800306442566716*^9}, {
   3.800306760056932*^9, 3.8003067639950047`*^9}, 3.800306863099566*^9, {
   3.800306909908146*^9, 3.800306940928638*^9}, {3.800308244215928*^9, 
   3.800308252856188*^9}, {3.800312936005669*^9, 3.800312976476224*^9}, {
   3.801582801370409*^9, 3.8015828090699587`*^9}, {3.8015830577978783`*^9, 
   3.801583061611993*^9}, {3.815001430430615*^9, 3.815001472038039*^9}, {
   3.815003060173192*^9, 3.81500307550772*^9}, {3.815004250264629*^9, 
   3.8150042595398083`*^9}, {3.815004998373938*^9, 3.815005005574073*^9}, {
   3.8155887649252377`*^9, 3.815588766370058*^9}, {3.820870108366325*^9, 
   3.820870110728986*^9}, {3.820870153318808*^9, 3.820870161650014*^9}, {
   3.8212261543518877`*^9, 3.821226162086451*^9}, {3.8215482348281307`*^9, 
   3.821548256599382*^9}, {3.8297696200911303`*^9, 3.82976962842555*^9}, {
   3.829770027775894*^9, 3.829770035822721*^9}, {3.829774996995957*^9, 
   3.8297750198779583`*^9}, {3.842359155331789*^9, 3.842359160978551*^9}, {
   3.8431482889364634`*^9, 3.843148315058395*^9}},
 CellLabel->"In[40]:=",ExpressionUUID->"f41e80d9-a9da-4a41-a750-0598a8ddebbc"],

Cell["now it\[CloseCurlyQuote]s amplitude", "Text",
 CellChangeTimes->{{3.8155772712681637`*^9, 
  3.815577276432426*^9}},ExpressionUUID->"5088b1e8-9453-42a9-bde7-\
a5e70ac2e0d4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", "WFAmpPsi", "]"}], ";", 
  RowBox[{
   RowBox[{"WFAmpPsi", "[", 
    RowBox[{
    "\[Lambda]_", ",", "\[Delta]_", ",", "r_", ",", "krange_", ",", "band_"}],
     "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"WFAmpPsi", "[", 
     RowBox[{
     "\[Lambda]", ",", "\[Delta]", ",", "r", ",", "krange", ",", "band"}], 
     "]"}], " ", "=", "  ", 
    SuperscriptBox[
     RowBox[{"Norm", "[", 
      RowBox[{"WanFuPsi", "[", 
       RowBox[{
       "\[Lambda]", ",", "\[Delta]", ",", "r", ",", "krange", ",", "band"}], 
       "]"}], "]"}], "2"]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.814061047052541*^9, 3.814061081971715*^9}, {
   3.8140613132679358`*^9, 3.8140613209258337`*^9}, {3.814061867614917*^9, 
   3.8140618739964323`*^9}, {3.814526225672624*^9, 3.814526246553372*^9}, {
   3.814530929305427*^9, 3.814530946387762*^9}, {3.814555667192958*^9, 
   3.814555678956518*^9}, {3.814555716768759*^9, 3.8145557202627087`*^9}, 
   3.8148287374806347`*^9, {3.814829472346643*^9, 3.8148294795407*^9}, {
   3.814829663887882*^9, 3.814829664506455*^9}, {3.814997440958243*^9, 
   3.814997444825097*^9}, {3.814997511810871*^9, 3.814997512703998*^9}, {
   3.814998107491996*^9, 3.814998111587401*^9}, {3.8149985532143993`*^9, 
   3.814998574096179*^9}, {3.815000233546959*^9, 3.81500023754324*^9}, {
   3.8150015151321573`*^9, 3.8150015429678993`*^9}, {3.815003091108676*^9, 
   3.815003098991046*^9}, {3.8150042489391623`*^9, 3.815004269822768*^9}, {
   3.815005032952195*^9, 3.815005038645797*^9}, {3.8155772803911343`*^9, 
   3.815577286370541*^9}, {3.820870172103262*^9, 3.820870183158328*^9}, {
   3.8212261657895403`*^9, 3.821226171756369*^9}, {3.82154828259204*^9, 
   3.8215483032219667`*^9}, 3.8297648533247757`*^9, {3.829768992136484*^9, 
   3.8297689925831347`*^9}, {3.829769213258581*^9, 3.829769235652011*^9}, {
   3.8297699575301247`*^9, 3.829769962792742*^9}, {3.842359155333281*^9, 
   3.842359160980526*^9}, {3.843148320239407*^9, 3.8431483331310587`*^9}, {
   3.843150104457459*^9, 3.8431501077039433`*^9}, {3.843299703272574*^9, 
   3.843299736711049*^9}, {3.843299813234132*^9, 3.843299814502777*^9}, {
   3.843299854831952*^9, 3.843299869346923*^9}, {3.843300368622452*^9, 
   3.843300374232733*^9}},
 CellLabel->"In[41]:=",ExpressionUUID->"06492172-d07d-4453-8021-49ca3b27a6c3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Block", "[", " ", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Lambda]", "=", "0.5"}], ",", 
      RowBox[{"\[Delta]", "=", 
       RowBox[{"{", 
        RowBox[{"0.5", ",", "0.5"}], "}"}]}], ",", 
      RowBox[{"krange", "=", "50"}], ",", 
      RowBox[{"band", "=", "1"}], ",", 
      RowBox[{"r", "=", "\[Tau]B"}]}], "}"}], ",", " ", 
    RowBox[{"WanFuPsi", "[", 
     RowBox[{
     "\[Lambda]", ",", "\[Delta]", ",", "r", ",", "krange", ",", "band"}], 
     "]"}]}], "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.8432999001172457`*^9, 3.843299939984898*^9}, {
  3.843300268232553*^9, 3.8433002710578337`*^9}},
 CellLabel->"In[42]:=",ExpressionUUID->"8c0866db-2d33-4f5b-bada-30cf2555298f"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{"0.1536447099719228`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.14483237425728082`", " ", "\[ImaginaryI]"}]}]},
      {
       RowBox[{
        RowBox[{"-", "0.6292472051696381`"}], "+", 
        RowBox[{"0.08046833896647729`", " ", "\[ImaginaryI]"}]}]},
      {
       RowBox[{"0.`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]},
      {
       RowBox[{"0.`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]},
      {
       RowBox[{"0.14483237425728127`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.15364470997192273`", " ", "\[ImaginaryI]"}]}]},
      {
       RowBox[{"0.6292472051696371`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.08046833896647719`", " ", "\[ImaginaryI]"}]}]}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.8432999088651733`*^9, 3.8432999407678413`*^9}, {
   3.843300269451339*^9, 3.8433002719665127`*^9}, 3.843300395081304*^9, 
   3.843309468141391*^9, 3.8433957119960623`*^9, 3.843395992941758*^9, 
   3.8435671777220087`*^9},
 CellLabel->
  "Out[42]//MatrixForm=",ExpressionUUID->"cbc6b239-28f1-45ba-a138-\
98fe92143e2f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Block", "[", " ", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Lambda]", "=", "0.5"}], ",", 
      RowBox[{"\[Delta]", "=", 
       RowBox[{"{", 
        RowBox[{"0.5", ",", "0.5"}], "}"}]}], ",", 
      RowBox[{"krange", "=", "50"}], ",", 
      RowBox[{"band", "=", "1"}]}], "}"}], ",", 
    RowBox[{"WFAmpPsi", "[", 
     RowBox[{"\[Lambda]", ",", "\[Delta]", ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}], ",", "krange", ",", "band"}], " ", 
     "]"}]}], "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.843299584120433*^9, 3.8432996085737133`*^9}, {
  3.843299834490041*^9, 3.843299849901119*^9}},
 CellLabel->"In[43]:=",ExpressionUUID->"33f51db6-bbf9-48f3-b4e7-94e2f9c9af47"],

Cell[BoxData[
 TagBox["0.8940206246503624`",
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.843299599700365*^9, 3.8432996101989193`*^9}, 
   3.843299760643442*^9, 3.843299816392872*^9, {3.843299850377565*^9, 
   3.843299882184716*^9}, 3.843300395091*^9, 3.8433094703345737`*^9, 
   3.843395714253139*^9, 3.8433959942997026`*^9, 3.8435671778386917`*^9},
 CellLabel->
  "Out[43]//MatrixForm=",ExpressionUUID->"2f27efde-22b0-4f45-8cba-\
6a3eaaf322ed"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", "OmegaPsi", "]"}], ";", 
  RowBox[{
   RowBox[{"OmegaPsi", "[", " ", 
    RowBox[{
    "\[Lambda]_", ",", "\[Delta]_", ",", "range_", ",", "krange_", ",", 
     "band_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"OmegaPsi", "[", 
     RowBox[{
     "\[Lambda]", ",", "\[Delta]", ",", "range", ",", "krange", ",", "band"}],
      "]"}], " ", "=", "  ", 
    RowBox[{
     RowBox[{"Sum", "[", " ", 
      RowBox[{
       RowBox[{
        SuperscriptBox[
         RowBox[{"Norm", "[", "r", "]"}], "2"], " ", 
        RowBox[{"WFAmpPsi", "[", 
         RowBox[{
         "\[Lambda]", ",", "\[Delta]", ",", "r", ",", "krange", ",", "band"}],
          "]"}]}], " ", ",", 
       RowBox[{"{", 
        RowBox[{"r", ",", 
         RowBox[{"rSpan", "[", "range", "]"}]}], "}"}]}], "]"}], "-", " ", 
     SuperscriptBox[
      RowBox[{"Norm", "[", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"r", "  ", 
          RowBox[{"WFAmpPsi", "[", 
           RowBox[{
           "\[Lambda]", ",", "\[Delta]", ",", "r", ",", "krange", ",", 
            "band"}], "]"}]}], " ", ",", 
         RowBox[{"{", 
          RowBox[{"r", ",", 
           RowBox[{"rSpan", "[", "range", "]"}]}], "}"}]}], "]"}], "]"}], 
      "2"]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.815001974129306*^9, 3.8150020481505327`*^9}, {
   3.815002300771915*^9, 3.815002305991166*^9}, {3.815002835504603*^9, 
   3.815002856705762*^9}, {3.815003453469101*^9, 3.815003469165793*^9}, {
   3.815004237477398*^9, 3.815004243312793*^9}, {3.815005120566304*^9, 
   3.815005127627508*^9}, 3.815005375893948*^9, {3.820874581507372*^9, 
   3.8208745970347433`*^9}, {3.821226184827551*^9, 3.821226195075986*^9}, {
   3.8215483098241568`*^9, 3.8215483350626698`*^9}, 3.829764858708061*^9, 
   3.829765383457062*^9, {3.829769270410239*^9, 3.8297692998506317`*^9}, {
   3.842359155334971*^9, 3.8423591609838676`*^9}, {3.843148340922071*^9, 
   3.843148354942415*^9}, {3.843150109318657*^9, 3.8431501122725887`*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"50f17a72-c808-4249-9245-ac353d7315dd"],

Cell[CellGroupData[{

Cell["Wannier Checks", "Subsubsection",
 CellChangeTimes->{{3.843148382625979*^9, 
  3.843148384818675*^9}},ExpressionUUID->"2bf2be58-8411-4dfe-9f02-\
ee60aca83427"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Block", "[", " ", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Lambda]", "=", "0.5"}], ",", 
     RowBox[{"\[Delta]", "=", 
      RowBox[{"{", 
       RowBox[{"0.5", ",", "0.5"}], "}"}]}], ",", 
     RowBox[{"krange", "=", "50"}], ",", 
     RowBox[{"band", "=", "1"}]}], "}"}], ",", 
   RowBox[{"DiscretePlot", "[", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"OmegaPsi", "[", 
        RowBox[{
        "\[Lambda]", ",", "\[Delta]", ",", "range", ",", "krange", ",", "1"}],
         "]"}], ",", 
       RowBox[{"OmegaPsi", "[", 
        RowBox[{
        "\[Lambda]", ",", "\[Delta]", ",", "range", ",", "krange", ",", "2"}],
         "]"}]}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"range", ",", "0", ",", "7"}], "}"}], ",", " ", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<L\>\"", ",", "\"\<\[CapitalOmega](L)\>\""}], "}"}]}], ",", 
     RowBox[{"PlotMarkers", "\[Rule]", "Automatic"}]}], "]"}]}], " ", 
  "]"}]], "Input",
 CellChangeTimes->{{3.813600805600972*^9, 3.813600834541115*^9}, {
   3.813600903086605*^9, 3.8136009043002367`*^9}, {3.81360112890845*^9, 
   3.813601185301813*^9}, {3.813605418834491*^9, 3.813605424653018*^9}, {
   3.813605490488935*^9, 3.81360556366908*^9}, {3.813605690370112*^9, 
   3.813605693511613*^9}, {3.813606605723968*^9, 3.8136066114485607`*^9}, {
   3.813767956209711*^9, 3.8137679670699778`*^9}, {3.814061095327742*^9, 
   3.814061298888081*^9}, {3.814061344763476*^9, 3.814061474953114*^9}, {
   3.8140618816859303`*^9, 3.814061895631584*^9}, {3.814061973504552*^9, 
   3.814061974810357*^9}, {3.814115396686592*^9, 3.8141154228060637`*^9}, {
   3.8141154580979233`*^9, 3.814115461951931*^9}, {3.81411550627918*^9, 
   3.814115534599493*^9}, {3.8141155832597733`*^9, 3.814115584769106*^9}, {
   3.8141980937850227`*^9, 3.814198094024433*^9}, {3.814526246557188*^9, 
   3.81452626390835*^9}, {3.814532892387089*^9, 3.81453290058806*^9}, {
   3.814532935854517*^9, 3.8145329552491693`*^9}, {3.814533125455125*^9, 
   3.8145331359063187`*^9}, 3.81453328950214*^9, {3.814829075620737*^9, 
   3.81482912554979*^9}, {3.814829485079649*^9, 3.814829490062131*^9}, {
   3.814830160650456*^9, 3.81483016132519*^9}, {3.814830328876107*^9, 
   3.814830376447608*^9}, {3.814997449371251*^9, 3.81499747065108*^9}, {
   3.814998069246213*^9, 3.8149980754163094`*^9}, {3.814998126335026*^9, 
   3.814998162155624*^9}, {3.8149984977594843`*^9, 3.8149984981434526`*^9}, {
   3.814998587424605*^9, 3.814998593860832*^9}, {3.814998962048417*^9, 
   3.8149989645347843`*^9}, {3.814999600386599*^9, 3.814999626006773*^9}, {
   3.814999669889439*^9, 3.814999779167346*^9}, {3.814999821648656*^9, 
   3.81499983714587*^9}, {3.814999893764192*^9, 3.814999900175622*^9}, {
   3.814999947618758*^9, 3.814999957838522*^9}, {3.8149999957641287`*^9, 
   3.815000021701848*^9}, {3.8150002498268127`*^9, 3.815000251830853*^9}, {
   3.815000504758911*^9, 3.815000518507113*^9}, {3.815000548869317*^9, 
   3.815000574364752*^9}, {3.815000811335442*^9, 3.8150008117648563`*^9}, {
   3.8150020680446577`*^9, 3.8150021385690193`*^9}, {3.815002269752199*^9, 
   3.815002279108776*^9}, 3.8150023159524937`*^9, {3.815002691452055*^9, 
   3.815002695319477*^9}, {3.815002867203072*^9, 3.8150028861718483`*^9}, {
   3.81500347383895*^9, 3.81500347412427*^9}, {3.815004245106722*^9, 
   3.8150042452206593`*^9}, {3.815004357626356*^9, 3.8150043597274323`*^9}, {
   3.815005133685954*^9, 3.815005196308853*^9}, {3.8150055919955893`*^9, 
   3.815005594915248*^9}, 3.815006045342079*^9, {3.81500670993253*^9, 
   3.815006715826091*^9}, {3.81500713844979*^9, 3.815007166346148*^9}, {
   3.815579631992058*^9, 3.815579663769418*^9}, {3.815579760268038*^9, 
   3.815579760875236*^9}, {3.815580781021484*^9, 3.815580784944458*^9}, 
   3.81558609578966*^9, 3.81558613625261*^9, {3.820874606341387*^9, 
   3.820874629963027*^9}, {3.820874705622142*^9, 3.8208747059899282`*^9}, {
   3.820874738133113*^9, 3.8208747425543613`*^9}, {3.820874799239098*^9, 
   3.820874799615591*^9}, {3.821226230039641*^9, 3.821226236065284*^9}, {
   3.821228754960253*^9, 3.821228756095907*^9}, 3.8212326829397163`*^9, {
   3.8212327718091803`*^9, 3.821232813812845*^9}, {3.821462499472455*^9, 
   3.821462501754726*^9}, {3.8214626082240543`*^9, 3.821462621607834*^9}, {
   3.821548364732525*^9, 3.821548375675024*^9}, {3.821548444776218*^9, 
   3.8215484454423313`*^9}, 3.821809096032658*^9, 3.8218190007283897`*^9, {
   3.821819168472875*^9, 3.821819168681962*^9}, {3.821837385375387*^9, 
   3.821837385831822*^9}, {3.821892009881776*^9, 3.821892011322653*^9}, {
   3.8297648829947033`*^9, 3.829764887875752*^9}, {3.8297650706044483`*^9, 
   3.829765094861405*^9}, {3.829769311348921*^9, 3.829769313764249*^9}, {
   3.829769393101729*^9, 3.8297694026203938`*^9}, 3.829771778100522*^9, {
   3.829775361037127*^9, 3.8297753637772703`*^9}, {3.829775393902307*^9, 
   3.829775395418738*^9}, {3.830275507807228*^9, 3.830275527103528*^9}, 
   3.8423591609875383`*^9, 3.842788763510233*^9, {3.8431483967075243`*^9, 
   3.843148424912253*^9}, {3.8431484569470577`*^9, 3.843148507823834*^9}, 
   3.843148537908564*^9, 3.843299070048133*^9, {3.8432996449763193`*^9, 
   3.8432996477442636`*^9}},
 CellLabel->"In[45]:=",ExpressionUUID->"d44b50fd-3bb8-4fac-b937-d65ad69e289c"],

Cell[BoxData[
 GraphicsBox[{{{
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
      0.012833333333333334`], AbsoluteThickness[1.6], 
      TagBox[{},
       Annotation[#, "Charting`Private`Tag$20060#1"]& ]}, 
     {RGBColor[0.880722, 0.611041, 0.142051], PointSize[
      0.012833333333333334`], AbsoluteThickness[1.6], 
      TagBox[{},
       Annotation[#, "Charting`Private`Tag$20060#2"]& ]}}, {
     TagBox[
      {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
       0.012833333333333334`], AbsoluteThickness[1.6], 
       LineBox[{{{0., 0.}, {1., 0.10611714046613385`}, {2., 
        0.11131986869548158`}, {3., 0.11172851391602746`}, {4., 
        0.11176093775626798`}, {5., 0.11176386183024857`}, {6., 
        0.1117641573838831}, {7., 0.1117641885118738}}}], 
       GeometricTransformationBox[InsetBox[
         GraphicsBox[
          {EdgeForm[None], DiskBox[{0, 0}]},
          DefaultBaseStyle->{"Graphics", 
            Directive[
             PointSize[0.012833333333333334`], 
             RGBColor[0.368417, 0.506779, 0.709798], 
             AbsoluteThickness[1.6]]}], {0, 0}, Automatic, Offset[6.272]], {{{
        0., 0.}}, {{1., 0.10611714046613385`}}, {{2., 
        0.11131986869548158`}}, {{3., 0.11172851391602746`}}, {{4., 
        0.11176093775626798`}}, {{5., 0.11176386183024857`}}, {{6., 
        0.1117641573838831}}, {{7., 0.1117641885118738}}}], {}},
      Annotation[#, "Charting`Private`Tag$20060#1"]& ], 
     TagBox[
      {RGBColor[0.880722, 0.611041, 0.142051], PointSize[
       0.012833333333333334`], AbsoluteThickness[1.6], 
       LineBox[{{{0., 0.}, {1., 0.10611714046613381`}, {2., 
        0.11131986869548158`}, {3., 0.11172851391602745`}, {4., 
        0.11176093775626797`}, {5., 0.11176386183024858`}, {6., 
        0.11176415738388308`}, {7., 0.11176418851187377`}}}], 
       GeometricTransformationBox[InsetBox[
         GraphicsBox[
          {EdgeForm[None], PolygonBox[{{-1, -1}, {1, -1}, {1, 1}, {-1, 1}}]},
          DefaultBaseStyle->{"Graphics", 
            Directive[
             PointSize[0.012833333333333334`], 
             RGBColor[0.880722, 0.611041, 0.142051], 
             AbsoluteThickness[1.6]]}], {0, 0}, Automatic, Offset[6.72]], {{{
        0., 0.}}, {{1., 0.10611714046613381`}}, {{2., 
        0.11131986869548158`}}, {{3., 0.11172851391602745`}}, {{4., 
        0.11176093775626797`}}, {{5., 0.11176386183024858`}}, {{6., 
        0.11176415738388308`}}, {{7., 0.11176418851187377`}}}], {}},
      Annotation[#, "Charting`Private`Tag$20060#2"]& ]}}, {}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->True,
  FrameLabel->{
    FormBox["\"L\"", TraditionalForm], 
    FormBox["\"\[CapitalOmega](L)\"", TraditionalForm]},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImageSize->Medium,
  LabelStyle->{FontSize -> 18, FontFamily -> "Times", 
    GrayLevel[0]},
  Method->{
   "MessagesHead" -> DiscretePlot, "AxisPadding" -> Scaled[0.02], 
    "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "DefaultPlotStyle" -> {
      Directive[
       RGBColor[0.368417, 0.506779, 0.709798], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.880722, 0.611041, 0.142051], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.560181, 0.691569, 0.194885], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.922526, 0.385626, 0.209179], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.528488, 0.470624, 0.701351], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.772079, 0.431554, 0.102387], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.363898, 0.618501, 0.782349], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[1, 0.75, 0], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.647624, 0.37816, 0.614037], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.571589, 0.586483, 0.], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.915, 0.3325, 0.2125], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.40082222609352647`, 0.5220066643438841, 0.85], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.9728288904374106, 0.621644452187053, 0.07336199581899142], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.736782672705901, 0.358, 0.5030266573755369], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.28026441037696703`, 0.715, 0.4292089322474965], 
       AbsoluteThickness[1.6]]}, "DomainPadding" -> Scaled[0.02], 
    "PointSizeFunction" -> "SmallPointSize", "RangePadding" -> Scaled[0.05]},
  PlotRange->{{0, 7}, {0, 0.1117641885118738}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.843148425494769*^9, 3.8431485285786867`*^9}, 
   3.843298815538797*^9, 3.8432991411534967`*^9, 3.843299669676375*^9, {
   3.8432998027739563`*^9, 3.8432998208702908`*^9}, 3.843300417752329*^9, 
   3.843567201808906*^9},
 CellLabel->"Out[45]=",ExpressionUUID->"b8a5ecbd-fce8-443d-81cf-884d350c1aad"]
}, Open  ]],

Cell["Not much difference between spatial structure of 1 and 2", "Text",
 CellChangeTimes->{{3.843148542669037*^9, 
  3.8431485543034487`*^9}},ExpressionUUID->"1a10743a-a7d7-4d7c-bb07-\
f8e7a72568f6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Block", "[", " ", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Lambda]", "=", "0.25"}], ",", 
     RowBox[{"\[Delta]", "=", 
      RowBox[{"{", 
       RowBox[{"0.5", ",", "0.5"}], "}"}]}], ",", 
     RowBox[{"krange", "=", "50"}], ",", 
     RowBox[{"band", "=", "1"}]}], "}"}], ",", 
   RowBox[{"DiscretePlot", "[", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"OmegaPsi", "[", 
        RowBox[{
        "0.0", ",", "\[Delta]", ",", "range", ",", "krange", ",", "1"}], 
        "]"}], ",", 
       RowBox[{"OmegaPsi", "[", 
        RowBox[{
        "\[Lambda]", ",", "\[Delta]", ",", "range", ",", "krange", ",", "1"}],
         "]"}], ",", 
       RowBox[{"OmegaPsi", "[", 
        RowBox[{
         RowBox[{"2", " ", "\[Lambda]"}], ",", "\[Delta]", ",", "range", ",", 
         "krange", ",", "1"}], "]"}]}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"range", ",", "0", ",", "7"}], "}"}], ",", " ", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<L\>\"", ",", "\"\<\[CapitalOmega](L)\>\""}], "}"}]}], ",", 
     RowBox[{"PlotMarkers", "\[Rule]", "Automatic"}], ",", 
     RowBox[{"PlotLegends", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<\[Lambda]=0\>\"", ",", "\"\<\[Lambda]=0.25\>\"", ",", 
        "\"\<\[Lambda]=0.5\>\""}], "}"}]}], ",", 
     RowBox[{"PlotLabel", "\[Rule]", "\"\<\[Delta]=0.5\>\""}]}], "]"}]}], " ",
   "]"}]], "Input",
 CellChangeTimes->{{3.813600805600972*^9, 3.813600834541115*^9}, {
   3.813600903086605*^9, 3.8136009043002367`*^9}, {3.81360112890845*^9, 
   3.813601185301813*^9}, {3.813605418834491*^9, 3.813605424653018*^9}, {
   3.813605490488935*^9, 3.81360556366908*^9}, {3.813605690370112*^9, 
   3.813605693511613*^9}, {3.813606605723968*^9, 3.8136066114485607`*^9}, {
   3.813767956209711*^9, 3.8137679670699778`*^9}, {3.814061095327742*^9, 
   3.814061298888081*^9}, {3.814061344763476*^9, 3.814061474953114*^9}, {
   3.8140618816859303`*^9, 3.814061895631584*^9}, {3.814061973504552*^9, 
   3.814061974810357*^9}, {3.814115396686592*^9, 3.8141154228060637`*^9}, {
   3.8141154580979233`*^9, 3.814115461951931*^9}, {3.81411550627918*^9, 
   3.814115534599493*^9}, {3.8141155832597733`*^9, 3.814115584769106*^9}, {
   3.8141980937850227`*^9, 3.814198094024433*^9}, {3.814526246557188*^9, 
   3.81452626390835*^9}, {3.814532892387089*^9, 3.81453290058806*^9}, {
   3.814532935854517*^9, 3.8145329552491693`*^9}, {3.814533125455125*^9, 
   3.8145331359063187`*^9}, 3.81453328950214*^9, {3.814829075620737*^9, 
   3.81482912554979*^9}, {3.814829485079649*^9, 3.814829490062131*^9}, {
   3.814830160650456*^9, 3.81483016132519*^9}, {3.814830328876107*^9, 
   3.814830376447608*^9}, {3.814997449371251*^9, 3.81499747065108*^9}, {
   3.814998069246213*^9, 3.8149980754163094`*^9}, {3.814998126335026*^9, 
   3.814998162155624*^9}, {3.8149984977594843`*^9, 3.8149984981434526`*^9}, {
   3.814998587424605*^9, 3.814998593860832*^9}, {3.814998962048417*^9, 
   3.8149989645347843`*^9}, {3.814999600386599*^9, 3.814999626006773*^9}, {
   3.814999669889439*^9, 3.814999779167346*^9}, {3.814999821648656*^9, 
   3.81499983714587*^9}, {3.814999893764192*^9, 3.814999900175622*^9}, {
   3.814999947618758*^9, 3.814999957838522*^9}, {3.8149999957641287`*^9, 
   3.815000021701848*^9}, {3.8150002498268127`*^9, 3.815000251830853*^9}, {
   3.815000504758911*^9, 3.815000518507113*^9}, {3.815000548869317*^9, 
   3.815000574364752*^9}, {3.815000811335442*^9, 3.8150008117648563`*^9}, {
   3.8150020680446577`*^9, 3.8150021385690193`*^9}, {3.815002269752199*^9, 
   3.815002279108776*^9}, 3.8150023159524937`*^9, {3.815002691452055*^9, 
   3.815002695319477*^9}, {3.815002867203072*^9, 3.8150028861718483`*^9}, {
   3.81500347383895*^9, 3.81500347412427*^9}, {3.815004245106722*^9, 
   3.8150042452206593`*^9}, {3.815004357626356*^9, 3.8150043597274323`*^9}, {
   3.815005133685954*^9, 3.815005196308853*^9}, {3.8150055919955893`*^9, 
   3.815005594915248*^9}, 3.815006045342079*^9, {3.81500670993253*^9, 
   3.815006715826091*^9}, {3.81500713844979*^9, 3.815007166346148*^9}, {
   3.815579631992058*^9, 3.815579663769418*^9}, {3.815579760268038*^9, 
   3.815579760875236*^9}, {3.815580781021484*^9, 3.815580784944458*^9}, 
   3.81558609578966*^9, 3.81558613625261*^9, {3.820874606341387*^9, 
   3.820874629963027*^9}, {3.820874705622142*^9, 3.8208747059899282`*^9}, {
   3.820874738133113*^9, 3.8208747425543613`*^9}, {3.820874799239098*^9, 
   3.820874799615591*^9}, {3.821226230039641*^9, 3.821226236065284*^9}, {
   3.821228754960253*^9, 3.821228756095907*^9}, 3.8212326829397163`*^9, {
   3.8212327718091803`*^9, 3.821232813812845*^9}, {3.821462499472455*^9, 
   3.821462501754726*^9}, {3.8214626082240543`*^9, 3.821462621607834*^9}, {
   3.821548364732525*^9, 3.821548375675024*^9}, {3.821548444776218*^9, 
   3.8215484454423313`*^9}, 3.821809096032658*^9, 3.8218190007283897`*^9, {
   3.821819168472875*^9, 3.821819168681962*^9}, {3.821837385375387*^9, 
   3.821837385831822*^9}, {3.821892009881776*^9, 3.821892011322653*^9}, {
   3.8297648829947033`*^9, 3.829764887875752*^9}, {3.8297650706044483`*^9, 
   3.829765094861405*^9}, {3.829769311348921*^9, 3.829769313764249*^9}, {
   3.829769393101729*^9, 3.8297694026203938`*^9}, 3.829771778100522*^9, {
   3.829775361037127*^9, 3.8297753637772703`*^9}, {3.829775393902307*^9, 
   3.829775395418738*^9}, {3.830275507807228*^9, 3.830275527103528*^9}, 
   3.8423591609875383`*^9, 3.842788763510233*^9, {3.8431483967075243`*^9, 
   3.843148424912253*^9}, {3.8431484569470577`*^9, 3.843148507823834*^9}, {
   3.843148537908564*^9, 3.843148650517518*^9}, {3.8433004268513412`*^9, 
   3.843300429723723*^9}},
 CellLabel->"In[46]:=",ExpressionUUID->"3ec2c73c-94f4-4f0b-92cf-d2d5b5926417"],

Cell[BoxData[
 TemplateBox[{
   GraphicsBox[{{{{
        Directive[
         PointSize[0.012833333333333334`], 
         RGBColor[0.368417, 0.506779, 0.709798], 
         AbsoluteThickness[1.6]], 
        TagBox[{}, Annotation[#, "Charting`Private`Tag$22595#1"]& ]}, {
        Directive[
         PointSize[0.012833333333333334`], 
         RGBColor[0.880722, 0.611041, 0.142051], 
         AbsoluteThickness[1.6]], 
        TagBox[{}, Annotation[#, "Charting`Private`Tag$22595#2"]& ]}, {
        Directive[
         PointSize[0.012833333333333334`], 
         RGBColor[0.560181, 0.691569, 0.194885], 
         AbsoluteThickness[1.6]], 
        TagBox[{}, Annotation[#, "Charting`Private`Tag$22595#3"]& ]}}, {
       TagBox[{{
          Directive[
           PointSize[0.012833333333333334`], 
           RGBColor[0.368417, 0.506779, 0.709798], 
           AbsoluteThickness[1.6]], {
           
           LineBox[{{{0., 0.}, {1., 0.15560766740767276`}, {2., 
            0.1654045139396928}, {3., 0.16661445070758663`}, {4., 
            0.1667543036041579}, {5., 0.16677010530738443`}, {6., 
            0.16677188352979314`}, {7., 0.16677208404856173`}}}], Null, 
           GeometricTransformationBox[
            InsetBox[
             GraphicsBox[{
               EdgeForm[], 
               DiskBox[{0, 0}]}, {DefaultBaseStyle -> {"Graphics", 
                 Directive[
                  PointSize[0.012833333333333334`], 
                  RGBColor[0.368417, 0.506779, 0.709798], 
                  AbsoluteThickness[1.6]]}}], {0, 0}, Automatic, 
             Offset[6.272]], {{{0., 0.}}, {{1., 0.15560766740767276`}}, {{2., 
            0.1654045139396928}}, {{3., 0.16661445070758663`}}, {{4., 
            0.1667543036041579}}, {{5., 0.16677010530738443`}}, {{6., 
            0.16677188352979314`}}, {{7., 0.16677208404856173`}}}], {}}}}, 
        Annotation[#, "Charting`Private`Tag$22595#1"]& ], 
       TagBox[{{
          Directive[
           PointSize[0.012833333333333334`], 
           RGBColor[0.880722, 0.611041, 0.142051], 
           AbsoluteThickness[1.6]], {
           
           LineBox[{{{0., 0.}, {1., 0.1392695761060741}, {2., 
            0.14623880159707553`}, {3., 0.14680893947040743`}, {4., 
            0.14684579929763317`}, {5., 0.14684820672469184`}, {6., 
            0.14684841424933998`}, {7., 0.14684843613566673`}}}], Null, 
           GeometricTransformationBox[
            InsetBox[
             GraphicsBox[{
               EdgeForm[], 
               PolygonBox[{{-1, -1}, {1, -1}, {1, 1}, {-1, 1}}]}, {
              DefaultBaseStyle -> {"Graphics", 
                 Directive[
                  PointSize[0.012833333333333334`], 
                  RGBColor[0.880722, 0.611041, 0.142051], 
                  AbsoluteThickness[1.6]]}}], {0, 0}, Automatic, 
             Offset[6.72]], {{{0., 0.}}, {{1., 0.1392695761060741}}, {{2., 
            0.14623880159707553`}}, {{3., 0.14680893947040743`}}, {{4., 
            0.14684579929763317`}}, {{5., 0.14684820672469184`}}, {{6., 
            0.14684841424933998`}}, {{7., 0.14684843613566673`}}}], {}}}}, 
        Annotation[#, "Charting`Private`Tag$22595#2"]& ], 
       TagBox[{{
          Directive[
           PointSize[0.012833333333333334`], 
           RGBColor[0.560181, 0.691569, 0.194885], 
           AbsoluteThickness[1.6]], {
           
           LineBox[{{{0., 0.}, {1., 0.10611714046613385`}, {2., 
            0.11131986869548158`}, {3., 0.11172851391602746`}, {4., 
            0.11176093775626798`}, {5., 0.11176386183024857`}, {6., 
            0.1117641573838831}, {7., 0.1117641885118738}}}], Null, 
           GeometricTransformationBox[
            InsetBox[
             GraphicsBox[{
               EdgeForm[], 
               PolygonBox[{{0, 1}, {1, 0}, {0, -1}, {-1, 0}}]}, {
              DefaultBaseStyle -> {"Graphics", 
                 Directive[
                  PointSize[0.012833333333333334`], 
                  RGBColor[0.560181, 0.691569, 0.194885], 
                  AbsoluteThickness[1.6]]}}], {0, 0}, Automatic, 
             Offset[8.16]], {{{0., 0.}}, {{1., 0.10611714046613385`}}, {{2., 
            0.11131986869548158`}}, {{3., 0.11172851391602746`}}, {{4., 
            0.11176093775626798`}}, {{5., 0.11176386183024857`}}, {{6., 
            0.1117641573838831}}, {{7., 0.1117641885118738}}}], {}}}}, 
        Annotation[#, "Charting`Private`Tag$22595#3"]& ]}}, {}, {}}, {
    DisplayFunction -> Identity, AspectRatio -> 
     NCache[GoldenRatio^(-1), 0.6180339887498948], Axes -> True, 
     AxesOrigin -> {0, 0}, Frame -> True, FrameLabel -> {
       FormBox["\"L\"", TraditionalForm], 
       FormBox["\"\[CapitalOmega](L)\"", TraditionalForm]}, 
     FrameTicks -> {{Automatic, Automatic}, {Automatic, Automatic}}, 
     GridLines -> {None, None}, GridLinesStyle -> Directive[
       GrayLevel[0.5, 0.4]], ImageSize -> Medium, 
     LabelStyle -> {FontSize -> 18, FontFamily -> "Times", 
       GrayLevel[0]}, 
     Method -> {
      "MessagesHead" -> DiscretePlot, "AxisPadding" -> Scaled[0.02], 
       "DefaultBoundaryStyle" -> Automatic, 
       "DefaultGraphicsInteraction" -> {
        "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
         "Effects" -> {
          "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
           "Droplines" -> {
            "freeformCursorMode" -> True, 
             "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
       "DefaultMeshStyle" -> AbsolutePointSize[6], "DefaultPlotStyle" -> {
         Directive[
          RGBColor[0.368417, 0.506779, 0.709798], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[0.880722, 0.611041, 0.142051], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[0.560181, 0.691569, 0.194885], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[0.922526, 0.385626, 0.209179], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[0.528488, 0.470624, 0.701351], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[0.772079, 0.431554, 0.102387], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[0.363898, 0.618501, 0.782349], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[1, 0.75, 0], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[0.647624, 0.37816, 0.614037], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[0.571589, 0.586483, 0.], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[0.915, 0.3325, 0.2125], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[0.40082222609352647`, 0.5220066643438841, 0.85], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[
          0.9728288904374106, 0.621644452187053, 0.07336199581899142], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[0.736782672705901, 0.358, 0.5030266573755369], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[0.28026441037696703`, 0.715, 0.4292089322474965], 
          AbsoluteThickness[1.6]]}, "DomainPadding" -> Scaled[0.02], 
       "PointSizeFunction" -> "SmallPointSize", "RangePadding" -> 
       Scaled[0.05]}, PlotLabel -> 
     FormBox["\"\[Delta]=0.5\"", TraditionalForm], 
     PlotRange -> {{0, 7}, {0, 0.16677208404856173`}}, PlotRangeClipping -> 
     True, PlotRangePadding -> {{
        Scaled[0.02], 
        Scaled[0.02]}, {
        Scaled[0.05], 
        Scaled[0.05]}}, Ticks -> {Automatic, Automatic}}], 
   FormBox[
    FormBox[
     TemplateBox[{
      "\"\[Lambda]=0\"", "\"\[Lambda]=0.25\"", "\"\[Lambda]=0.5\""}, 
      "PointLegend", DisplayFunction -> (FormBox[
        StyleBox[
         StyleBox[
          PaneBox[
           TagBox[
            GridBox[{{
               TagBox[
                GridBox[{{
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 6.272}, {20, 6.272}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[1.6]], {
                    InsetBox[
                    GraphicsBox[{
                    EdgeForm[], 
                    DiskBox[{0, 0}]}, {DefaultBaseStyle -> {"Graphics", {
                    AbsolutePointSize[6]}, 
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[1.6]]}}], 
                    NCache[
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}], 
                    Scaled[{0.5, 0.5}]], Automatic, 
                    Scaled[1]]}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 6.272}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[-0.47966836734693874`] -> 
                    Baseline)], #}, {
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 6.72}, {20, 6.72}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    AbsoluteThickness[1.6]], {
                    InsetBox[
                    GraphicsBox[{
                    EdgeForm[], 
                    PolygonBox[{{-1, -1}, {1, -1}, {1, 1}, {-1, 1}}]}, {
                    DefaultBaseStyle -> {"Graphics", {
                    AbsolutePointSize[6]}, 
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    AbsoluteThickness[1.6]]}}], 
                    NCache[
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}], 
                    Scaled[{0.5, 0.5}]], Automatic, 
                    Scaled[1]]}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 6.72}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[-0.420357142857143] -> 
                    Baseline)], #2}, {
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.560181, 0.691569, 0.194885], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 8.16}, {20, 8.16}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.560181, 0.691569, 0.194885], 
                    AbsoluteThickness[1.6]], {
                    InsetBox[
                    GraphicsBox[{
                    EdgeForm[], 
                    PolygonBox[{{0, 1}, {1, 0}, {0, -1}, {-1, 0}}]}, {
                    DefaultBaseStyle -> {"Graphics", {
                    AbsolutePointSize[6]}, 
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.560181, 0.691569, 0.194885], 
                    AbsoluteThickness[1.6]]}}], 
                    NCache[
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}], 
                    Scaled[{0.5, 0.5}]], Automatic, 
                    Scaled[1]]}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 8.16}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[-0.2738235294117647] -> 
                    Baseline)], #3}}, 
                 GridBoxAlignment -> {
                  "Columns" -> {Center, Left}, "Rows" -> {{Baseline}}}, 
                 AutoDelete -> False, 
                 GridBoxDividers -> {
                  "Columns" -> {{False}}, "Rows" -> {{False}}}, 
                 GridBoxItemSize -> {"Columns" -> {{All}}, "Rows" -> {{All}}},
                  GridBoxSpacings -> {
                  "Columns" -> {{0.5}}, "Rows" -> {{0.8}}}], "Grid"]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{1}}, "Rows" -> {{0}}}], 
            "Grid"], Alignment -> Left, AppearanceElements -> None, 
           ImageMargins -> {{5, 5}, {5, 5}}, ImageSizeAction -> 
           "ResizeToFit"], LineIndent -> 0, StripOnInput -> False], {
         FontSize -> 18, FontFamily -> "Times", 
          GrayLevel[0]}, Background -> Automatic, StripOnInput -> False], 
        TraditionalForm]& ), 
      InterpretationFunction :> (RowBox[{"PointLegend", "[", 
         RowBox[{
           RowBox[{"{", 
             RowBox[{
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.012833333333333334`", "]"}], 
                   ",", 
                   InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    RectangleBox[{0, -1}, {2, 1}]}}, DefaultBaseStyle -> 
                    "ColorSwatchGraphics", AspectRatio -> 1, Frame -> True, 
                    FrameStyle -> 
                    RGBColor[
                    0.24561133333333335`, 0.3378526666666667, 
                    0.4731986666666667], FrameTicks -> None, PlotRangePadding -> 
                    None, ImageSize -> 
                    Dynamic[{
                    Automatic, 
                    1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}]], 
                    StyleBox[
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"0.368417`", ",", "0.506779`", ",", "0.709798`"}],
                     "]"}], NumberMarks -> False]], Appearance -> None, 
                    BaseStyle -> {}, BaselinePosition -> Baseline, 
                    DefaultBaseStyle -> {}, ButtonFunction :> 
                    With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0.368417, 0.506779, 0.709798]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[0.368417, 0.506779, 0.709798], Editable -> False,
                     Selectable -> False], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}], 
               ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.012833333333333334`", "]"}], 
                   ",", 
                   InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    RectangleBox[{0, -1}, {2, 1}]}}, DefaultBaseStyle -> 
                    "ColorSwatchGraphics", AspectRatio -> 1, Frame -> True, 
                    FrameStyle -> 
                    RGBColor[
                    0.587148, 0.40736066666666665`, 0.09470066666666668], 
                    FrameTicks -> None, PlotRangePadding -> None, ImageSize -> 
                    Dynamic[{
                    Automatic, 
                    1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}]], 
                    StyleBox[
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"0.880722`", ",", "0.611041`", ",", "0.142051`"}],
                     "]"}], NumberMarks -> False]], Appearance -> None, 
                    BaseStyle -> {}, BaselinePosition -> Baseline, 
                    DefaultBaseStyle -> {}, ButtonFunction :> 
                    With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0.880722, 0.611041, 0.142051]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[0.880722, 0.611041, 0.142051], Editable -> False,
                     Selectable -> False], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}], 
               ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.012833333333333334`", "]"}], 
                   ",", 
                   InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0.560181, 0.691569, 0.194885], 
                    RectangleBox[{0, -1}, {2, 1}]}}, DefaultBaseStyle -> 
                    "ColorSwatchGraphics", AspectRatio -> 1, Frame -> True, 
                    FrameStyle -> 
                    RGBColor[
                    0.37345400000000006`, 0.461046, 0.12992333333333334`], 
                    FrameTicks -> None, PlotRangePadding -> None, ImageSize -> 
                    Dynamic[{
                    Automatic, 
                    1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}]], 
                    StyleBox[
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"0.560181`", ",", "0.691569`", ",", "0.194885`"}],
                     "]"}], NumberMarks -> False]], Appearance -> None, 
                    BaseStyle -> {}, BaselinePosition -> Baseline, 
                    DefaultBaseStyle -> {}, ButtonFunction :> 
                    With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0.560181, 0.691569, 0.194885]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[0.560181, 0.691569, 0.194885], Editable -> False,
                     Selectable -> False], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}]}],
              "}"}], ",", 
           RowBox[{"{", 
             RowBox[{#, ",", #2, ",", #3}], "}"}], ",", 
           RowBox[{"LegendMarkers", "\[Rule]", 
             RowBox[{"{", 
               RowBox[{
                 RowBox[{"{", 
                   RowBox[{
                    GraphicsBox[{
                    EdgeForm[], 
                    DiskBox[{0, 0}]}], ",", 
                    RowBox[{"Offset", "[", "6.272`", "]"}]}], "}"}], ",", 
                 RowBox[{"{", 
                   RowBox[{
                    GraphicsBox[{
                    EdgeForm[], 
                    PolygonBox[{{-1, -1}, {1, -1}, {1, 1}, {-1, 1}}]}], ",", 
                    RowBox[{"Offset", "[", "6.72`", "]"}]}], "}"}], ",", 
                 RowBox[{"{", 
                   RowBox[{
                    GraphicsBox[{
                    EdgeForm[], 
                    PolygonBox[{{0, 1}, {1, 0}, {0, -1}, {-1, 0}}]}], ",", 
                    RowBox[{"Offset", "[", "8.16`", "]"}]}], "}"}]}], "}"}]}],
            ",", 
           RowBox[{"Joined", "\[Rule]", 
             RowBox[{"{", 
               RowBox[{"True", ",", "True", ",", "True"}], "}"}]}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", 
             RowBox[{"{", 
               RowBox[{
                 RowBox[{"FontSize", "\[Rule]", "18"}], ",", 
                 RowBox[{"FontFamily", "\[Rule]", "\"Times\""}], ",", 
                 InterpretationBox[
                  ButtonBox[
                   TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    GrayLevel[0], 
                    RectangleBox[{0, -1}, {2, 1}]}}, DefaultBaseStyle -> 
                    "ColorSwatchGraphics", AspectRatio -> 1, Frame -> True, 
                    FrameStyle -> GrayLevel[0.], FrameTicks -> None, 
                    PlotRangePadding -> None, ImageSize -> 
                    Dynamic[{
                    Automatic, 
                    1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}]], 
                    StyleBox[
                    RowBox[{"GrayLevel", "[", "0", "]"}], NumberMarks -> 
                    False]], Appearance -> None, BaseStyle -> {}, 
                   BaselinePosition -> Baseline, DefaultBaseStyle -> {}, 
                   ButtonFunction :> With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    GrayLevel[0]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["GrayLevelColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                   Automatic, Method -> "Preemptive"], 
                  GrayLevel[0], Editable -> False, Selectable -> False]}], 
               "}"}]}], ",", 
           RowBox[{"LegendLayout", "\[Rule]", "\"Column\""}]}], "]"}]& ), 
      Editable -> True], TraditionalForm], TraditionalForm]},
  "Legended",
  DisplayFunction->(GridBox[{{
      TagBox[
       ItemBox[
        PaneBox[
         TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline}, 
         BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
       "SkipImageSizeLevel"], 
      ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"]}}, 
    GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
    AutoDelete -> False, GridBoxItemSize -> Automatic, 
    BaselinePosition -> {1, 1}]& ),
  Editable->True,
  InterpretationFunction->(RowBox[{"Legended", "[", 
     RowBox[{#, ",", 
       RowBox[{"Placed", "[", 
         RowBox[{#2, ",", "After"}], "]"}]}], "]"}]& )]], "Output",
 CellChangeTimes->{{3.843148582921115*^9, 3.843148611350236*^9}, 
   3.843148651479559*^9, {3.843300424733507*^9, 3.8433004519953737`*^9}, 
   3.843567223658381*^9},
 CellLabel->"Out[46]=",ExpressionUUID->"95973877-b737-4b25-b903-399abc38215b"]
}, Open  ]],

Cell["Now let us look at structure of Wannier Function", "Text",
 CellChangeTimes->{{3.8431486785481873`*^9, 
  3.8431486879856367`*^9}},ExpressionUUID->"c7a8ff75-a407-46aa-a53f-\
4a8288953917"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Block", "[", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Lambda]", "=", "0.25"}], ",", 
       RowBox[{"\[Delta]", "=", 
        RowBox[{"{", 
         RowBox[{"0.5", ",", "0.5"}], "}"}]}], ",", 
       RowBox[{"krange", "=", "50"}], ",", 
       RowBox[{"r", "=", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}]}], ",", 
       RowBox[{"band", "=", "1"}]}], "}"}], ",", 
     RowBox[{"WanFuPsi", "[", 
      RowBox[{
      "\[Lambda]", ",", "\[Delta]", ",", "r", ",", "krange", ",", "band"}], 
      "]"}]}], "]"}], "//", "MatrixForm"}], "//", "Chop"}]], "Input",
 CellChangeTimes->{{3.813600805600972*^9, 3.813600834541115*^9}, {
   3.813600903086605*^9, 3.8136009043002367`*^9}, {3.81360112890845*^9, 
   3.813601185301813*^9}, {3.813605418834491*^9, 3.813605424653018*^9}, {
   3.813605490488935*^9, 3.81360556366908*^9}, {3.813605690370112*^9, 
   3.813605693511613*^9}, {3.813606605723968*^9, 3.8136066114485607`*^9}, {
   3.813767956209711*^9, 3.8137679670699778`*^9}, {3.814061095327742*^9, 
   3.814061298888081*^9}, {3.814061344763476*^9, 3.814061474953114*^9}, {
   3.8140618816859303`*^9, 3.814061895631584*^9}, {3.814061973504552*^9, 
   3.814061974810357*^9}, {3.814115396686592*^9, 3.8141154228060637`*^9}, {
   3.8141154580979233`*^9, 3.814115461951931*^9}, {3.81411550627918*^9, 
   3.814115534599493*^9}, {3.8141155832597733`*^9, 3.814115584769106*^9}, {
   3.8141980937850227`*^9, 3.814198094024433*^9}, {3.814526246557188*^9, 
   3.81452626390835*^9}, {3.814532892387089*^9, 3.81453290058806*^9}, {
   3.814532935854517*^9, 3.8145329552491693`*^9}, {3.814533125455125*^9, 
   3.8145331359063187`*^9}, 3.81453328950214*^9, {3.814829075620737*^9, 
   3.81482912554979*^9}, {3.814829485079649*^9, 3.814829490062131*^9}, {
   3.814830160650456*^9, 3.81483016132519*^9}, {3.814830328876107*^9, 
   3.814830376447608*^9}, {3.814997449371251*^9, 3.81499747065108*^9}, {
   3.814998069246213*^9, 3.8149980754163094`*^9}, {3.814998126335026*^9, 
   3.814998162155624*^9}, {3.8149984977594843`*^9, 3.8149984981434526`*^9}, {
   3.814998587424605*^9, 3.814998593860832*^9}, {3.814998962048417*^9, 
   3.8149989645347843`*^9}, {3.814999600386599*^9, 3.814999626006773*^9}, {
   3.814999669889439*^9, 3.814999779167346*^9}, {3.814999821648656*^9, 
   3.81499983714587*^9}, {3.814999893764192*^9, 3.814999900175622*^9}, {
   3.814999947618758*^9, 3.814999957838522*^9}, {3.8149999957641287`*^9, 
   3.815000021701848*^9}, {3.8150002498268127`*^9, 3.815000251830853*^9}, {
   3.815000504758911*^9, 3.815000518507113*^9}, {3.815000548869317*^9, 
   3.815000574364752*^9}, {3.815000811335442*^9, 3.8150008117648563`*^9}, {
   3.8150020680446577`*^9, 3.8150021385690193`*^9}, {3.815002269752199*^9, 
   3.815002279108776*^9}, 3.8150023159524937`*^9, {3.815002691452055*^9, 
   3.815002695319477*^9}, {3.815002867203072*^9, 3.8150028861718483`*^9}, {
   3.81500347383895*^9, 3.81500347412427*^9}, {3.815004245106722*^9, 
   3.8150042452206593`*^9}, {3.815004357626356*^9, 3.8150043597274323`*^9}, {
   3.815005133685954*^9, 3.815005196308853*^9}, {3.8150055919955893`*^9, 
   3.815005594915248*^9}, 3.815006045342079*^9, {3.81500670993253*^9, 
   3.815006715826091*^9}, {3.81500713844979*^9, 3.815007166346148*^9}, {
   3.815579631992058*^9, 3.815579663769418*^9}, {3.815579760268038*^9, 
   3.815579760875236*^9}, {3.815580781021484*^9, 3.815580784944458*^9}, 
   3.81558609578966*^9, 3.81558613625261*^9, {3.820874606341387*^9, 
   3.820874629963027*^9}, {3.820874705622142*^9, 3.8208747059899282`*^9}, {
   3.820874738133113*^9, 3.8208747425543613`*^9}, {3.820874799239098*^9, 
   3.820874799615591*^9}, {3.821226230039641*^9, 3.821226236065284*^9}, {
   3.821228754960253*^9, 3.821228756095907*^9}, 3.8212326829397163`*^9, {
   3.8212327718091803`*^9, 3.821232813812845*^9}, {3.821462499472455*^9, 
   3.821462501754726*^9}, {3.8214626082240543`*^9, 3.821462621607834*^9}, {
   3.821548364732525*^9, 3.821548375675024*^9}, {3.821548444776218*^9, 
   3.8215484454423313`*^9}, 3.821809096032658*^9, 3.8218190007283897`*^9, {
   3.821819168472875*^9, 3.821819168681962*^9}, {3.821837385375387*^9, 
   3.821837385831822*^9}, {3.821892009881776*^9, 3.821892011322653*^9}, {
   3.8297648829947033`*^9, 3.829764887875752*^9}, {3.8297650706044483`*^9, 
   3.829765094861405*^9}, {3.829769311348921*^9, 3.829769313764249*^9}, {
   3.829769393101729*^9, 3.8297694026203938`*^9}, 3.829771778100522*^9, {
   3.829775361037127*^9, 3.8297753637772703`*^9}, {3.829775393902307*^9, 
   3.829775395418738*^9}, {3.830275507807228*^9, 3.830275527103528*^9}, 
   3.8423591609875383`*^9, 3.842788763510233*^9, {3.8431483967075243`*^9, 
   3.843148424912253*^9}, {3.8431484569470577`*^9, 3.843148507823834*^9}, {
   3.843148537908564*^9, 3.843148719056769*^9}, {3.843150121126505*^9, 
   3.843150125591296*^9}, {3.843150175194476*^9, 3.843150181659052*^9}, {
   3.843150770923684*^9, 3.84315083147129*^9}, {3.843205808235889*^9, 
   3.8432058185500507`*^9}},
 CellLabel->"In[47]:=",ExpressionUUID->"662e4d66-31af-422b-9bd9-f89f8450b00e"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{"0.09154859513758336`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.08345929490716886`", " ", "\[ImaginaryI]"}]}]},
      {
       RowBox[{
        RowBox[{"-", "0.6436122799613405`"}], "+", 
        RowBox[{"0.02440468682404391`", " ", "\[ImaginaryI]"}]}]},
      {"0"},
      {"0"},
      {
       RowBox[{"0.08345929490716884`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.09154859513758337`", " ", "\[ImaginaryI]"}]}]},
      {
       RowBox[{"0.6436122799613397`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.024404686824043842`", " ", "\[ImaginaryI]"}]}]}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.8431487072349358`*^9, 3.84314871945899*^9}, {
   3.843150123892297*^9, 3.843150126377137*^9}, {3.843150175461587*^9, 
   3.843150182544332*^9}, 3.843150250281945*^9, {3.843150772681102*^9, 
   3.84315083271806*^9}, {3.843205808906446*^9, 3.843205819303101*^9}, 
   3.8433008689540586`*^9, 3.843395804837552*^9, 3.843567223805287*^9},
 CellLabel->
  "Out[47]//MatrixForm=",ExpressionUUID->"292f5fb5-e547-4cc4-a1cc-\
99b3e8876f7c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Block", "[", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Lambda]", "=", "0.25"}], ",", 
       RowBox[{"\[Delta]", "=", 
        RowBox[{"{", 
         RowBox[{"0.5", ",", "0.5"}], "}"}]}], ",", 
       RowBox[{"krange", "=", "50"}], ",", 
       RowBox[{"r", "=", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}]}], ",", 
       RowBox[{"band", "=", "2"}]}], "}"}], ",", 
     RowBox[{"WanFuPsi", "[", 
      RowBox[{
      "\[Lambda]", ",", "\[Delta]", ",", "r", ",", "krange", ",", "band"}], 
      "]"}]}], "]"}], "//", "MatrixForm"}], "//", "Chop"}]], "Input",
 CellChangeTimes->{{3.813600805600972*^9, 3.813600834541115*^9}, {
   3.813600903086605*^9, 3.8136009043002367`*^9}, {3.81360112890845*^9, 
   3.813601185301813*^9}, {3.813605418834491*^9, 3.813605424653018*^9}, {
   3.813605490488935*^9, 3.81360556366908*^9}, {3.813605690370112*^9, 
   3.813605693511613*^9}, {3.813606605723968*^9, 3.8136066114485607`*^9}, {
   3.813767956209711*^9, 3.8137679670699778`*^9}, {3.814061095327742*^9, 
   3.814061298888081*^9}, {3.814061344763476*^9, 3.814061474953114*^9}, {
   3.8140618816859303`*^9, 3.814061895631584*^9}, {3.814061973504552*^9, 
   3.814061974810357*^9}, {3.814115396686592*^9, 3.8141154228060637`*^9}, {
   3.8141154580979233`*^9, 3.814115461951931*^9}, {3.81411550627918*^9, 
   3.814115534599493*^9}, {3.8141155832597733`*^9, 3.814115584769106*^9}, {
   3.8141980937850227`*^9, 3.814198094024433*^9}, {3.814526246557188*^9, 
   3.81452626390835*^9}, {3.814532892387089*^9, 3.81453290058806*^9}, {
   3.814532935854517*^9, 3.8145329552491693`*^9}, {3.814533125455125*^9, 
   3.8145331359063187`*^9}, 3.81453328950214*^9, {3.814829075620737*^9, 
   3.81482912554979*^9}, {3.814829485079649*^9, 3.814829490062131*^9}, {
   3.814830160650456*^9, 3.81483016132519*^9}, {3.814830328876107*^9, 
   3.814830376447608*^9}, {3.814997449371251*^9, 3.81499747065108*^9}, {
   3.814998069246213*^9, 3.8149980754163094`*^9}, {3.814998126335026*^9, 
   3.814998162155624*^9}, {3.8149984977594843`*^9, 3.8149984981434526`*^9}, {
   3.814998587424605*^9, 3.814998593860832*^9}, {3.814998962048417*^9, 
   3.8149989645347843`*^9}, {3.814999600386599*^9, 3.814999626006773*^9}, {
   3.814999669889439*^9, 3.814999779167346*^9}, {3.814999821648656*^9, 
   3.81499983714587*^9}, {3.814999893764192*^9, 3.814999900175622*^9}, {
   3.814999947618758*^9, 3.814999957838522*^9}, {3.8149999957641287`*^9, 
   3.815000021701848*^9}, {3.8150002498268127`*^9, 3.815000251830853*^9}, {
   3.815000504758911*^9, 3.815000518507113*^9}, {3.815000548869317*^9, 
   3.815000574364752*^9}, {3.815000811335442*^9, 3.8150008117648563`*^9}, {
   3.8150020680446577`*^9, 3.8150021385690193`*^9}, {3.815002269752199*^9, 
   3.815002279108776*^9}, 3.8150023159524937`*^9, {3.815002691452055*^9, 
   3.815002695319477*^9}, {3.815002867203072*^9, 3.8150028861718483`*^9}, {
   3.81500347383895*^9, 3.81500347412427*^9}, {3.815004245106722*^9, 
   3.8150042452206593`*^9}, {3.815004357626356*^9, 3.8150043597274323`*^9}, {
   3.815005133685954*^9, 3.815005196308853*^9}, {3.8150055919955893`*^9, 
   3.815005594915248*^9}, 3.815006045342079*^9, {3.81500670993253*^9, 
   3.815006715826091*^9}, {3.81500713844979*^9, 3.815007166346148*^9}, {
   3.815579631992058*^9, 3.815579663769418*^9}, {3.815579760268038*^9, 
   3.815579760875236*^9}, {3.815580781021484*^9, 3.815580784944458*^9}, 
   3.81558609578966*^9, 3.81558613625261*^9, {3.820874606341387*^9, 
   3.820874629963027*^9}, {3.820874705622142*^9, 3.8208747059899282`*^9}, {
   3.820874738133113*^9, 3.8208747425543613`*^9}, {3.820874799239098*^9, 
   3.820874799615591*^9}, {3.821226230039641*^9, 3.821226236065284*^9}, {
   3.821228754960253*^9, 3.821228756095907*^9}, 3.8212326829397163`*^9, {
   3.8212327718091803`*^9, 3.821232813812845*^9}, {3.821462499472455*^9, 
   3.821462501754726*^9}, {3.8214626082240543`*^9, 3.821462621607834*^9}, {
   3.821548364732525*^9, 3.821548375675024*^9}, {3.821548444776218*^9, 
   3.8215484454423313`*^9}, 3.821809096032658*^9, 3.8218190007283897`*^9, {
   3.821819168472875*^9, 3.821819168681962*^9}, {3.821837385375387*^9, 
   3.821837385831822*^9}, {3.821892009881776*^9, 3.821892011322653*^9}, {
   3.8297648829947033`*^9, 3.829764887875752*^9}, {3.8297650706044483`*^9, 
   3.829765094861405*^9}, {3.829769311348921*^9, 3.829769313764249*^9}, {
   3.829769393101729*^9, 3.8297694026203938`*^9}, 3.829771778100522*^9, {
   3.829775361037127*^9, 3.8297753637772703`*^9}, {3.829775393902307*^9, 
   3.829775395418738*^9}, {3.830275507807228*^9, 3.830275527103528*^9}, 
   3.8423591609875383`*^9, 3.842788763510233*^9, {3.8431483967075243`*^9, 
   3.843148424912253*^9}, {3.8431484569470577`*^9, 3.843148507823834*^9}, {
   3.843148537908564*^9, 3.8431487159768476`*^9}, {3.843150131646119*^9, 
   3.843150134242787*^9}, 3.8432058128607883`*^9, {3.843396320974489*^9, 
   3.843396330878352*^9}},
 CellLabel->"In[48]:=",ExpressionUUID->"2c2d9949-f777-4462-8c95-79d4b676e5ef"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{
        RowBox[{"-", "0.6436122799613386`"}], "-", 
        RowBox[{"0.024404686824043776`", " ", "\[ImaginaryI]"}]}]},
      {
       RowBox[{
        RowBox[{"-", "0.09154859513758322`"}], "+", 
        RowBox[{"0.08345929490716882`", " ", "\[ImaginaryI]"}]}]},
      {"0"},
      {"0"},
      {
       RowBox[{"0.6436122799613382`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.024404686824043835`", " ", "\[ImaginaryI]"}]}]},
      {
       RowBox[{
        RowBox[{"-", "0.08345929490716891`"}], "+", 
        RowBox[{"0.0915485951375834`", " ", "\[ImaginaryI]"}]}]}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.843148711957945*^9, 3.8431487163562937`*^9}, 
   3.843150134848247*^9, 3.843150251827647*^9, {3.843205810792015*^9, 
   3.843205813789424*^9}, 3.843300871139449*^9, 3.8433958023466387`*^9, {
   3.843396321609249*^9, 3.8433963315189543`*^9}, 3.843567223932068*^9},
 CellLabel->
  "Out[48]//MatrixForm=",ExpressionUUID->"3eba3282-c55f-4a00-b7b4-\
3664cf9ad213"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Projected Interactions", "Subsection",
 CellChangeTimes->{{3.843208799540287*^9, 
  3.84320880474724*^9}},ExpressionUUID->"1cdb5c98-707e-4dd5-8f19-\
710c11c98bbe"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", "ProjIntNN", "]"}], ";", 
  RowBox[{
   RowBox[{"ProjIntNN", "[", 
    RowBox[{
    "\[Lambda]_", ",", "\[Delta]_", ",", "r_", ",", "l_", ",", "krange_", ",",
      "range_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"ProjIntNN", "[", 
     RowBox[{
     "\[Lambda]", ",", "\[Delta]", ",", "r", ",", "l", ",", "krange", ",", 
      "range"}], "]"}], " ", "=", " ", 
    RowBox[{"Module", "[", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"l1", " ", "=", " ", 
         RowBox[{"l", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
        RowBox[{"l2", " ", "=", " ", 
         RowBox[{"l", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ",", " ", 
        RowBox[{"l3", " ", "=", " ", 
         RowBox[{"l", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], ",", " ", 
        RowBox[{"l4", " ", "=", " ", 
         RowBox[{"l", "[", 
          RowBox[{"[", "4", "]"}], "]"}]}]}], "}"}], ",", " ", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"Sum", "[", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Conjugate", "[", 
            RowBox[{
             RowBox[{"WanFuPsi", "[", 
              RowBox[{"\[Lambda]", ",", "\[Delta]", ",", 
               RowBox[{"-", "rS"}], ",", "krange", ",", "l1"}], "]"}], "[", 
             RowBox[{"[", "\[Alpha]", "]"}], "]"}], "]"}], 
           RowBox[{
            RowBox[{"WanFuPsi", "[", 
             RowBox[{"\[Lambda]", ",", "\[Delta]", ",", 
              RowBox[{"-", "rS"}], ",", "krange", ",", "l2"}], "]"}], "[", 
            RowBox[{"[", "\[Alpha]", "]"}], "]"}], " ", 
           RowBox[{"Conjugate", "[", 
            RowBox[{
             RowBox[{"WanFuPsi", "[", 
              RowBox[{"\[Lambda]", ",", "\[Delta]", ",", 
               RowBox[{"r", "-", "rS"}], ",", "krange", ",", "l3"}], "]"}], 
             "[", 
             RowBox[{"[", 
              RowBox[{"\[Alpha]", "+", "1"}], "]"}], "]"}], "]"}], 
           RowBox[{
            RowBox[{"WanFuPsi", "[", 
             RowBox[{"\[Lambda]", ",", "\[Delta]", ",", 
              RowBox[{"r", "-", "rS"}], ",", "krange", ",", "l4"}], "]"}], 
            "[", 
            RowBox[{"[", 
             RowBox[{"\[Alpha]", "+", "1"}], "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Alpha]", ",", "1", ",", "6", ",", "2"}], "}"}]}], "]"}],
         ",", 
        RowBox[{"{", 
         RowBox[{"rS", ",", 
          RowBox[{"rSpan", "[", "range", "]"}]}], "}"}]}], "]"}]}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.8432088084487123`*^9, 3.843208941643907*^9}, {
   3.843224855014957*^9, 3.8432248651523123`*^9}, 3.843226971615581*^9, {
   3.843227077476026*^9, 3.843227130779904*^9}, 3.8432341740520763`*^9, {
   3.843234235264578*^9, 3.843234238574828*^9}},
 CellLabel->"In[49]:=",ExpressionUUID->"5005e5ae-7b25-4b9e-a638-cd47ff5d5691"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", "ProjIntSF", "]"}], ";", 
  RowBox[{
   RowBox[{"ProjIntSF", "[", 
    RowBox[{
    "\[Lambda]_", ",", "\[Delta]_", ",", "r_", ",", "l_", ",", "krange_", ",",
      "range_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"ProjIntSF", "[", 
     RowBox[{
     "\[Lambda]", ",", "\[Delta]", ",", "r", ",", "l", ",", "krange", ",", 
      "range"}], "]"}], " ", "=", " ", 
    RowBox[{"Module", "[", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"l1", " ", "=", " ", 
         RowBox[{"l", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
        RowBox[{"l2", " ", "=", " ", 
         RowBox[{"l", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ",", " ", 
        RowBox[{"l3", " ", "=", " ", 
         RowBox[{"l", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], ",", " ", 
        RowBox[{"l4", " ", "=", " ", 
         RowBox[{"l", "[", 
          RowBox[{"[", "4", "]"}], "]"}]}]}], "}"}], ",", " ", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"Sum", "[", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Conjugate", "[", 
            RowBox[{
             RowBox[{"WanFuPsi", "[", 
              RowBox[{"\[Lambda]", ",", "\[Delta]", ",", 
               RowBox[{"-", "rS"}], ",", "krange", ",", "l1"}], "]"}], "[", 
             RowBox[{"[", "\[Alpha]", "]"}], "]"}], "]"}], 
           RowBox[{
            RowBox[{"WanFuPsi", "[", 
             RowBox[{"\[Lambda]", ",", "\[Delta]", ",", 
              RowBox[{"-", "rS"}], ",", "krange", ",", "l2"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"\[Alpha]", "+", "1"}], "]"}], "]"}], " ", 
           RowBox[{
            RowBox[{"WanFuPsi", "[", 
             RowBox[{"\[Lambda]", ",", "\[Delta]", ",", 
              RowBox[{"r", "-", "rS"}], ",", "krange", ",", "l3"}], "]"}], 
            "[", 
            RowBox[{"[", "\[Alpha]", "]"}], "]"}], 
           RowBox[{"Conjugate", "[", 
            RowBox[{
             RowBox[{"WanFuPsi", "[", 
              RowBox[{"\[Lambda]", ",", "\[Delta]", ",", 
               RowBox[{"r", "-", "rS"}], ",", "krange", ",", "l4"}], "]"}], 
             "[", 
             RowBox[{"[", 
              RowBox[{"\[Alpha]", "+", "1"}], "]"}], "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Alpha]", ",", "1", ",", "6", ",", "2"}], "}"}]}], "]"}],
         ",", 
        RowBox[{"{", 
         RowBox[{"rS", ",", 
          RowBox[{"rSpan", "[", "range", "]"}]}], "}"}]}], "]"}]}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.8432088084487123`*^9, 3.843208941643907*^9}, {
   3.843224855014957*^9, 3.8432248651523123`*^9}, 3.843226971615581*^9, {
   3.843227077476026*^9, 3.843227130779904*^9}, 3.8432341740520763`*^9, {
   3.843234235264578*^9, 3.843234265086547*^9}, {3.843300874226286*^9, 
   3.843300874331873*^9}, {3.843303110191741*^9, 3.843303116781186*^9}},
 CellLabel->"In[50]:=",ExpressionUUID->"9a4fd334-2b33-4a63-914f-fe0ad9104659"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", "ProjIntPH", "]"}], ";", 
  RowBox[{
   RowBox[{"ProjIntPH", "[", 
    RowBox[{
    "\[Lambda]_", ",", "\[Delta]_", ",", "r_", ",", "l_", ",", "krange_", ",",
      "range_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"ProjIntPH", "[", 
     RowBox[{
     "\[Lambda]", ",", "\[Delta]", ",", "r", ",", "l", ",", "krange", ",", 
      "range"}], "]"}], " ", "=", " ", 
    RowBox[{"Module", "[", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"l1", " ", "=", " ", 
         RowBox[{"l", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
        RowBox[{"l2", " ", "=", " ", 
         RowBox[{"l", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ",", " ", 
        RowBox[{"l3", " ", "=", " ", 
         RowBox[{"l", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], ",", " ", 
        RowBox[{"l4", " ", "=", " ", 
         RowBox[{"l", "[", 
          RowBox[{"[", "4", "]"}], "]"}]}]}], "}"}], ",", " ", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"Sum", "[", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Conjugate", "[", 
            RowBox[{
             RowBox[{"WanFuPsi", "[", 
              RowBox[{"\[Lambda]", ",", "\[Delta]", ",", 
               RowBox[{"-", "rS"}], ",", "krange", ",", "l1"}], "]"}], "[", 
             RowBox[{"[", "\[Alpha]", "]"}], "]"}], "]"}], 
           RowBox[{"Conjugate", "[", 
            RowBox[{
             RowBox[{"WanFuPsi", "[", 
              RowBox[{"\[Lambda]", ",", "\[Delta]", ",", 
               RowBox[{"-", "rS"}], ",", "krange", ",", "l2"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"\[Alpha]", "+", "1"}], "]"}], "]"}], " ", "]"}], 
           RowBox[{
            RowBox[{"WanFuPsi", "[", 
             RowBox[{"\[Lambda]", ",", "\[Delta]", ",", 
              RowBox[{"r", "-", "rS"}], ",", "krange", ",", "l3"}], "]"}], 
            "[", 
            RowBox[{"[", 
             RowBox[{"\[Alpha]", "+", "1"}], "]"}], "]"}], 
           RowBox[{
            RowBox[{"WanFuPsi", "[", 
             RowBox[{"\[Lambda]", ",", "\[Delta]", ",", 
              RowBox[{"r", "-", "rS"}], ",", "krange", ",", "l4"}], "]"}], 
            "[", 
            RowBox[{"[", "\[Alpha]", "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Alpha]", ",", "1", ",", "6", ",", "2"}], "}"}]}], "]"}],
         ",", 
        RowBox[{"{", 
         RowBox[{"rS", ",", 
          RowBox[{"rSpan", "[", "range", "]"}]}], "}"}]}], "]"}]}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.8432088084487123`*^9, 3.843208941643907*^9}, {
   3.843224855014957*^9, 3.8432248651523123`*^9}, 3.843226971615581*^9, {
   3.843227077476026*^9, 3.843227130779904*^9}, {3.843228213578598*^9, 
   3.8432282558387938`*^9}, 3.843234179593234*^9},
 CellLabel->"In[51]:=",ExpressionUUID->"e00e3591-ede5-435a-a997-0cce1823871f"],

Cell[CellGroupData[{

Cell["On-site Hubbard", "Subsubsection",
 CellChangeTimes->{{3.843232245765197*^9, 
  3.843232250408722*^9}},ExpressionUUID->"759d9f0a-d624-4e3d-a3c6-\
7a353b49a41a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Block", "[", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Lambda]", "=", "0.0"}], ",", 
       RowBox[{"\[Delta]", "=", 
        RowBox[{"{", 
         RowBox[{"0.5", ",", "0.5"}], "}"}]}], ",", " ", 
       RowBox[{"r", "=", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}]}], ",", " ", 
       RowBox[{"krange", "=", "50"}], ",", 
       RowBox[{"range", "=", "3"}]}], "}"}], ",", " ", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Table", "[", " ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"l1", ",", "l2", ",", "l3", ",", "l4", ",", 
           RowBox[{"ProjIntNN", "[", 
            RowBox[{"\[Lambda]", ",", "\[Delta]", ",", "r", ",", 
             RowBox[{"{", 
              RowBox[{"l1", ",", "l2", ",", "l3", ",", "l4"}], "}"}], ",", 
             "krange", ",", "range"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"l1", ",", "1", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"l2", ",", "1", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"l3", ",", "1", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"l4", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", "3"}], 
      "]"}]}], "]"}], "//", "MatrixForm"}], "//", "Chop"}]], "Input",
 CellChangeTimes->{{3.843208946918849*^9, 3.843209104248993*^9}, 
   3.8432270637853537`*^9, {3.8432271359179077`*^9, 3.843227142666748*^9}, {
   3.843227174305813*^9, 3.843227178017243*^9}, {3.843228265535063*^9, 
   3.8432282659110117`*^9}, {3.843228347181333*^9, 3.8432283731863003`*^9}, {
   3.8432315308408546`*^9, 3.8432315328265057`*^9}, 3.8432321722853527`*^9, {
   3.843232209064982*^9, 3.84323220921989*^9}, 3.843232260475054*^9, {
   3.843234269253511*^9, 3.843234269373171*^9}, 3.8433009082075253`*^9, {
   3.843302988098543*^9, 3.843302992614649*^9}},
 CellLabel->"In[78]:=",ExpressionUUID->"e50ecbc8-86b2-46a2-9268-87c435963792"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "1", "1", "1", "0"},
     {"1", "1", "1", "2", "0"},
     {"1", "1", "2", "1", "0"},
     {"1", "1", "2", "2", "0"},
     {"1", "2", "1", "1", "0"},
     {"1", "2", "1", "2", "0"},
     {"1", "2", "2", "1", "0"},
     {"1", "2", "2", "2", "0"},
     {"2", "1", "1", "1", "0"},
     {"2", "1", "1", "2", "0"},
     {"2", "1", "2", "1", "0"},
     {"2", "1", "2", "2", "0"},
     {"2", "2", "1", "1", "0.36189896581542635`"},
     {"2", "2", "1", "2", "0"},
     {"2", "2", "2", "1", "0"},
     {"2", "2", "2", "2", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.843232172949293*^9, 3.84323217450189*^9}, 
   3.843232209619589*^9, 3.843232265622897*^9, 3.843234269924851*^9, {
   3.843300885583693*^9, 3.843300911288014*^9}, {3.8433029887476997`*^9, 
   3.8433029930285788`*^9}, {3.843309478991702*^9, 3.84330949222328*^9}, 
   3.843395729103538*^9, 3.8433960105172863`*^9, 3.8435672262369223`*^9, 
   3.843574874343897*^9},
 CellLabel->
  "Out[78]//MatrixForm=",ExpressionUUID->"b480fd96-e999-4699-b5b1-\
2278b8185389"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Nearest Neighbor ", "Subsubsection",
 CellChangeTimes->{{3.8432322545388613`*^9, 
  3.8432322576038637`*^9}},ExpressionUUID->"6ae0338c-3680-4f81-8136-\
ee562d208654"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Lambda]", "=", "0.2"}], ";"}]], "Input",
 CellChangeTimes->{{3.8432343006703157`*^9, 3.843234329118745*^9}, 
   3.843302998749729*^9, 3.843303133581348*^9, 3.8433062139934807`*^9, 
   3.8433070065881157`*^9, 3.84330952200378*^9, 3.843395745336684*^9, 
   3.8433960254240637`*^9, 3.843567258814053*^9},
 CellLabel->"In[64]:=",ExpressionUUID->"c4ec90a0-020b-4955-a11b-67e1d76e9011"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Block", "[", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Delta]", "=", 
        RowBox[{"{", 
         RowBox[{"0.5", ",", "0.5"}], "}"}]}], ",", " ", 
       RowBox[{"r", "=", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}]}], ",", " ", 
       RowBox[{"krange", "=", "50"}], ",", 
       RowBox[{"range", "=", "3"}]}], "}"}], ",", " ", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Table", "[", " ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"l1", ",", "l2", ",", "l3", ",", "l4", ",", 
           RowBox[{"ProjIntNN", "[", 
            RowBox[{"\[Lambda]", ",", "\[Delta]", ",", "r", ",", 
             RowBox[{"{", 
              RowBox[{"l1", ",", "l2", ",", "l3", ",", "l4"}], "}"}], ",", 
             "krange", ",", "range"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"l1", ",", "1", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"l2", ",", "1", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"l3", ",", "1", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"l4", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", "3"}], 
      "]"}]}], "]"}], "//", "MatrixForm"}], "//", "Chop"}]], "Input",
 CellChangeTimes->{{3.843208946918849*^9, 3.843209104248993*^9}, 
   3.8432270637853537`*^9, {3.8432271359179077`*^9, 3.843227142666748*^9}, {
   3.843227174305813*^9, 3.843227178017243*^9}, {3.843228265535063*^9, 
   3.8432282659110117`*^9}, {3.843228347181333*^9, 3.8432283731863003`*^9}, {
   3.8432315308408546`*^9, 3.8432315328265057`*^9}, {3.8432341228685427`*^9, 
   3.843234165263495*^9}, {3.84323427328402*^9, 3.8432343582078342`*^9}, {
   3.8433030017525597`*^9, 3.843303047494583*^9}, {3.843303125983904*^9, 
   3.84330312671139*^9}, {3.8433067557915792`*^9, 3.84330675592218*^9}, {
   3.8433095642005653`*^9, 3.8433095906185827`*^9}, {3.843395749445548*^9, 
   3.843395763541402*^9}, {3.8433960167174807`*^9, 3.843396017695148*^9}, {
   3.843567273447645*^9, 3.8435672888493357`*^9}},
 CellLabel->"In[68]:=",ExpressionUUID->"8b3b5400-e36e-40e5-8b05-bf7af6264d68"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "1", "1", "1", "0.0007497499876273375`"},
     {"1", "1", "1", "2", 
      RowBox[{"0.0000282628737654495`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.00008106753138240826`", " ", "\[ImaginaryI]"}]}]},
     {"1", "1", "2", "1", 
      RowBox[{"0.0000282628737654495`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.00008106753138240826`", " ", "\[ImaginaryI]"}]}]},
     {"1", "1", "2", "2", "0.00003500685048957879`"},
     {"1", "2", "1", "1", 
      RowBox[{
       RowBox[{"-", "0.0020222304277410074`"}], "+", 
       RowBox[{"0.001467293857601002`", " ", "\[ImaginaryI]"}]}]},
     {"1", "2", "1", "2", 
      RowBox[{
       RowBox[{"-", "0.00047582318949384087`"}], "+", 
       RowBox[{"0.00006876143832862368`", " ", "\[ImaginaryI]"}]}]},
     {"1", "2", "2", "1", 
      RowBox[{
       RowBox[{"-", "0.0001437096057092636`"}], "+", 
       RowBox[{"0.00048796644980849367`", " ", "\[ImaginaryI]"}]}]},
     {"1", "2", "2", "2", 
      RowBox[{"0.000015257683934182952`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.00004065032020895016`", " ", "\[ImaginaryI]"}]}]},
     {"2", "1", "1", "1", 
      RowBox[{
       RowBox[{"-", "0.0020222304277410074`"}], "-", 
       RowBox[{"0.001467293857601002`", " ", "\[ImaginaryI]"}]}]},
     {"2", "1", "1", "2", 
      RowBox[{
       RowBox[{"-", "0.0001437096057092636`"}], "-", 
       RowBox[{"0.00048796644980849367`", " ", "\[ImaginaryI]"}]}]},
     {"2", "1", "2", "1", 
      RowBox[{
       RowBox[{"-", "0.00047582318949384087`"}], "-", 
       RowBox[{"0.00006876143832862368`", " ", "\[ImaginaryI]"}]}]},
     {"2", "1", "2", "2", 
      RowBox[{"0.000015257683934182952`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.00004065032020895016`", " ", "\[ImaginaryI]"}]}]},
     {"2", "2", "1", "1", "0.027911985658387404`"},
     {"2", "2", "1", "2", 
      RowBox[{"0.002049221029322323`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.002335977442372017`", " ", "\[ImaginaryI]"}]}]},
     {"2", "2", "2", "1", 
      RowBox[{"0.002049221029322323`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.002335977442372017`", " ", "\[ImaginaryI]"}]}]},
     {"2", "2", "2", "2", "0.0013469982853464922`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.843303004559163*^9, 3.843303047985737*^9}, {
   3.843303123869719*^9, 3.843303141129491*^9}, 3.843306216151472*^9, {
   3.8433067504324408`*^9, 3.843306756533614*^9}, 3.84330700768417*^9, {
   3.843309512212599*^9, 3.843309529250806*^9}, {3.843309567675991*^9, 
   3.843309592371408*^9}, {3.843395750156987*^9, 3.8433957683082447`*^9}, {
   3.843396013513729*^9, 3.8433960327437572`*^9}, {3.843567231938136*^9, 
   3.843567291697218*^9}},
 CellLabel->
  "Out[68]//MatrixForm=",ExpressionUUID->"864f4d8a-e9f8-462c-a0bb-\
21723ea845f2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Block", "[", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Delta]", "=", 
        RowBox[{"{", 
         RowBox[{"0.5", ",", "0.2"}], "}"}]}], ",", " ", 
       RowBox[{"r", "=", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}]}], ",", " ", 
       RowBox[{"krange", "=", "50"}], ",", 
       RowBox[{"range", "=", "3"}]}], "}"}], ",", " ", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Table", "[", " ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"l1", ",", "l2", ",", "l3", ",", "l4", ",", 
           RowBox[{"ProjIntNN", "[", 
            RowBox[{"\[Lambda]", ",", "\[Delta]", ",", "r", ",", 
             RowBox[{"{", 
              RowBox[{"l1", ",", "l2", ",", "l3", ",", "l4"}], "}"}], ",", 
             "krange", ",", "range"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"l1", ",", "1", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"l2", ",", "1", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"l3", ",", "1", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"l4", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", "3"}], 
      "]"}]}], "]"}], "//", "MatrixForm"}], "//", "Chop"}]], "Input",
 CellChangeTimes->{{3.843208946918849*^9, 3.843209104248993*^9}, 
   3.8432270637853537`*^9, {3.8432271359179077`*^9, 3.843227142666748*^9}, {
   3.843227174305813*^9, 3.843227178017243*^9}, {3.843228265535063*^9, 
   3.8432282659110117`*^9}, {3.843228347181333*^9, 3.8432283731863003`*^9}, {
   3.8432315308408546`*^9, 3.8432315328265057`*^9}, {3.8432341228685427`*^9, 
   3.843234165263495*^9}, {3.84323427328402*^9, 3.8432343582078342`*^9}, {
   3.843395771368146*^9, 3.843395782162451*^9}},
 CellLabel->"In[55]:=",ExpressionUUID->"b565ebb3-78ee-4f80-965c-7fdfef7022b7"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "1", "1", "1", "0.0008369842077889019`"},
     {"1", "1", "1", "2", 
      RowBox[{
       RowBox[{"-", "7.043295834275376`*^-6"}], "+", 
       RowBox[{"0.00004678837749343507`", " ", "\[ImaginaryI]"}]}]},
     {"1", "1", "2", "1", 
      RowBox[{
       RowBox[{"-", "7.043295834275376`*^-6"}], "-", 
       RowBox[{"0.00004678837749343507`", " ", "\[ImaginaryI]"}]}]},
     {"1", "1", "2", "2", "0.000021792225805148604`"},
     {"1", "2", "1", "1", 
      RowBox[{
       RowBox[{"-", "0.0014083811018380168`"}], "+", 
       RowBox[{"0.00024864482222608237`", " ", "\[ImaginaryI]"}]}]},
     {"1", "2", "1", "2", 
      RowBox[{
       RowBox[{"-", "0.0002408756492074449`"}], "+", 
       RowBox[{"0.00016820998275475258`", " ", "\[ImaginaryI]"}]}]},
     {"1", "2", "2", "1", 
      RowBox[{
       RowBox[{"-", "0.0001653894729639654`"}], "+", 
       RowBox[{"0.0003436555539975271`", " ", "\[ImaginaryI]"}]}]},
     {"1", "2", "2", "2", 
      RowBox[{"0.00005959313551520362`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.00011894156252516848`", " ", "\[ImaginaryI]"}]}]},
     {"2", "1", "1", "1", 
      RowBox[{
       RowBox[{"-", "0.0014083811018380168`"}], "-", 
       RowBox[{"0.00024864482222608237`", " ", "\[ImaginaryI]"}]}]},
     {"2", "1", "1", "2", 
      RowBox[{
       RowBox[{"-", "0.0001653894729639654`"}], "-", 
       RowBox[{"0.0003436555539975271`", " ", "\[ImaginaryI]"}]}]},
     {"2", "1", "2", "1", 
      RowBox[{
       RowBox[{"-", "0.0002408756492074449`"}], "-", 
       RowBox[{"0.00016820998275475258`", " ", "\[ImaginaryI]"}]}]},
     {"2", "1", "2", "2", 
      RowBox[{"0.00005959313551520362`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.00011894156252516848`", " ", "\[ImaginaryI]"}]}]},
     {"2", "2", "1", "1", "0.05691103162396995`"},
     {"2", "2", "1", "2", 
      RowBox[{"0.0010336255642337169`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.002170270332896861`", " ", "\[ImaginaryI]"}]}]},
     {"2", "2", "2", "1", 
      RowBox[{"0.0010336255642337169`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.002170270332896861`", " ", "\[ImaginaryI]"}]}]},
     {"2", "2", "2", "2", "0.0016644064272021634`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.84320902352214*^9, 3.8432091073691874`*^9}, 
   3.843224808225545*^9, {3.843224871254059*^9, 3.8432248857267323`*^9}, 
   3.843226972943756*^9, 3.843227065488531*^9, {3.8432271329555187`*^9, 
   3.843227178554432*^9}, 3.843228266719778*^9, {3.8432283543270063`*^9, 
   3.843228373846732*^9}, {3.843231513211877*^9, 3.84323152070831*^9}, {
   3.843234102542509*^9, 3.843234186293715*^9}, {3.8432342741462317`*^9, 
   3.843234359693288*^9}, 3.8433009208571873`*^9, {3.843302977859539*^9, 
   3.843302996612198*^9}, {3.843395775527524*^9, 3.843395784737352*^9}, 
   3.843567237391595*^9},
 CellLabel->
  "Out[55]//MatrixForm=",ExpressionUUID->"2764ec46-66f6-4048-8381-\
6ff24f555716"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Block", "[", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Delta]", "=", 
        RowBox[{"{", 
         RowBox[{"0.5", ",", "0.2"}], "}"}]}], ",", " ", 
       RowBox[{"r", "=", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}]}], ",", " ", 
       RowBox[{"krange", "=", "50"}], ",", 
       RowBox[{"range", "=", "3"}]}], "}"}], ",", " ", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Table", "[", " ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"l1", ",", "l2", ",", "l3", ",", "l4", ",", 
           RowBox[{"ProjIntSF", "[", 
            RowBox[{"\[Lambda]", ",", "\[Delta]", ",", "r", ",", 
             RowBox[{"{", 
              RowBox[{"l1", ",", "l2", ",", "l3", ",", "l4"}], "}"}], ",", 
             "krange", ",", "range"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"l1", ",", "1", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"l2", ",", "1", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"l3", ",", "1", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"l4", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", "3"}], 
      "]"}]}], "]"}], "//", "MatrixForm"}], "//", "Chop"}]], "Input",
 CellChangeTimes->{{3.843208946918849*^9, 3.843209104248993*^9}, 
   3.8432270637853537`*^9, {3.8432271359179077`*^9, 3.843227142666748*^9}, {
   3.843227174305813*^9, 3.843227178017243*^9}, {3.843228265535063*^9, 
   3.8432282659110117`*^9}, {3.843228347181333*^9, 3.8432283731863003`*^9}, {
   3.8432315308408546`*^9, 3.8432315328265057`*^9}, {3.8432341228685427`*^9, 
   3.843234165263495*^9}, {3.84323427328402*^9, 3.8432343647419853`*^9}},
 CellLabel->"In[56]:=",ExpressionUUID->"7df9cb84-3af4-4686-a8a9-75f394c9eb7c"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "1", "1", "1", 
      RowBox[{"0.00016470103551232814`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.0003505987188832814`", " ", "\[ImaginaryI]"}]}]},
     {"1", "1", "1", "2", 
      RowBox[{"0.00006915057691586304`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.0001106772018213662`", " ", "\[ImaginaryI]"}]}]},
     {"1", "1", "2", "1", 
      RowBox[{
       RowBox[{"-", "0.0012539698960053382`"}], "+", 
       RowBox[{"0.0003818164318416013`", " ", "\[ImaginaryI]"}]}]},
     {"1", "1", "2", "2", 
      RowBox[{
       RowBox[{"-", "0.00016470103551232632`"}], "+", 
       RowBox[{"0.0003505987188832825`", " ", "\[ImaginaryI]"}]}]},
     {"1", "2", "1", "1", 
      RowBox[{
       RowBox[{"-", "0.000032146739552765795`"}], "+", 
       RowBox[{"0.000018783818044276754`", " ", "\[ImaginaryI]"}]}]},
     {"1", "2", "1", "2", 
      RowBox[{"6.643950895278423`*^-6", "+", 
       RowBox[{"0.000013259301344839942`", " ", "\[ImaginaryI]"}]}]},
     {"1", "2", "2", "1", 
      RowBox[{"0.00025244383471384474`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.0007553183959055184`", " ", "\[ImaginaryI]"}]}]},
     {"1", "2", "2", "2", 
      RowBox[{"0.000032146739552765545`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.000018783818044276737`", " ", "\[ImaginaryI]"}]}]},
     {"2", "1", "1", "1", 
      RowBox[{
       RowBox[{"-", "0.0008064099201327621`"}], "+", 
       RowBox[{"0.0022837134924974553`", " ", "\[ImaginaryI]"}]}]},
     {"2", "1", "1", "2", 
      RowBox[{"0.0013032764751721958`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.0005082493434327011`", " ", "\[ImaginaryI]"}]}]},
     {"2", "1", "2", "1", 
      RowBox[{"0.056866072672848336`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.0012036744940162184`", " ", "\[ImaginaryI]"}]}]},
     {"2", "1", "2", "2", 
      RowBox[{"0.0008064099201327521`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.0022837134924974297`", " ", "\[ImaginaryI]"}]}]},
     {"2", "2", "1", "1", 
      RowBox[{
       RowBox[{"-", "0.0001647010355123291`"}], "+", 
       RowBox[{"0.00035059871888328225`", " ", "\[ImaginaryI]"}]}]},
     {"2", "2", "1", "2", 
      RowBox[{
       RowBox[{"-", "0.00006915057691586315`"}], "+", 
       RowBox[{"0.00011067720182136637`", " ", "\[ImaginaryI]"}]}]},
     {"2", "2", "2", "1", 
      RowBox[{"0.001253969896005342`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.0003818164318416`", " ", "\[ImaginaryI]"}]}]},
     {"2", "2", "2", "2", 
      RowBox[{"0.00016470103551232722`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.0003505987188832835`", " ", "\[ImaginaryI]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.843234279100774*^9, 3.843234365383898*^9}, 
   3.843300927877784*^9, 3.843567237497436*^9},
 CellLabel->
  "Out[56]//MatrixForm=",ExpressionUUID->"e2341556-caec-4b1b-bfd3-\
9c46e682764c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Block", "[", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Delta]", "=", 
        RowBox[{"{", 
         RowBox[{"0.5", ",", "0.2"}], "}"}]}], ",", " ", 
       RowBox[{"r", "=", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}]}], ",", " ", 
       RowBox[{"krange", "=", "50"}], ",", 
       RowBox[{"range", "=", "3"}]}], "}"}], ",", " ", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Table", "[", " ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"l1", ",", "l2", ",", "l3", ",", "l4", ",", 
           RowBox[{"ProjIntPH", "[", 
            RowBox[{"\[Lambda]", ",", "\[Delta]", ",", "r", ",", 
             RowBox[{"{", 
              RowBox[{"l1", ",", "l2", ",", "l3", ",", "l4"}], "}"}], ",", 
             "krange", ",", "range"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"l1", ",", "1", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"l2", ",", "1", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"l3", ",", "1", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"l4", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", "3"}], 
      "]"}]}], "]"}], "//", "MatrixForm"}], "//", "Chop"}]], "Input",
 CellChangeTimes->{{3.843208946918849*^9, 3.843209104248993*^9}, {
   3.843224815365542*^9, 3.8432248195503807`*^9}, 3.843227068137677*^9, {
   3.843227153969181*^9, 3.843227181032048*^9}, {3.843228269146021*^9, 
   3.843228269505247*^9}, {3.8432283579341784`*^9, 3.843228368696877*^9}, {
   3.843231515718302*^9, 3.843231516409417*^9}, {3.843234312905478*^9, 
   3.843234368726677*^9}},
 CellLabel->"In[57]:=",ExpressionUUID->"3d006477-1d5f-48e0-b028-d59fdb036845"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "1", "1", "1", 
      RowBox[{"0.0001653894729639652`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.000343655553997526`", " ", "\[ImaginaryI]"}]}]},
     {"1", "1", "1", "2", 
      RowBox[{
       RowBox[{"-", "0.0014083811018380061`"}], "+", 
       RowBox[{"0.0002486448222260692`", " ", "\[ImaginaryI]"}]}]},
     {"1", "1", "2", "1", 
      RowBox[{
       RowBox[{"-", "0.00005959313551520347`"}], "+", 
       RowBox[{"0.00011894156252516841`", " ", "\[ImaginaryI]"}]}]},
     {"1", "1", "2", "2", 
      RowBox[{
       RowBox[{"-", "0.00024087564920744587`"}], "+", 
       RowBox[{"0.00016820998275475182`", " ", "\[ImaginaryI]"}]}]},
     {"1", "2", "1", "1", 
      RowBox[{
       RowBox[{"-", "7.043295834275437`*^-6"}], "-", 
       RowBox[{"0.00004678837749343506`", " ", "\[ImaginaryI]"}]}]},
     {"1", "2", "1", "2", 
      RowBox[{"-", "0.0008369842077889019`"}]},
     {"1", "2", "2", "1", "0.000021792225805148597`"},
     {"1", "2", "2", "2", 
      RowBox[{"7.043295834275456`*^-6", "-", 
       RowBox[{"0.00004678837749343481`", " ", "\[ImaginaryI]"}]}]},
     {"2", "1", "1", "1", 
      RowBox[{
       RowBox[{"-", "0.0010336255642337156`"}], "+", 
       RowBox[{"0.0021702703328968483`", " ", "\[ImaginaryI]"}]}]},
     {"2", "1", "1", "2", "0.05691103162396976`"},
     {"2", "1", "2", "1", 
      RowBox[{"-", "0.0016644064272021608`"}]},
     {"2", "1", "2", "2", 
      RowBox[{"0.0010336255642337028`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.0021702703328968236`", " ", "\[ImaginaryI]"}]}]},
     {"2", "2", "1", "1", 
      RowBox[{
       RowBox[{"-", "0.0002408756492074447`"}], "-", 
       RowBox[{"0.00016820998275475263`", " ", "\[ImaginaryI]"}]}]},
     {"2", "2", "1", "2", 
      RowBox[{"0.0014083811018380053`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.0002486448222260692`", " ", "\[ImaginaryI]"}]}]},
     {"2", "2", "2", "1", 
      RowBox[{"0.00005959313551520376`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.00011894156252516843`", " ", "\[ImaginaryI]"}]}]},
     {"2", "2", "2", "2", 
      RowBox[{"0.00016538947296396443`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.00034365555399752803`", " ", "\[ImaginaryI]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.8432248200249*^9, 3.843224873688134*^9, 3.8432269756862698`*^9, 
   3.8432270691415987`*^9, {3.843227159731737*^9, 3.843227181508666*^9}, 
   3.8432282704138308`*^9, {3.8432283591712627`*^9, 3.84322836935345*^9}, {
   3.843231510910325*^9, 3.843231516903966*^9}, 3.84323410442104*^9, {
   3.8432342824293547`*^9, 3.843234369330307*^9}, 3.843300929500198*^9, 
   3.843567237554709*^9},
 CellLabel->
  "Out[57]//MatrixForm=",ExpressionUUID->"f53069b4-bf07-4b2c-a4c1-\
82fb859ecda5"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Fermionic det", "Subsubsection",
 CellChangeTimes->{{3.8433960661578503`*^9, 
  3.8433960686532516`*^9}},ExpressionUUID->"ff506659-79c7-4fc6-8e5b-\
a5a7fd4300ee"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FDet", "[", "l_", "]"}], ":=", " ", 
   RowBox[{"Det", "[", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"l", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
        RowBox[{"l", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
        RowBox[{"l", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
        RowBox[{"l", "[", 
         RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"l", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
        RowBox[{"l", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
        RowBox[{"l", "[", 
         RowBox[{"[", "4", "]"}], "]"}], ",", " ", 
        RowBox[{"l", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"l", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
        RowBox[{"l", "[", 
         RowBox[{"[", "4", "]"}], "]"}], ",", " ", 
        RowBox[{"l", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
        RowBox[{"l", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"l", "[", 
         RowBox[{"[", "4", "]"}], "]"}], ",", " ", 
        RowBox[{"l", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
        RowBox[{"l", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
        RowBox[{"l", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "}"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8433960702881727`*^9, 3.843396120972186*^9}},
 CellLabel->"In[58]:=",ExpressionUUID->"d30af0d0-f4c8-4f9b-8d26-69dd36757fb2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"l1", ",", "l2", ",", "l3", ",", "l4", ",", 
         RowBox[{"Sign", "[", 
          RowBox[{"FDet", "[", 
           RowBox[{"{", 
            RowBox[{"l1", ",", "l2", ",", "l3", ",", "l4"}], "}"}], "]"}], 
          "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"l1", ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"l2", ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"l3", ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"l4", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", "3"}], "]"}],
    "//", "MatrixForm"}], "//", "Chop"}]], "Input",
 CellChangeTimes->{{3.843208946918849*^9, 3.843209104248993*^9}, {
   3.843224815365542*^9, 3.8432248195503807`*^9}, 3.843227068137677*^9, {
   3.843227153969181*^9, 3.843227181032048*^9}, {3.843228269146021*^9, 
   3.843228269505247*^9}, {3.8432283579341784`*^9, 3.843228368696877*^9}, {
   3.843231515718302*^9, 3.843231516409417*^9}, {3.843234312905478*^9, 
   3.843234368726677*^9}, {3.843396134186989*^9, 3.843396147056291*^9}, {
   3.843396202167931*^9, 3.8433962056987543`*^9}},
 CellLabel->"In[59]:=",ExpressionUUID->"19eaeb19-dbd5-4ab0-9b0a-fdca14c620e9"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "1", "1", "1", "0"},
     {"1", "1", "1", "2", "1"},
     {"1", "1", "2", "1", 
      RowBox[{"-", "1"}]},
     {"1", "1", "2", "2", "0"},
     {"1", "2", "1", "1", "1"},
     {"1", "2", "1", "2", "0"},
     {"1", "2", "2", "1", "0"},
     {"1", "2", "2", "2", "1"},
     {"2", "1", "1", "1", 
      RowBox[{"-", "1"}]},
     {"2", "1", "1", "2", "0"},
     {"2", "1", "2", "1", "0"},
     {"2", "1", "2", "2", 
      RowBox[{"-", "1"}]},
     {"2", "2", "1", "1", "0"},
     {"2", "2", "1", "2", "1"},
     {"2", "2", "2", "1", 
      RowBox[{"-", "1"}]},
     {"2", "2", "2", "2", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.843396147604207*^9, 3.843396150238566*^9}, {
   3.843396206260027*^9, 3.8433962081477413`*^9}, 3.8435672376023827`*^9},
 CellLabel->
  "Out[59]//MatrixForm=",ExpressionUUID->"2b86a33b-5de9-429f-9b75-\
8a06edca37f2"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Detail layout", "Subsubsection",
 CellChangeTimes->{{3.8435744145033503`*^9, 
  3.843574418422327*^9}},ExpressionUUID->"0fb2fdf0-0260-4696-b390-\
62255a19b15b"],

Cell["Density-Density channel", "Text",
 CellChangeTimes->{{3.8435746961523867`*^9, 
  3.843574702964081*^9}},ExpressionUUID->"363445bd-a902-415d-baf4-\
0b88ce88ea7a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Block", "[", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Lambda]", "=", "0.2"}], ",", 
       RowBox[{"\[Delta]", "=", 
        RowBox[{"{", 
         RowBox[{"0.5", ",", "0.5"}], "}"}]}], ",", " ", 
       RowBox[{"r", "=", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0"}], "}"}]}], ",", " ", 
       RowBox[{"krange", "=", "50"}], ",", 
       RowBox[{"range", "=", "3"}]}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ProjIntNN", "[", 
        RowBox[{"\[Lambda]", ",", "\[Delta]", ",", "r", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], ",", "krange", 
         ",", "range"}], "]"}], ",", 
       RowBox[{"ProjIntNN", "[", 
        RowBox[{"\[Lambda]", ",", "\[Delta]", ",", "r", ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "2", ",", "2", ",", "2"}], "}"}], ",", "krange", 
         ",", "range"}], "]"}], ",", 
       RowBox[{"ProjIntNN", "[", 
        RowBox[{"\[Lambda]", ",", "\[Delta]", ",", "r", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1", ",", "2", ",", "2"}], "}"}], ",", "krange", 
         ",", "range"}], "]"}], ",", 
       RowBox[{"ProjIntNN", "[", 
        RowBox[{"\[Lambda]", ",", "\[Delta]", ",", "r", ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "2", ",", "1", ",", "1"}], "}"}], ",", "krange", 
         ",", "range"}], "]"}]}], "}"}]}], "]"}], "//", "MatrixForm"}], "//", 
  "Chop"}]], "Input",
 CellChangeTimes->{{3.843208946918849*^9, 3.843209104248993*^9}, 
   3.8432270637853537`*^9, {3.8432271359179077`*^9, 3.843227142666748*^9}, {
   3.843227174305813*^9, 3.843227178017243*^9}, {3.843228265535063*^9, 
   3.8432282659110117`*^9}, {3.843228347181333*^9, 3.8432283731863003`*^9}, {
   3.8432315308408546`*^9, 3.8432315328265057`*^9}, {3.8432341228685427`*^9, 
   3.843234165263495*^9}, {3.84323427328402*^9, 3.8432343582078342`*^9}, {
   3.8433030017525597`*^9, 3.843303047494583*^9}, {3.843303125983904*^9, 
   3.84330312671139*^9}, {3.8433067557915792`*^9, 3.84330675592218*^9}, {
   3.8433095642005653`*^9, 3.8433095906185827`*^9}, {3.843395749445548*^9, 
   3.843395763541402*^9}, {3.8433960167174807`*^9, 3.843396017695148*^9}, {
   3.843567273447645*^9, 3.8435672888493357`*^9}, {3.84357442843193*^9, 
   3.8435745502275333`*^9}, {3.8435748802142677`*^9, 3.84357489269004*^9}},
 CellLabel->"In[82]:=",ExpressionUUID->"9c4939fd-2df6-4c80-9162-c84ec6950a1d"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"0.0007497499876273349`"},
      {"0.0013469982853464922`"},
      {"0.00003500685048957877`"},
      {"0.027911985658387404`"}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.8435744839738894`*^9, 3.843574550761787*^9}, {
  3.8435748812086143`*^9, 3.8435748934028683`*^9}},
 CellLabel->
  "Out[82]//MatrixForm=",ExpressionUUID->"1207a851-d963-4c2e-9b4c-\
20c0b102de05"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Block", "[", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Lambda]", "=", "0.2"}], ",", 
       RowBox[{"\[Delta]", "=", 
        RowBox[{"{", 
         RowBox[{"0.5", ",", "0.5"}], "}"}]}], ",", " ", 
       RowBox[{"r", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "0"}], "}"}]}], ",", " ", 
       RowBox[{"krange", "=", "50"}], ",", 
       RowBox[{"range", "=", "3"}]}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ProjIntNN", "[", 
        RowBox[{"\[Lambda]", ",", "\[Delta]", ",", "r", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], ",", "krange", 
         ",", "range"}], "]"}], ",", 
       RowBox[{"ProjIntNN", "[", 
        RowBox[{"\[Lambda]", ",", "\[Delta]", ",", "r", ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "2", ",", "2", ",", "2"}], "}"}], ",", "krange", 
         ",", "range"}], "]"}], ",", 
       RowBox[{"ProjIntNN", "[", 
        RowBox[{"\[Lambda]", ",", "\[Delta]", ",", "r", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1", ",", "2", ",", "2"}], "}"}], ",", "krange", 
         ",", "range"}], "]"}], ",", 
       RowBox[{"ProjIntNN", "[", 
        RowBox[{"\[Lambda]", ",", "\[Delta]", ",", "r", ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "2", ",", "1", ",", "1"}], "}"}], ",", "krange", 
         ",", "range"}], "]"}]}], "}"}]}], "]"}], "//", "MatrixForm"}], "//", 
  "Chop"}]], "Input",
 CellChangeTimes->{{3.843208946918849*^9, 3.843209104248993*^9}, 
   3.8432270637853537`*^9, {3.8432271359179077`*^9, 3.843227142666748*^9}, {
   3.843227174305813*^9, 3.843227178017243*^9}, {3.843228265535063*^9, 
   3.8432282659110117`*^9}, {3.843228347181333*^9, 3.8432283731863003`*^9}, {
   3.8432315308408546`*^9, 3.8432315328265057`*^9}, {3.8432341228685427`*^9, 
   3.843234165263495*^9}, {3.84323427328402*^9, 3.8432343582078342`*^9}, {
   3.8433030017525597`*^9, 3.843303047494583*^9}, {3.843303125983904*^9, 
   3.84330312671139*^9}, {3.8433067557915792`*^9, 3.84330675592218*^9}, {
   3.8433095642005653`*^9, 3.8433095906185827`*^9}, {3.843395749445548*^9, 
   3.843395763541402*^9}, {3.8433960167174807`*^9, 3.843396017695148*^9}, {
   3.843567273447645*^9, 3.8435672888493357`*^9}, {3.84357442843193*^9, 
   3.843574554875105*^9}, {3.843574884366379*^9, 3.843574889606659*^9}},
 CellLabel->"In[81]:=",ExpressionUUID->"f4d04436-ef94-493f-98f8-00c69e7a22ad"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"0.0013469982854183104`"},
      {"0.0007497499875945438`"},
      {"0.00003500685007495492`"},
      {"0.02791198567091621`"}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.8435745554086733`*^9, {3.843574885248255*^9, 3.8435748900949697`*^9}},
 CellLabel->
  "Out[81]//MatrixForm=",ExpressionUUID->"dd83a5fe-85df-411d-9599-\
9bd39284ee5c"]
}, Open  ]],

Cell["Spin flip-Spin flip channel", "Text",
 CellChangeTimes->{{3.843574632094693*^9, 3.843574635298761*^9}, {
  3.843574704973558*^9, 
  3.84357471651462*^9}},ExpressionUUID->"17535c6e-da2c-42e6-b5f9-\
e7d6884f6c22"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Block", "[", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Lambda]", "=", "0.2"}], ",", 
       RowBox[{"\[Delta]", "=", 
        RowBox[{"{", 
         RowBox[{"0.5", ",", "0.5"}], "}"}]}], ",", " ", 
       RowBox[{"r", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "0"}], "}"}]}], ",", " ", 
       RowBox[{"krange", "=", "50"}], ",", 
       RowBox[{"range", "=", "3"}]}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ProjIntSF", "[", 
        RowBox[{"\[Lambda]", ",", "\[Delta]", ",", "r", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2", ",", "1", ",", "2"}], "}"}], ",", "krange", 
         ",", "range"}], "]"}], ",", 
       RowBox[{"ProjIntSF", "[", 
        RowBox[{"\[Lambda]", ",", "\[Delta]", ",", "r", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2", ",", "2", ",", "1"}], "}"}], ",", "krange", 
         ",", "range"}], "]"}], ",", 
       RowBox[{"ProjIntSF", "[", 
        RowBox[{"\[Lambda]", ",", "\[Delta]", ",", "r", ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "1", ",", "1", ",", "2"}], "}"}], ",", "krange", 
         ",", "range"}], "]"}], ",", 
       RowBox[{"ProjIntSF", "[", 
        RowBox[{"\[Lambda]", ",", "\[Delta]", ",", "r", ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "1", ",", "2", ",", "1"}], "}"}], ",", "krange", 
         ",", "range"}], "]"}]}], "}"}]}], "]"}], "//", "MatrixForm"}], "//", 
  "Chop"}]], "Input",
 CellChangeTimes->{{3.843208946918849*^9, 3.843209104248993*^9}, 
   3.8432270637853537`*^9, {3.8432271359179077`*^9, 3.843227142666748*^9}, {
   3.843227174305813*^9, 3.843227178017243*^9}, {3.843228265535063*^9, 
   3.8432282659110117`*^9}, {3.843228347181333*^9, 3.8432283731863003`*^9}, {
   3.8432315308408546`*^9, 3.8432315328265057`*^9}, {3.8432341228685427`*^9, 
   3.843234165263495*^9}, {3.84323427328402*^9, 3.8432343582078342`*^9}, {
   3.8433030017525597`*^9, 3.843303047494583*^9}, {3.843303125983904*^9, 
   3.84330312671139*^9}, {3.8433067557915792`*^9, 3.84330675592218*^9}, {
   3.8433095642005653`*^9, 3.8433095906185827`*^9}, {3.843395749445548*^9, 
   3.843395763541402*^9}, {3.8433960167174807`*^9, 3.843396017695148*^9}, {
   3.843567273447645*^9, 3.8435672888493357`*^9}, {3.84357442843193*^9, 
   3.843574554875105*^9}, {3.843574587735322*^9, 3.843574588943419*^9}, {
   3.84357463874571*^9, 3.843574654946863*^9}, {3.843574936041811*^9, 
   3.843574939054985*^9}, {3.8435749793162622`*^9, 3.843574994944026*^9}},
 CellLabel->"In[88]:=",ExpressionUUID->"7d35f3f9-98bb-4cbb-8b9e-19f1a051c719"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{
        RowBox[{"-", "8.846637576769097`*^-6"}], "+", 
        RowBox[{"0.000018776979725564058`", " ", "\[ImaginaryI]"}]}]},
      {
       RowBox[{
        RowBox[{"-", "0.0008025583823218429`"}], "-", 
        RowBox[{"0.0004971456227146406`", " ", "\[ImaginaryI]"}]}]},
      {
       RowBox[{
        RowBox[{"-", "6.169302993020879`*^-6"}], "-", 
        RowBox[{"0.000737042519007919`", " ", "\[ImaginaryI]"}]}]},
      {
       RowBox[{"0.027718558625287586`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.0020091227324260798`", " ", "\[ImaginaryI]"}]}]}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.843574655410705*^9, {3.843574936597439*^9, 3.8435749415318213`*^9}, {
   3.843574984604982*^9, 3.843574995208412*^9}},
 CellLabel->
  "Out[88]//MatrixForm=",ExpressionUUID->"b5c0a247-e2ad-40d3-91e2-\
1553b9a86380"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Block", "[", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Lambda]", "=", "0.2"}], ",", 
       RowBox[{"\[Delta]", "=", 
        RowBox[{"{", 
         RowBox[{"0.5", ",", "0.5"}], "}"}]}], ",", " ", 
       RowBox[{"r", "=", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0"}], "}"}]}], ",", " ", 
       RowBox[{"krange", "=", "50"}], ",", 
       RowBox[{"range", "=", "3"}]}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ProjIntSF", "[", 
        RowBox[{"\[Lambda]", ",", "\[Delta]", ",", "r", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2", ",", "1", ",", "2"}], "}"}], ",", "krange", 
         ",", "range"}], "]"}], ",", 
       RowBox[{"ProjIntSF", "[", 
        RowBox[{"\[Lambda]", ",", "\[Delta]", ",", "r", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2", ",", "2", ",", "1"}], "}"}], ",", "krange", 
         ",", "range"}], "]"}], ",", 
       RowBox[{"ProjIntSF", "[", 
        RowBox[{"\[Lambda]", ",", "\[Delta]", ",", "r", ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "1", ",", "1", ",", "2"}], "}"}], ",", "krange", 
         ",", "range"}], "]"}], ",", 
       RowBox[{"ProjIntSF", "[", 
        RowBox[{"\[Lambda]", ",", "\[Delta]", ",", "r", ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "1", ",", "2", ",", "1"}], "}"}], ",", "krange", 
         ",", "range"}], "]"}]}], "}"}]}], "]"}], "//", "MatrixForm"}], "//", 
  "Chop"}]], "Input",
 CellChangeTimes->{{3.843208946918849*^9, 3.843209104248993*^9}, 
   3.8432270637853537`*^9, {3.8432271359179077`*^9, 3.843227142666748*^9}, {
   3.843227174305813*^9, 3.843227178017243*^9}, {3.843228265535063*^9, 
   3.8432282659110117`*^9}, {3.843228347181333*^9, 3.8432283731863003`*^9}, {
   3.8432315308408546`*^9, 3.8432315328265057`*^9}, {3.8432341228685427`*^9, 
   3.843234165263495*^9}, {3.84323427328402*^9, 3.8432343582078342`*^9}, {
   3.8433030017525597`*^9, 3.843303047494583*^9}, {3.843303125983904*^9, 
   3.84330312671139*^9}, {3.8433067557915792`*^9, 3.84330675592218*^9}, {
   3.8433095642005653`*^9, 3.8433095906185827`*^9}, {3.843395749445548*^9, 
   3.843395763541402*^9}, {3.8433960167174807`*^9, 3.843396017695148*^9}, {
   3.843567273447645*^9, 3.8435672888493357`*^9}, {3.84357442843193*^9, 
   3.843574554875105*^9}, {3.843574587735322*^9, 3.843574588943419*^9}, {
   3.84357463874571*^9, 3.843574661614353*^9}, {3.8435749864298077`*^9, 
   3.8435749893456287`*^9}},
 CellLabel->"In[89]:=",ExpressionUUID->"72983765-367c-4131-ad43-47880df80ae2"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{
        RowBox[{"-", "8.846637173492655`*^-6"}], "-", 
        RowBox[{"0.000018776979626103033`", " ", "\[ImaginaryI]"}]}]},
      {
       RowBox[{
        RowBox[{"-", "6.1693030360700504`*^-6"}], "+", 
        RowBox[{"0.0007370425190096956`", " ", "\[ImaginaryI]"}]}]},
      {
       RowBox[{
        RowBox[{"-", "0.0008025583822547651`"}], "+", 
        RowBox[{"0.0004971456226992374`", " ", "\[ImaginaryI]"}]}]},
      {
       RowBox[{"0.027718558613533256`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.0020091227368867707`", " ", "\[ImaginaryI]"}]}]}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.8435746620624332`*^9, 3.8435749897974586`*^9, 
  3.843575043986141*^9},
 CellLabel->
  "Out[89]//MatrixForm=",ExpressionUUID->"2eb6df80-73ab-4b52-8926-\
d648bb52e6cf"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Block", "[", " ", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Delta]", "=", 
      RowBox[{"{", 
       RowBox[{"0.5", ",", "0.5"}], "}"}]}], ",", " ", 
     RowBox[{"r", "=", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0"}], "}"}]}], ",", " ", 
     RowBox[{"krange", "=", "50"}], ",", 
     RowBox[{"range", "=", "3"}]}], "}"}], ",", 
   RowBox[{"DiscretePlot", "[", " ", 
    RowBox[{
     FractionBox[
      RowBox[{"Abs", "[", 
       RowBox[{
        RowBox[{"ProjIntSF", "[", 
         RowBox[{"\[Lambda]", ",", "\[Delta]", ",", "r", ",", 
          RowBox[{"{", 
           RowBox[{"2", ",", "1", ",", "2", ",", "1"}], "}"}], ",", "krange", 
          ",", "range"}], "]"}], "-", 
        RowBox[{"ProjIntNN", "[", 
         RowBox[{"\[Lambda]", ",", "\[Delta]", ",", "r", ",", 
          RowBox[{"{", 
           RowBox[{"2", ",", "2", ",", "1", ",", "1"}], "}"}], ",", "krange", 
          ",", "range"}], "]"}]}], "]"}], 
      RowBox[{"ProjIntNN", "[", 
       RowBox[{"\[Lambda]", ",", "\[Delta]", ",", "r", ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "2", ",", "1", ",", "1"}], "}"}], ",", "krange", 
        ",", "range"}], "]"}]], ",", 
     RowBox[{"{", 
      RowBox[{"\[Lambda]", ",", "0.", ",", "0.5", ",", "0.05"}], "}"}], ",", 
     RowBox[{"PlotLegends", "\[Rule]", "Automatic"}]}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.843575495433082*^9, 3.8435755392410316`*^9}, {
  3.8435755926123734`*^9, 3.843575612702237*^9}},
 CellLabel->"In[94]:=",ExpressionUUID->"e21274e8-ec66-4681-ae4b-8ff8b5d20dc3"],

Cell[BoxData[
 GraphicsBox[{{
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.012833333333333334`],
      AbsoluteThickness[1.6], 
     TagBox[{},
      Annotation[#, "Charting`Private`Tag$188171#1"]& ]}, 
    TagBox[
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
      0.012833333333333334`], AbsoluteThickness[1.6], 
      LineBox[{{{0., 0.}, {0.05, 0.004641792129528289}, {0.1, 
       0.018459067881202707`}, {0.15000000000000002`, 0.0411530484109336}, {
       0.2, 0.07231346131867263}, {0.25, 0.11155694114769515`}, {
       0.30000000000000004`, 0.15872622418095944`}, {0.35000000000000003`, 
       0.21413621230204694`}, {0.4, 0.278822421628743}, {0.45, 
       0.35470382343562956`}, {0.5, 0.4445321006090639}}}], {}, {}},
     Annotation[#, "Charting`Private`Tag$188171#1"]& ]}, {}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->True,
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImageSize->Medium,
  LabelStyle->{FontSize -> 18, FontFamily -> "Times", 
    GrayLevel[0]},
  Method->{
   "MessagesHead" -> DiscretePlot, "AxisPadding" -> Scaled[0.02], 
    "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "DefaultPlotStyle" -> {
      Directive[
       RGBColor[0.368417, 0.506779, 0.709798], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.880722, 0.611041, 0.142051], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.560181, 0.691569, 0.194885], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.922526, 0.385626, 0.209179], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.528488, 0.470624, 0.701351], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.772079, 0.431554, 0.102387], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.363898, 0.618501, 0.782349], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[1, 0.75, 0], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.647624, 0.37816, 0.614037], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.571589, 0.586483, 0.], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.915, 0.3325, 0.2125], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.40082222609352647`, 0.5220066643438841, 0.85], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.9728288904374106, 0.621644452187053, 0.07336199581899142], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.736782672705901, 0.358, 0.5030266573755369], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.28026441037696703`, 0.715, 0.4292089322474965], 
       AbsoluteThickness[1.6]]}, "DomainPadding" -> Scaled[0.02], 
    "PointSizeFunction" -> "SmallPointSize", "RangePadding" -> Scaled[0.05]},
  PlotRange->{{0., 0.5}, {0, 0.4445321006090639}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.84357554117423*^9, 3.843575562659381*^9}, {
  3.84357560275187*^9, 3.843575632612715*^9}},
 CellLabel->"Out[94]=",ExpressionUUID->"75c371ac-ecc2-4681-9bc5-c461774b7adc"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Block", "[", " ", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Lambda]", "=", "0.0"}], ",", 
     RowBox[{"\[Delta]", "=", "0.5"}], ",", " ", 
     RowBox[{"r", "=", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0"}], "}"}]}], ",", " ", 
     RowBox[{"krange", "=", "50"}], ",", 
     RowBox[{"range", "=", "3"}]}], "}"}], ",", 
   RowBox[{"DiscretePlot", "[", " ", 
    RowBox[{
     FractionBox[
      RowBox[{"Abs", "[", 
       RowBox[{
        RowBox[{"ProjIntNN", "[", 
         RowBox[{"\[Lambda]", ",", 
          RowBox[{"\[Delta]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
             RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"2", ",", "1", ",", "2", ",", "1"}], "}"}], ",", "krange", 
          ",", "range"}], "]"}], "-", 
        RowBox[{"ProjIntNN", "[", 
         RowBox[{"\[Lambda]", ",", 
          RowBox[{"\[Delta]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
             RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"2", ",", "2", ",", "1", ",", "1"}], "}"}], ",", "krange", 
          ",", "range"}], "]"}]}], "]"}], 
      RowBox[{"ProjIntNN", "[", 
       RowBox[{"\[Lambda]", ",", "\[Delta]", ",", "r", ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "2", ",", "1", ",", "1"}], "}"}], ",", "krange", 
        ",", "range"}], "]"}]], ",", 
     RowBox[{"{", 
      RowBox[{"\[Theta]", ",", "0.", ",", 
       RowBox[{"2", "\[Pi]"}], ",", "0.1"}], "}"}], ",", 
     RowBox[{"PlotLegends", "\[Rule]", "Automatic"}]}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.843575495433082*^9, 3.8435755392410316`*^9}, {
  3.8435755926123734`*^9, 3.843575612702237*^9}, {3.843575695185254*^9, 
  3.843575746509293*^9}},
 CellLabel->"In[95]:=",ExpressionUUID->"c7827ae7-95e5-43f2-8f28-c75afded4a5c"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.8435758173492193`*^9},
 CellLabel->"Out[95]=",ExpressionUUID->"164e61c2-0ac6-404a-ad9b-320d3ee6e179"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Block", "[", " ", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Lambda]", "=", "0.2"}], ",", 
     RowBox[{"\[Delta]", "=", "0.5"}], ",", " ", 
     RowBox[{"r", "=", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0"}], "}"}]}], ",", " ", 
     RowBox[{"krange", "=", "50"}], ",", 
     RowBox[{"range", "=", "3"}]}], "}"}], ",", 
   RowBox[{"DiscretePlot", "[", " ", 
    RowBox[{
     FractionBox[
      RowBox[{"Abs", "[", 
       RowBox[{
        RowBox[{"ProjIntNN", "[", 
         RowBox[{"\[Lambda]", ",", 
          RowBox[{"\[Delta]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
             RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"2", ",", "1", ",", "2", ",", "1"}], "}"}], ",", "krange", 
          ",", "range"}], "]"}], "-", 
        RowBox[{"ProjIntNN", "[", 
         RowBox[{"\[Lambda]", ",", 
          RowBox[{"\[Delta]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
             RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"2", ",", "2", ",", "1", ",", "1"}], "}"}], ",", "krange", 
          ",", "range"}], "]"}]}], "]"}], 
      RowBox[{"ProjIntNN", "[", 
       RowBox[{"\[Lambda]", ",", "\[Delta]", ",", "r", ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "2", ",", "1", ",", "1"}], "}"}], ",", "krange", 
        ",", "range"}], "]"}]], ",", 
     RowBox[{"{", 
      RowBox[{"\[Theta]", ",", "0.", ",", 
       RowBox[{"2", "\[Pi]"}], ",", "0.1"}], "}"}], ",", 
     RowBox[{"PlotLegends", "\[Rule]", "Automatic"}]}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.843575495433082*^9, 3.8435755392410316`*^9}, {
  3.8435755926123734`*^9, 3.843575612702237*^9}, {3.843575695185254*^9, 
  3.843575751687459*^9}},
 CellLabel->"In[99]:=",ExpressionUUID->"fd93a818-630d-4a79-a299-f26d0d4760c1"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1280, 697},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"12.3 for Mac OS X x86 (64-bit) (July 9, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"46474b0f-0c61-48ea-8e3e-4e53c75ef697"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 159, 3, 54, "Subsection",ExpressionUUID->"07d6bec8-9c1e-46a2-ad2c-85f77428a471"],
Cell[742, 27, 171, 3, 35, "Text",ExpressionUUID->"a0560605-83d1-4d4a-9a3b-edb14d273790"],
Cell[916, 32, 1411, 33, 73, "Input",ExpressionUUID->"57f4e770-ffeb-464a-a3f2-12bb8e802f8c"],
Cell[2330, 67, 1140, 27, 52, "Input",ExpressionUUID->"c8484170-dc42-4388-9bfa-e706337ff35a"],
Cell[3473, 96, 1317, 28, 52, "Input",ExpressionUUID->"c84f6bab-d191-49b4-97da-328cca6f5599"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4827, 129, 158, 3, 54, "Subsection",ExpressionUUID->"521b07db-c761-4814-a452-c7a75882d097"],
Cell[4988, 134, 199, 3, 35, "Text",ExpressionUUID->"109ff662-d245-4168-b507-4c4fc8be8cee"],
Cell[5190, 139, 1140, 28, 47, "Input",ExpressionUUID->"15ff82a1-8e5b-4911-b659-fff841949832"],
Cell[6333, 169, 170, 3, 35, "Text",ExpressionUUID->"c8d6a7fb-5260-4305-bf4c-ca053da22b04"],
Cell[6506, 174, 774, 21, 73, "Input",ExpressionUUID->"06e050e9-e984-4927-8d8f-de7e65221802"],
Cell[7283, 197, 320, 8, 51, "Input",ExpressionUUID->"243d708e-790e-4496-b32e-bfdc3f4d2a79"],
Cell[7606, 207, 220, 5, 35, "Text",ExpressionUUID->"3fa4ab7f-62b2-44da-9bde-b9f6ad7933a2"],
Cell[7829, 214, 753, 20, 30, "Input",ExpressionUUID->"87e3d5d3-a22f-445e-ae66-fc4bc200d674"],
Cell[8585, 236, 913, 23, 30, "Input",ExpressionUUID->"778b0bcb-97f8-40f2-adfb-fce8d2ae31ca"],
Cell[9501, 261, 338, 8, 30, "Input",ExpressionUUID->"30d49982-d56b-4e99-9f7a-01480d359504"],
Cell[9842, 271, 242, 5, 35, "Text",ExpressionUUID->"f8c62d69-2cf7-434a-b29e-16b6b5056622"]
}, Closed]],
Cell[CellGroupData[{
Cell[10121, 281, 165, 3, 38, "Subsection",ExpressionUUID->"7b353e65-dd20-44fa-b0f3-4b8d69c3346f"],
Cell[10289, 286, 1331, 33, 47, "Input",ExpressionUUID->"fa4ce392-eb23-4152-ad5f-92c281a2914a"],
Cell[11623, 321, 998, 27, 36, "Input",ExpressionUUID->"dfbde7e1-93df-4de2-8bcb-675ba6b28a2e"],
Cell[12624, 350, 5373, 122, 136, "Input",ExpressionUUID->"ca41ad49-43c1-4dff-a854-535549111d73"],
Cell[CellGroupData[{
Cell[18022, 476, 720, 19, 30, "Input",ExpressionUUID->"aa5efb6d-c1b4-42eb-9ed8-640a83a43f6b"],
Cell[18745, 497, 2928, 70, 128, "Output",ExpressionUUID->"8ee94f92-33be-4d65-a6f1-02c49f369594"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21710, 572, 824, 21, 30, "Input",ExpressionUUID->"adb3880e-2bbf-4fd7-a51c-1c49fb4f4796"],
Cell[22537, 595, 474, 6, 34, "Output",ExpressionUUID->"88b4777c-b2df-494e-be54-13a2b3f86196"]
}, Open  ]],
Cell[23026, 604, 2972, 59, 73, "Input",ExpressionUUID->"541b3bc4-e2f7-4da1-849f-f725c496a9f9"],
Cell[CellGroupData[{
Cell[26023, 667, 172, 3, 45, "Subsubsection",ExpressionUUID->"963bec16-021f-432e-bf75-faf5817239f6"],
Cell[26198, 672, 498, 13, 48, "Input",ExpressionUUID->"e00ef0bf-99db-4f1c-a8ef-7ac91f3cde50"],
Cell[26699, 687, 950, 21, 30, "Input",ExpressionUUID->"25958d7b-b9a9-4c95-8991-5cdc4e5fef2c"],
Cell[27652, 710, 1112, 21, 30, "Input",ExpressionUUID->"eb542c25-3330-43db-a07f-edb7fb5f05c2"],
Cell[28767, 733, 1443, 25, 30, "Input",ExpressionUUID->"05b47974-6cba-4218-b71b-c7730aa6fd07"],
Cell[CellGroupData[{
Cell[30235, 762, 4092, 76, 52, "Input",ExpressionUUID->"3934de57-11ba-4d58-990c-f2d6f65781cf"],
Cell[34330, 840, 20476, 363, 357, "Output",ExpressionUUID->"3608c241-e951-4fb4-87d7-0b9e74aa8b5a"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[54867, 1210, 179, 3, 38, "Subsection",ExpressionUUID->"c0db6db7-a07a-45d8-935c-5bf56c671aed"],
Cell[55049, 1215, 1190, 30, 30, "Input",ExpressionUUID->"5bcf155a-c3f5-468b-a0e4-997b89f59807"],
Cell[56242, 1247, 938, 26, 50, "Input",ExpressionUUID->"f0293f60-31aa-48b0-bdaa-261b3acaf7bb"],
Cell[57183, 1275, 979, 28, 52, "Input",ExpressionUUID->"98980d56-b8d1-47cd-9d3b-b1c58248d909"],
Cell[CellGroupData[{
Cell[58187, 1307, 495, 11, 30, "Input",ExpressionUUID->"de0a82f5-00e6-4a94-b8a7-79374154d2d7"],
Cell[58685, 1320, 936, 28, 128, "Output",ExpressionUUID->"4b976017-6af0-439a-9167-148b1ec2b9ea"]
}, Open  ]],
Cell[59636, 1351, 539, 11, 30, "Input",ExpressionUUID->"d222b2f6-c737-499e-b63a-8393ab2c0449"],
Cell[60178, 1364, 371, 9, 30, "Input",ExpressionUUID->"813a1f18-93ba-4883-bbf5-bbf53967d8de"],
Cell[60552, 1375, 2782, 73, 98, "Input",ExpressionUUID->"d2ffc4c8-6a93-481c-bd7b-3e61ae3b461f"],
Cell[63337, 1450, 2796, 72, 98, "Input",ExpressionUUID->"55f8820f-30f4-4933-813c-9f29cc329311"],
Cell[CellGroupData[{
Cell[66158, 1526, 959, 24, 30, "Input",ExpressionUUID->"c62f079f-9a25-4ba3-ae46-47ed97aa4685"],
Cell[67120, 1552, 1077, 30, 128, "Output",ExpressionUUID->"c3ea0ced-4e70-4605-8828-e17863fdb1b9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[68234, 1587, 1010, 25, 30, "Input",ExpressionUUID->"309d1fc9-3236-4f1f-9876-8d0f6b8e5a7c"],
Cell[69247, 1614, 1026, 29, 128, "Output",ExpressionUUID->"392fe22f-6e14-4e91-bf19-c57bc0453251"]
}, Open  ]],
Cell[CellGroupData[{
Cell[70310, 1648, 1190, 29, 52, "Input",ExpressionUUID->"8dbde52f-833d-4065-a986-065fc4c64cc5"],
Cell[71503, 1679, 835, 27, 128, "Output",ExpressionUUID->"b1e60f56-1fe6-4195-87ff-644a91fd88a8"]
}, Open  ]],
Cell[72353, 1709, 463, 10, 30, "Input",ExpressionUUID->"fb7ec486-83cc-4afb-b50e-fb80ce48715a"],
Cell[CellGroupData[{
Cell[72841, 1723, 1472, 35, 52, "Input",ExpressionUUID->"e0bc3e8e-7381-4e81-acae-f7ed8f04ee87"],
Cell[74316, 1760, 864, 27, 128, "Output",ExpressionUUID->"a01c514e-71c6-4ec6-93de-3fe85ff3e36e"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[75229, 1793, 167, 3, 38, "Subsection",ExpressionUUID->"e4ffa03c-d6e0-4129-a75b-62b04b669d13"],
Cell[75399, 1798, 1663, 41, 94, "Input",ExpressionUUID->"760eca93-4128-42ff-b526-795a8dc88336"],
Cell[CellGroupData[{
Cell[77087, 1843, 471, 12, 30, "Input",ExpressionUUID->"eed8ba0f-ccc4-4e23-aa44-831b967cc90a"],
Cell[77561, 1857, 1572, 40, 128, "Output",ExpressionUUID->"952db435-6ca0-4ec5-871c-2d5d33c1e722"]
}, Open  ]],
Cell[79148, 1900, 2475, 51, 72, "Input",ExpressionUUID->"f41e80d9-a9da-4a41-a750-0598a8ddebbc"],
Cell[81626, 1953, 179, 3, 35, "Text",ExpressionUUID->"5088b1e8-9453-42a9-bde7-a5e70ac2e0d4"],
Cell[81808, 1958, 2348, 42, 52, "Input",ExpressionUUID->"06492172-d07d-4453-8021-49ca3b27a6c3"],
Cell[CellGroupData[{
Cell[84181, 2004, 760, 19, 30, "Input",ExpressionUUID->"8c0866db-2d33-4f5b-bada-30cf2555298f"],
Cell[84944, 2025, 1609, 41, 128, "Output",ExpressionUUID->"cbc6b239-28f1-45ba-a138-98fe92143e2f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[86590, 2071, 764, 19, 30, "Input",ExpressionUUID->"33f51db6-bbf9-48f3-b4e7-94e2f9c9af47"],
Cell[87357, 2092, 487, 10, 45, "Output",ExpressionUUID->"2f27efde-22b0-4f45-8cba-6a3eaaf322ed"]
}, Open  ]],
Cell[87859, 2105, 2114, 49, 96, "Input",ExpressionUUID->"50f17a72-c808-4249-9245-ac353d7315dd"],
Cell[CellGroupData[{
Cell[89998, 2158, 165, 3, 45, "Subsubsection",ExpressionUUID->"2bf2be58-8411-4dfe-9f02-ee60aca83427"],
Cell[CellGroupData[{
Cell[90188, 2165, 5344, 88, 52, "Input",ExpressionUUID->"d44b50fd-3bb8-4fac-b937-d65ad69e289c"],
Cell[95535, 2255, 5746, 134, 70, "Output",ExpressionUUID->"b8a5ecbd-fce8-443d-81cf-884d350c1aad"]
}, Open  ]],
Cell[101296, 2392, 200, 3, 35, "Text",ExpressionUUID->"1a10743a-a7d7-4d7c-bb07-f8e7a72568f6"],
Cell[CellGroupData[{
Cell[101521, 2399, 5774, 98, 73, "Input",ExpressionUUID->"3ec2c73c-94f4-4f0b-92cf-d2d5b5926417"],
Cell[107298, 2499, 26848, 573, 70, "Output",ExpressionUUID->"95973877-b737-4b25-b903-399abc38215b"]
}, Open  ]],
Cell[134161, 3075, 194, 3, 35, "Text",ExpressionUUID->"c7a8ff75-a407-46aa-a53f-4a8288953917"],
Cell[CellGroupData[{
Cell[134380, 3082, 5109, 80, 30, "Input",ExpressionUUID->"662e4d66-31af-422b-9bd9-f89f8450b00e"],
Cell[139492, 3164, 1537, 38, 70, "Output",ExpressionUUID->"292f5fb5-e547-4cc4-a1cc-99b3e8876f7c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[141066, 3207, 5038, 79, 30, "Input",ExpressionUUID->"2c2d9949-f777-4462-8c95-79d4b676e5ef"],
Cell[146107, 3288, 1475, 39, 70, "Output",ExpressionUUID->"3eba3282-c55f-4a00-b7b4-3664cf9ad213"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[147643, 3334, 169, 3, 38, "Subsection",ExpressionUUID->"1cdb5c98-707e-4dd5-8f19-710c11c98bbe"],
Cell[147815, 3339, 2902, 71, 115, "Input",ExpressionUUID->"5005e5ae-7b25-4b9e-a638-cd47ff5d5691"],
Cell[150720, 3412, 2998, 72, 115, "Input",ExpressionUUID->"9a4fd334-2b33-4a63-914f-fe0ad9104659"],
Cell[153721, 3486, 2901, 71, 115, "Input",ExpressionUUID->"e00e3591-ede5-435a-a997-0cce1823871f"],
Cell[CellGroupData[{
Cell[156647, 3561, 166, 3, 45, "Subsubsection",ExpressionUUID->"759d9f0a-d624-4e3d-a3c6-7a353b49a41a"],
Cell[CellGroupData[{
Cell[156838, 3568, 1984, 44, 73, "Input",ExpressionUUID->"e50ecbc8-86b2-46a2-9268-87c435963792"],
Cell[158825, 3614, 1459, 38, 298, "Output",ExpressionUUID->"b480fd96-e999-4699-b5b1-2278b8185389"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[160333, 3658, 172, 3, 45, "Subsubsection",ExpressionUUID->"6ae0338c-3680-4f81-8136-ee562d208654"],
Cell[160508, 3663, 417, 7, 30, "Input",ExpressionUUID->"c4ec90a0-020b-4955-a11b-67e1d76e9011"],
Cell[CellGroupData[{
Cell[160950, 3674, 2168, 46, 73, "Input",ExpressionUUID->"8b3b5400-e36e-40e5-8b05-bf7af6264d68"],
Cell[163121, 3722, 3175, 69, 298, "Output",ExpressionUUID->"864f4d8a-e9f8-462c-a0bb-21723ea845f2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[166333, 3796, 1866, 42, 73, "Input",ExpressionUUID->"b565ebb3-78ee-4f80-965c-7fdfef7022b7"],
Cell[168202, 3840, 3328, 73, 304, "Output",ExpressionUUID->"2764ec46-66f6-4048-8381-6ff24f555716"]
}, Open  ]],
Cell[CellGroupData[{
Cell[171567, 3918, 1816, 41, 73, "Input",ExpressionUUID->"7df9cb84-3af4-4686-a8a9-75f394c9eb7c"],
Cell[173386, 3961, 3245, 72, 300, "Output",ExpressionUUID->"e2341556-caec-4b1b-bfd3-9c46e682764c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[176668, 4038, 1759, 41, 73, "Input",ExpressionUUID->"3d006477-1d5f-48e0-b028-d59fdb036845"],
Cell[178430, 4081, 3149, 71, 304, "Output",ExpressionUUID->"f53069b4-bf07-4b2c-a4c1-82fb859ecda5"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[181628, 4158, 168, 3, 45, "Subsubsection",ExpressionUUID->"ff506659-79c7-4fc6-8e5b-a5a7fd4300ee"],
Cell[181799, 4163, 1747, 49, 52, "Input",ExpressionUUID->"d30af0d0-f4c8-4f9b-8d26-69dd36757fb2"],
Cell[CellGroupData[{
Cell[183571, 4216, 1352, 30, 52, "Input",ExpressionUUID->"19eaeb19-dbd5-4ab0-9b0a-fdca14c620e9"],
Cell[184926, 4248, 1286, 38, 298, "Output",ExpressionUUID->"2b86a33b-5de9-429f-9b75-8a06edca37f2"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[186261, 4292, 166, 3, 45, "Subsubsection",ExpressionUUID->"0fb2fdf0-0260-4696-b390-62255a19b15b"],
Cell[186430, 4297, 167, 3, 35, "Text",ExpressionUUID->"363445bd-a902-415d-baf4-0b88ce88ea7a"],
Cell[CellGroupData[{
Cell[186622, 4304, 2486, 51, 73, "Input",ExpressionUUID->"9c4939fd-2df6-4c80-9162-c84ec6950a1d"],
Cell[189111, 4357, 849, 24, 94, "Output",ExpressionUUID->"1207a851-d963-4c2e-9b4c-20c0b102de05"]
}, Open  ]],
Cell[CellGroupData[{
Cell[189997, 4386, 2509, 52, 73, "Input",ExpressionUUID->"f4d04436-ef94-493f-98f8-00c69e7a22ad"],
Cell[192509, 4440, 822, 24, 94, "Output",ExpressionUUID->"dd83a5fe-85df-411d-9599-9bd39284ee5c"]
}, Open  ]],
Cell[193346, 4467, 217, 4, 35, "Text",ExpressionUUID->"17535c6e-da2c-42e6-b5f9-e7d6884f6c22"],
Cell[CellGroupData[{
Cell[193588, 4475, 2656, 54, 73, "Input",ExpressionUUID->"7d35f3f9-98bb-4cbb-8b9e-19f1a051c719"],
Cell[196247, 4531, 1323, 36, 100, "Output",ExpressionUUID->"b5c0a247-e2ad-40d3-91e2-1553b9a86380"]
}, Open  ]],
Cell[CellGroupData[{
Cell[197607, 4572, 2586, 53, 73, "Input",ExpressionUUID->"72983765-367c-4131-ad43-47880df80ae2"],
Cell[200196, 4627, 1275, 35, 100, "Output",ExpressionUUID->"2eb6df80-73ab-4b52-8926-d648bb52e6cf"]
}, Open  ]],
Cell[CellGroupData[{
Cell[201508, 4667, 1584, 39, 109, "Input",ExpressionUUID->"e21274e8-ec66-4681-ae4b-8ff8b5d20dc3"],
Cell[203095, 4708, 3770, 95, 242, "Output",ExpressionUUID->"75c371ac-ecc2-4681-9bc5-c461774b7adc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[206902, 4808, 2145, 54, 137, "Input",ExpressionUUID->"c7827ae7-95e5-43f2-8f28-c75afded4a5c"],
Cell[209050, 4864, 158, 2, 34, "Output",ExpressionUUID->"164e61c2-0ac6-404a-ad9b-320d3ee6e179"]
}, Open  ]],
Cell[209223, 4869, 2145, 54, 137, "Input",ExpressionUUID->"fd93a818-630d-4a79-a299-f26d0d4760c1"]
}, Open  ]]
}, Open  ]]
}
]
*)

