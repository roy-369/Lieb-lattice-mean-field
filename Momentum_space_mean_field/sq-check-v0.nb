(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     63480,       1496]
NotebookOptionsPosition[     59052,       1427]
NotebookOutlinePosition[     59461,       1444]
CellTagsIndexPosition[     59418,       1441]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["Let us try to do square lattice", "Text",
 CellChangeTimes->{{3.844249933231983*^9, 
  3.8442499389838543`*^9}},ExpressionUUID->"2b27f0d7-8173-4305-8b3b-\
7b0527f38ef0"],

Cell[CellGroupData[{

Cell["Set Options", "Subsection",
 CellChangeTimes->{{3.814815516482966*^9, 
  3.814815518871624*^9}},ExpressionUUID->"c9750e18-84bd-4320-b6b9-\
c16a14fe9039"],

Cell["Automating good looking plots", "Text",
 CellChangeTimes->{{3.815486899338563*^9, 
  3.815486918255589*^9}},ExpressionUUID->"963bec2e-ee12-4f45-915f-\
5c34b171b375"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetOptions", "[", " ", 
   RowBox[{"DiscretePlot", ",", 
    RowBox[{"Joined", "\[Rule]", " ", "True"}], ",", " ", 
    RowBox[{"Filling", "\[Rule]", " ", "None"}], ",", 
    RowBox[{"Frame", "\[Rule]", " ", "True"}], ",", 
    RowBox[{"LabelStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontSize", "\[Rule]", "18"}], ",", 
       RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}], ",", "Black"}], 
      "}"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetOptions", "[", " ", 
   RowBox[{"ListPlot", ",", 
    RowBox[{"Joined", "\[Rule]", " ", "True"}], ",", " ", 
    RowBox[{"Filling", "\[Rule]", " ", "None"}], ",", 
    RowBox[{"Frame", "\[Rule]", " ", "True"}], ",", 
    RowBox[{"LabelStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontSize", "\[Rule]", "18"}], ",", 
       RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}], ",", "Black"}], 
      "}"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "Medium"}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"Black", ",", "Thick"}], "}"}]}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.795523983687091*^9, 3.795524053435053*^9}, {
  3.804245632637435*^9, 3.804245654217102*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"167ed483-f1d9-41fc-baa8-0dfc1d0eeb06"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SetOptions", "[", " ", 
    RowBox[{"ListContourPlot", ",", 
     RowBox[{"Frame", "\[Rule]", " ", "True"}], ",", 
     RowBox[{"LabelStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FontSize", "\[Rule]", "18"}], ",", 
        RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}], ",", "Black"}], 
       "}"}]}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}], ";", " ", 
   RowBox[{"SetOptions", "[", " ", 
    RowBox[{"ListDensityPlot", ",", 
     RowBox[{"Frame", "\[Rule]", " ", "True"}], ",", 
     RowBox[{"LabelStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FontSize", "\[Rule]", "18"}], ",", 
        RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}], ",", "Black"}], 
       "}"}]}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}], ";"}], 
  " "}]], "Input",
 CellChangeTimes->{{3.795523983687091*^9, 3.795524053435053*^9}, {
  3.797608872920074*^9, 3.797608893924059*^9}, {3.798814490659062*^9, 
  3.7988145000741367`*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"e6e14c0c-c5ec-45e7-8257-0f4e2f9ff439"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SetOptions", "[", " ", 
    RowBox[{"ContourPlot", ",", 
     RowBox[{"Frame", "\[Rule]", " ", "True"}], ",", 
     RowBox[{"LabelStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FontSize", "\[Rule]", "18"}], ",", 
        RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}], ",", "Black"}], 
       "}"}]}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}], ";", " ", 
   RowBox[{"SetOptions", "[", " ", 
    RowBox[{"DensityPlot", ",", 
     RowBox[{"Frame", "\[Rule]", " ", "True"}], ",", 
     RowBox[{"LabelStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FontFamily", "\[Rule]", "\"\<CMU Serif\>\""}], ",", 
        RowBox[{"FontSize", "\[Rule]", "24"}], ",", "Black"}], "}"}]}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}], ";"}], 
  " "}]], "Input",
 CellChangeTimes->{{3.795523983687091*^9, 3.795524053435053*^9}, {
  3.797608872920074*^9, 3.797608893924059*^9}, {3.798814490659062*^9, 
  3.7988145000741367`*^9}, {3.822490398886307*^9, 3.822490401581625*^9}, {
  3.822492379117022*^9, 3.822492379407649*^9}, {3.822492682673697*^9, 
  3.82249268503117*^9}, {3.822492843076188*^9, 3.822492844015418*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"609e0fef-4a8b-4927-9a42-693e445a7aca"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Parameters", "Subsection",
 CellChangeTimes->{{3.814815526355921*^9, 
  3.814815530775013*^9}},ExpressionUUID->"7d7b0e6f-4b4f-4524-ac55-\
a1170003e310"],

Cell["Lattice vectors, and basis vectors", "Text",
 CellChangeTimes->{{3.815486959258515*^9, 3.815486991960693*^9}, 
   3.815574952439453*^9},ExpressionUUID->"f51f806c-460c-46f2-9ea6-\
a5ab122cb254"],

Cell[BoxData[
 RowBox[{
  RowBox[{"a1", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0"}], "}"}]}], ";", 
  RowBox[{"a2", " ", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7782376773198223`*^9, 3.7782376846375103`*^9}, {
  3.7888779095955067`*^9, 3.788877935042295*^9}, {3.789916165929564*^9, 
  3.789916168841158*^9}, {3.815088597001444*^9, 3.815088608742155*^9}, {
  3.815486964874069*^9, 3.815486998976728*^9}, {3.8155749341053333`*^9, 
  3.815574947688364*^9}, {3.8155749803607388`*^9, 3.815575002934292*^9}, {
  3.844249965096525*^9, 3.844249966324853*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"864772d7-e983-4e5b-a538-6cc0696b44fc"],

Cell["Reciprocal lattice vectors", "Text",
 CellChangeTimes->{{3.8154870054478617`*^9, 
  3.815487011450121*^9}},ExpressionUUID->"37234416-b18d-440d-a2b6-\
050d76ab78ce"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"LatMat", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"a1", ",", "a2"}], "}"}]}], ";"}], " "}], "\n", 
 RowBox[{
  RowBox[{"ReciLatMat", " ", "=", " ", 
   RowBox[{"2", "\[Pi]", " ", 
    RowBox[{
     RowBox[{"Inverse", "[", "LatMat", "]"}], "\[ConjugateTranspose]"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"b1", " ", "=", " ", 
   RowBox[{"ReciLatMat", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], " ", ";", 
  RowBox[{"b2", " ", "=", " ", 
   RowBox[{"ReciLatMat", "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.778237486576742*^9, 3.77823749632824*^9}, {
  3.81548701397711*^9, 3.8154870174866753`*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"b707e040-a6ef-4acf-8e07-2cd9d8c55eed"],

Cell["\<\
kSpan : set of points for k-sums, and rSpan : set of points for r-sums\
\>", "Text",
 CellChangeTimes->{{3.815487024009077*^9, 
  3.815487044172222*^9}},ExpressionUUID->"ac8bd3e2-49eb-4447-87cb-\
e970c49f683d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"kSpan", "[", "krange_", "]"}], ":=", 
   RowBox[{"N", "[", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"i", "*", "b1"}], "+", 
         RowBox[{"j", "*", "b2"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", "0.999", ",", 
          RowBox[{"1", "/", "krange"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "0", ",", "0.999", ",", 
          RowBox[{"1", "/", "krange"}]}], "}"}]}], "]"}], ",", "1"}], "]"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.814530877387206*^9, 3.8145308955429773`*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"da305296-ea08-4266-bf21-0312b3c45702"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Fermi", "[", 
    RowBox[{"\[Beta]_", ",", "x_"}], "]"}], ":=", 
   RowBox[{"Chop", "[", 
    RowBox[{"N", "[", " ", 
     FractionBox["1", 
      RowBox[{"1", "+", " ", 
       RowBox[{"Exp", "[", " ", 
        RowBox[{"\[Beta]", " ", "x"}], "]"}]}]], "]"}], "]"}]}], ";", 
  RowBox[{
   RowBox[{"DFermi", "[", 
    RowBox[{"\[Beta]_", ",", "x_"}], "]"}], " ", ":=", 
   RowBox[{
    RowBox[{"D", "[", " ", 
     RowBox[{
      RowBox[{"Fermi", "[", 
       RowBox[{"\[Beta]", ",", "x1"}], "]"}], ",", "x1"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{"x1", "->", " ", "x"}], "}"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8400081308744993`*^9, 3.840008150377233*^9}, {
   3.840616594960533*^9, 3.840616599789824*^9}, 3.843403757936594*^9},
 CellLabel->"In[10]:=",ExpressionUUID->"16e791ca-8401-4798-84d5-6e029b48a920"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Bloch Hamiltonian", "Subsection",
 CellChangeTimes->{{3.824475546655573*^9, 
  3.824475558234083*^9}},ExpressionUUID->"ccd39444-a18b-43d4-a06d-\
7a049b5a2a4c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", "Energy", "]"}], ";", 
  RowBox[{
   RowBox[{"Energy", "[", "k_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"Energy", "[", "k", "]"}], " ", "=", " ", 
    RowBox[{
     RowBox[{"-", "2"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"k", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], "+", 
       RowBox[{"Cos", "[", 
        RowBox[{"k", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ")"}]}]}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.756319145758149*^9, 3.756319199391032*^9}, {
   3.756319254823587*^9, 3.756319259201173*^9}, {3.756319348399633*^9, 
   3.756319350388073*^9}, {3.7563253311737843`*^9, 3.7563253386032677`*^9}, 
   3.764004797023674*^9, {3.76400486982804*^9, 3.764004916241989*^9}, {
   3.764004975438292*^9, 3.7640050044324083`*^9}, {3.764024156913117*^9, 
   3.764024160642874*^9}, {3.764029189820718*^9, 3.76402919476404*^9}, {
   3.7640292789658823`*^9, 3.7640293060867*^9}, 3.764032841591424*^9, {
   3.7640883565234137`*^9, 3.764088359465539*^9}, {3.773141580247047*^9, 
   3.773141590793106*^9}, {3.773142347123101*^9, 3.7731423535381727`*^9}, {
   3.773162195172791*^9, 3.773162259226844*^9}, {3.779541394105826*^9, 
   3.7795414148062143`*^9}, {3.779541527327392*^9, 3.779541538584597*^9}, {
   3.7816131320104322`*^9, 3.7816131506671667`*^9}, {3.824152792811678*^9, 
   3.8241527958942337`*^9}, 3.824463448454859*^9, 3.824463706769917*^9, {
   3.824475590185144*^9, 3.824475594462983*^9}, {3.8426969252663918`*^9, 
   3.8426969594022923`*^9}, {3.842697128670679*^9, 3.842697144750228*^9}, {
   3.843143432999749*^9, 3.843143469619462*^9}, {3.843143611718019*^9, 
   3.84314367441998*^9}, {3.843144568138142*^9, 3.843144618893168*^9}, {
   3.8431446664655943`*^9, 3.8431449319766607`*^9}, {3.843149998678993*^9, 
   3.8431500253263063`*^9}, {3.8439188681869793`*^9, 3.843918970545743*^9}, {
   3.844246816759201*^9, 3.844246852093615*^9}, {3.844249991965818*^9, 
   3.844250017274088*^9}, {3.844250408468533*^9, 3.844250411952364*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"183cff9e-fb05-4bb6-9dd9-3e1e73f94c58"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", "HamMFU", "]"}], ";", 
  RowBox[{
   RowBox[{"HamMFU", "[", 
    RowBox[{"nup_", ",", " ", "ndn_", ",", " ", "spls_", ",", " ", "smns_"}], 
    "]"}], ":=", " ", 
   RowBox[{
    RowBox[{"HamMFU", "[", 
     RowBox[{"nup", ",", "ndn", ",", " ", "spls", ",", " ", "smns"}], "]"}], 
    " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", " ", 
       RowBox[{"ndn", ",", " ", 
        RowBox[{"-", "smns"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "spls"}], ",", " ", "nup"}], "}"}]}], "}"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.844179339827428*^9, 3.844179378959331*^9}, {
  3.8441794447265778`*^9, 3.844179567894804*^9}, {3.844179608129817*^9, 
  3.8441796195295*^9}, {3.844179671676846*^9, 3.8441797396834507`*^9}, {
  3.844179838385543*^9, 3.844179886925289*^9}, {3.844179923046279*^9, 
  3.844179989493244*^9}, {3.844180333393297*^9, 3.844180357568927*^9}, {
  3.8442500325060463`*^9, 3.844250050468977*^9}, {3.844250092028389*^9, 
  3.8442500967874527`*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"479296fa-05be-4331-acce-897984005df4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", "HamMFull", "]"}], ";", 
  RowBox[{
   RowBox[{"HamMFull", "[", 
    RowBox[{
    "nup_", ",", " ", "ndn_", ",", " ", "spls_", ",", " ", "smns_", ",", "k_",
      ",", "\[Mu]_", ",", "U_"}], "]"}], ":=", " ", 
   RowBox[{
    RowBox[{"HamMFull", "[", 
     RowBox[{
     "nup", ",", "ndn", ",", " ", "spls", ",", " ", "smns", ",", "k", ",", 
      "\[Mu]", ",", "U"}], "]"}], "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"Energy", "[", "k", "]"}], " ", 
      RowBox[{"IdentityMatrix", "[", "2", "]"}]}], " ", "+", 
     RowBox[{"U", " ", 
      RowBox[{"HamMFU", "[", 
       RowBox[{"nup", ",", "ndn", ",", " ", "spls", ",", " ", "smns"}], 
       "]"}]}], " ", "-", " ", 
     RowBox[{"\[Mu]", " ", 
      RowBox[{"IdentityMatrix", "[", "2", "]"}]}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8441800400195007`*^9, 3.844180090820513*^9}, 
   3.844180138392021*^9, {3.844246962277875*^9, 3.8442469682556467`*^9}, {
   3.844250104298263*^9, 3.844250119597115*^9}, {3.844257940630538*^9, 
   3.844257952110807*^9}, {3.84425803027815*^9, 3.844258047401618*^9}, {
   3.844258793069916*^9, 3.8442588001341*^9}, {3.844258834224854*^9, 
   3.84425883757623*^9}, {3.844258896665802*^9, 3.8442589026956577`*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"e77669d5-788e-4b50-bfb5-78f288a5a396"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", "EnerMF", "]"}], ";", 
  RowBox[{
   RowBox[{"EnerMF", "[", 
    RowBox[{
    "nup_", ",", " ", "ndn_", ",", " ", "spls_", ",", " ", "smns_", ",", "k_",
      ",", "\[Mu]_", ",", "U_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"EnerMF", "[", 
     RowBox[{
     "nup", ",", "ndn", ",", " ", "spls", ",", " ", "smns", ",", "k", ",", 
      "\[Mu]", ",", "U"}], "]"}], "=", " ", 
    RowBox[{"Chop", "[", "  ", 
     RowBox[{"N", "[", 
      RowBox[{"Sort", "[", 
       RowBox[{"Eigenvalues", "[", 
        RowBox[{"HamMFull", "[", 
         RowBox[{
         "nup", ",", "ndn", ",", " ", "spls", ",", " ", "smns", ",", "k", ",",
           "\[Mu]", ",", "U"}], "]"}], " ", "]"}], "]"}], "]"}], " ", 
     "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7640176268418016`*^9, 3.764017681895791*^9}, {
   3.764021702190728*^9, 3.7640217419991283`*^9}, {3.764022209123415*^9, 
   3.764022240846314*^9}, {3.764022280257329*^9, 3.764022289529965*^9}, {
   3.76402355674361*^9, 3.76402374296489*^9}, {3.764024197834022*^9, 
   3.764024203283678*^9}, {3.764028125703156*^9, 3.764028132354926*^9}, {
   3.764032955658539*^9, 3.7640329669028063`*^9}, {3.773141720007655*^9, 
   3.773141737471712*^9}, {3.773141771580923*^9, 3.7731418460722857`*^9}, {
   3.773142347171556*^9, 3.773142353609971*^9}, {3.77314464335373*^9, 
   3.773144704735252*^9}, 3.773159680500445*^9, {3.77316222330879*^9, 
   3.7731622593013563`*^9}, {3.77954136696187*^9, 3.779541384616116*^9}, {
   3.779541430401513*^9, 3.779541463746334*^9}, {3.779543267484353*^9, 
   3.7795432791404457`*^9}, {3.779546992278311*^9, 3.77954699397375*^9}, {
   3.78161315469163*^9, 3.781613173495525*^9}, {3.787317050366681*^9, 
   3.787317093092341*^9}, {3.7890593724761753`*^9, 3.789059402708638*^9}, {
   3.7890609447420053`*^9, 3.789060946810433*^9}, 3.790275697889707*^9, {
   3.79060990371898*^9, 3.790609931505509*^9}, {3.793459113361217*^9, 
   3.793459166779313*^9}, {3.8244756508572197`*^9, 3.8244756842611027`*^9}, {
   3.842696930705386*^9, 3.842696952258564*^9}, {3.842697148442912*^9, 
   3.842697160459934*^9}, {3.843144935106803*^9, 3.843144960527883*^9}, {
   3.8439199269968233`*^9, 3.84391993002064*^9}, {3.844180108375601*^9, 
   3.844180155777977*^9}, {3.844246990748128*^9, 3.844246998589899*^9}, {
   3.8442501509430857`*^9, 3.844250155745491*^9}, {3.844257957541572*^9, 
   3.844257964392763*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"09488173-293c-4033-99ce-bf3f35c6b973"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", "ULiebMF", "]"}], ";", 
  RowBox[{
   RowBox[{"ULiebMF", "[", 
    RowBox[{
    "nup_", ",", " ", "ndn_", ",", " ", "spls_", ",", " ", "smns_", ",", "k_",
      ",", "\[Mu]_", ",", "U_"}], "]"}], " ", ":=", 
   RowBox[{
    RowBox[{"ULiebMF", "[", 
     RowBox[{
     "nup", ",", "ndn", ",", " ", "spls", ",", " ", "smns", ",", "k", ",", 
      "\[Mu]", ",", "U"}], "]"}], "=", 
    RowBox[{"Transpose", "[", 
     RowBox[{"Chop", "[", 
      RowBox[{"N", "[", "   ", 
       RowBox[{
        RowBox[{"Transpose", "[", " ", 
         RowBox[{"SortBy", "[", " ", 
          RowBox[{
           RowBox[{"Transpose", "[", " ", 
            RowBox[{"Eigensystem", "[", 
             RowBox[{"HamMFull", "[", 
              RowBox[{
              "nup", ",", "ndn", ",", " ", "spls", ",", " ", "smns", ",", "k",
                ",", "\[Mu]", ",", "U"}], "]"}], "  ", "]"}], " ", "]"}], " ",
            ",", "First"}], " ", "]"}], " ", "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], " ", "]"}], " ", "]"}], " ", 
     "]"}]}]}], " ", ";"}]], "Input",
 CellChangeTimes->{{3.844180161455307*^9, 3.844180185297874*^9}, {
  3.8442470040545053`*^9, 3.8442470091124563`*^9}, {3.844250159079303*^9, 
  3.844250163563478*^9}, {3.8442579666753883`*^9, 3.844257972415954*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"3abd47ca-0f71-4875-89c4-af38cac07d17"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", "IJMat", "]"}], ";", 
  RowBox[{
   RowBox[{"IJMat", "[", 
    RowBox[{"i_", ",", "j_", ",", "N_"}], "]"}], ":=", " ", 
   RowBox[{"ArrayFlatten", "[", " ", 
    RowBox[{"Table", "[", " ", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"i1", "==", "i"}], "&&", 
         RowBox[{"j1", "==", "j"}]}], ",", "1", ",", "0"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i1", ",", "1", ",", "N"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j1", ",", "1", ",", "N"}], "}"}]}], "]"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.844261175758607*^9, 3.8442612176403093`*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"a0c3c7e7-d6cf-447a-bdcd-043f0555da2c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", "nupMF", "]"}], ";", 
  RowBox[{
   RowBox[{"nupMF", "[", 
    RowBox[{
    "nup_", ",", " ", "ndn_", ",", " ", "spls_", ",", " ", "smns_", ",", "U_",
      ",", "\[Mu]_", ",", "\[Beta]_", ",", "krange_"}], "]"}], " ", ":=", 
   RowBox[{
    RowBox[{"nupMF", "[", 
     RowBox[{
     "nup", ",", "ndn", ",", " ", "spls", ",", " ", "smns", ",", "U", ",", 
      "\[Mu]", ",", "\[Beta]", ",", "krange"}], "]"}], "=", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"Length", "[", 
       RowBox[{"kSpan", "[", "krange", "]"}], "]"}]], 
     RowBox[{"Sum", "[", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Fermi", "[", 
         RowBox[{"\[Beta]", ",", " ", 
          RowBox[{
           RowBox[{"EnerMF", "[", 
            RowBox[{
            "nup", ",", "ndn", ",", " ", "spls", ",", " ", "smns", ",", "k", 
             ",", "\[Mu]", ",", "U"}], "]"}], "[", 
           RowBox[{"[", "band", "]"}], "]"}]}], "]"}], 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"um", " ", "=", " ", 
            RowBox[{"ULiebMF", "[", 
             RowBox[{
             "nup", ",", "ndn", ",", " ", "spls", ",", " ", "smns", ",", "k", 
              ",", "\[Mu]", ",", "U"}], "]"}]}], "}"}], ",", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"um", "\[ConjugateTranspose]"}], ".", 
             RowBox[{"(", 
              RowBox[{"IJMat", "[", 
               RowBox[{"1", ",", "1", ",", "2"}], "]"}], ")"}], ".", "um"}], 
            ")"}], "[", 
           RowBox[{"[", 
            RowBox[{"band", ",", "band"}], "]"}], "]"}]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"band", ",", "1", " ", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", 
         RowBox[{"kSpan", "[", "krange", "]"}]}], "}"}]}], "]"}]}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.844180161455307*^9, 3.844180185297874*^9}, {
   3.84418037599235*^9, 3.844180551257277*^9}, {3.844181071770412*^9, 
   3.844181154694335*^9}, 3.844242561260942*^9, {3.8442470123894033`*^9, 
   3.844247019790688*^9}, 3.84424856197187*^9, {3.8442487607991047`*^9, 
   3.844248761500985*^9}, 3.844248934018609*^9, {3.844249012561077*^9, 
   3.844249012754361*^9}, {3.844249581844722*^9, 3.844249582471518*^9}, {
   3.844250167599434*^9, 3.844250237201571*^9}, 3.844250303763424*^9, {
   3.844250426553693*^9, 3.844250426862363*^9}, {3.8442505823191*^9, 
   3.844250582478218*^9}, {3.8442507351487827`*^9, 3.8442507355224447`*^9}, {
   3.8442568744091377`*^9, 3.844256886913288*^9}, {3.8442576709395313`*^9, 
   3.844257722908519*^9}, {3.8442579772675753`*^9, 3.844258020061779*^9}, {
   3.844258085114483*^9, 3.844258090121462*^9}, {3.8442581445537987`*^9, 
   3.8442581450300627`*^9}, 3.844261172963015*^9, {3.844261221797071*^9, 
   3.844261224793508*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"94695af1-3ebe-4eeb-83f8-8d992236d6c0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", "ndnMF", "]"}], ";", 
  RowBox[{
   RowBox[{"ndnMF", "[", 
    RowBox[{
    "nup_", ",", " ", "ndn_", ",", " ", "spls_", ",", " ", "smns_", ",", "U_",
      ",", "\[Mu]_", ",", "\[Beta]_", ",", "krange_"}], "]"}], " ", ":=", 
   RowBox[{
    RowBox[{"ndnMF", "[", 
     RowBox[{
     "nup", ",", "ndn", ",", " ", "spls", ",", " ", "smns", ",", "U", ",", 
      "\[Mu]", ",", "\[Beta]", ",", "krange"}], "]"}], "=", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"Length", "[", 
       RowBox[{"kSpan", "[", "krange", "]"}], "]"}]], 
     RowBox[{"Sum", "[", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Fermi", "[", 
         RowBox[{"\[Beta]", ",", " ", 
          RowBox[{
           RowBox[{"EnerMF", "[", 
            RowBox[{
            "nup", ",", "ndn", ",", " ", "spls", ",", " ", "smns", ",", "k", 
             ",", "\[Mu]", ",", "U"}], "]"}], "[", 
           RowBox[{"[", "band", "]"}], "]"}]}], " ", "]"}], 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"um", " ", "=", " ", 
             RowBox[{"ULiebMF", "[", 
              RowBox[{
              "nup", ",", "ndn", ",", " ", "spls", ",", " ", "smns", ",", "k",
                ",", "\[Mu]", ",", "U"}], "]"}]}], ",", 
            RowBox[{"zr", " ", "=", " ", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "0"}], "}"}]}]}], "}"}], ",", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"um", "\[ConjugateTranspose]"}], ".", 
             RowBox[{"(", 
              RowBox[{"IJMat", "[", 
               RowBox[{"2", ",", "2", ",", "2"}], "]"}], ")"}], ".", "um"}], 
            ")"}], "[", 
           RowBox[{"[", 
            RowBox[{"band", ",", "band"}], "]"}], "]"}]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"band", ",", "1", " ", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", 
         RowBox[{"kSpan", "[", "krange", "]"}]}], "}"}]}], "]"}]}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.844180161455307*^9, 3.844180185297874*^9}, {
   3.84418037599235*^9, 3.844180551257277*^9}, {3.844181071770412*^9, 
   3.844181154694335*^9}, 3.844242561260942*^9, {3.8442470123894033`*^9, 
   3.844247019790688*^9}, 3.84424856197187*^9, {3.8442487607991047`*^9, 
   3.844248761500985*^9}, 3.844248934018609*^9, {3.844249012561077*^9, 
   3.844249012754361*^9}, {3.844249581844722*^9, 3.844249582471518*^9}, {
   3.844250167599434*^9, 3.844250253504888*^9}, 3.8442503002718067`*^9, {
   3.844250585854597*^9, 3.844250586020113*^9}, {3.844250742592317*^9, 
   3.8442507429738827`*^9}, {3.844257733074732*^9, 3.844257744622241*^9}, {
   3.844258098867907*^9, 3.844258102438819*^9}, {3.844258141126595*^9, 
   3.8442581576956987`*^9}, {3.844261233847754*^9, 3.844261241678461*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"75858435-8f2c-4b7e-81a1-927273041fa7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", "splsMF", "]"}], ";", 
  RowBox[{
   RowBox[{"splsMF", "[", 
    RowBox[{
    "nup_", ",", " ", "ndn_", ",", " ", "spls_", ",", " ", "smns_", ",", "U_",
      ",", "\[Mu]_", ",", "\[Beta]_", ",", "krange_"}], "]"}], " ", ":=", 
   RowBox[{
    RowBox[{"splsMF", "[", 
     RowBox[{
     "nup", ",", "ndn", ",", " ", "spls", ",", " ", "smns", ",", "U", ",", 
      "\[Mu]", ",", "\[Beta]", ",", "krange"}], "]"}], "=", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"Length", "[", 
       RowBox[{"kSpan", "[", "krange", "]"}], "]"}]], 
     RowBox[{"Sum", "[", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Fermi", "[", 
         RowBox[{"\[Beta]", ",", " ", 
          RowBox[{
           RowBox[{"EnerMF", "[", 
            RowBox[{
            "nup", ",", "ndn", ",", " ", "spls", ",", " ", "smns", ",", "k", 
             ",", "\[Mu]", ",", "U"}], "]"}], "[", 
           RowBox[{"[", "band", "]"}], "]"}]}], " ", "]"}], 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"um", " ", "=", " ", 
             RowBox[{"ULiebMF", "[", 
              RowBox[{
              "nup", ",", "ndn", ",", " ", "spls", ",", " ", "smns", ",", "k",
                ",", "\[Mu]", ",", "U"}], "]"}]}], ",", 
            RowBox[{"zr", " ", "=", " ", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "0"}], "}"}]}]}], "}"}], ",", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"um", "\[ConjugateTranspose]"}], ".", 
             RowBox[{"(", 
              RowBox[{"-", 
               RowBox[{"IJMat", "[", 
                RowBox[{"2", ",", "1", ",", "2"}], "]"}]}], ")"}], ".", 
             "um"}], ")"}], "[", 
           RowBox[{"[", 
            RowBox[{"band", ",", "band"}], "]"}], "]"}]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"band", ",", "1", " ", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", 
         RowBox[{"kSpan", "[", "krange", "]"}]}], "}"}]}], "]"}]}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.844180161455307*^9, 3.844180185297874*^9}, {
   3.84418037599235*^9, 3.844180551257277*^9}, {3.844181071770412*^9, 
   3.844181154694335*^9}, 3.844242561260942*^9, {3.8442470123894033`*^9, 
   3.844247019790688*^9}, 3.84424856197187*^9, {3.8442487607991047`*^9, 
   3.844248761500985*^9}, 3.844248934018609*^9, {3.844249012561077*^9, 
   3.844249012754361*^9}, {3.844249581844722*^9, 3.844249582471518*^9}, {
   3.844250167599434*^9, 3.844250270384473*^9}, 3.844250302032946*^9, {
   3.844257742028781*^9, 3.844257751470008*^9}, {3.8442581098087254`*^9, 
   3.8442581644355507`*^9}, {3.844261251811145*^9, 3.8442612591647053`*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"2b10e82e-2d65-42f5-8a3e-21d605205d4e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", "smnsMF", "]"}], ";", 
  RowBox[{
   RowBox[{"smnsMF", "[", 
    RowBox[{
    "nup_", ",", " ", "ndn_", ",", " ", "spls_", ",", " ", "smns_", ",", "U_",
      ",", "\[Mu]_", ",", "\[Beta]_", ",", "krange_"}], "]"}], " ", ":=", 
   RowBox[{
    RowBox[{"smnsMF", "[", 
     RowBox[{
     "nup", ",", "ndn", ",", " ", "spls", ",", " ", "smns", ",", "U", ",", 
      "\[Mu]", ",", "\[Beta]", ",", "krange"}], "]"}], "=", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"Length", "[", 
       RowBox[{"kSpan", "[", "krange", "]"}], "]"}]], 
     RowBox[{"Sum", "[", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Fermi", "[", 
         RowBox[{"\[Beta]", ",", " ", 
          RowBox[{
           RowBox[{"EnerMF", "[", 
            RowBox[{
            "nup", ",", "ndn", ",", " ", "spls", ",", " ", "smns", ",", "k", 
             ",", "\[Mu]", ",", "U"}], "]"}], "[", 
           RowBox[{"[", "band", "]"}], "]"}]}], " ", "]"}], 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"um", " ", "=", " ", 
            RowBox[{"ULiebMF", "[", 
             RowBox[{
             "nup", ",", "ndn", ",", " ", "spls", ",", " ", "smns", ",", "k", 
              ",", "\[Mu]", ",", "U"}], "]"}]}], "}"}], ",", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"um", "\[ConjugateTranspose]"}], ".", 
             RowBox[{"(", 
              RowBox[{"-", 
               RowBox[{"IJMat", "[", 
                RowBox[{"1", ",", "2", ",", "2"}], "]"}]}], ")"}], ".", 
             "um"}], ")"}], "[", 
           RowBox[{"[", 
            RowBox[{"band", ",", "band"}], "]"}], "]"}]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"band", ",", "1", " ", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", 
         RowBox[{"kSpan", "[", "krange", "]"}]}], "}"}]}], "]"}]}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.844180161455307*^9, 3.844180185297874*^9}, {
   3.84418037599235*^9, 3.844180551257277*^9}, {3.844181071770412*^9, 
   3.844181154694335*^9}, 3.844242561260942*^9, {3.8442470123894033`*^9, 
   3.844247019790688*^9}, 3.84424856197187*^9, {3.8442487607991047`*^9, 
   3.844248761500985*^9}, 3.844248934018609*^9, {3.844249012561077*^9, 
   3.844249012754361*^9}, {3.844249581844722*^9, 3.844249582471518*^9}, {
   3.844250167599434*^9, 3.844250315800105*^9}, {3.8442577552424593`*^9, 
   3.844257762358344*^9}, {3.844258121322455*^9, 3.844258133247281*^9}, {
   3.844258167067034*^9, 3.844258169218245*^9}, {3.844261265033465*^9, 
   3.844261268516719*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"a267bd39-ae6b-4e3e-95ce-5202e655bc60"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", "NumEq", "]"}], ";", 
  RowBox[{
   RowBox[{"NumEq", "[", 
    RowBox[{
    "nup_", ",", " ", "ndn_", ",", " ", "spls_", ",", " ", "smns_", ",", "U_",
      ",", "\[Mu]_", ",", "\[Beta]_", ",", "krange_"}], "]"}], " ", ":=", 
   RowBox[{
    RowBox[{"NumEq", "[", 
     RowBox[{
     "nup", ",", "ndn", ",", " ", "spls", ",", " ", "smns", ",", "U", ",", 
      "\[Mu]", ",", "\[Beta]", ",", "krange"}], "]"}], "=", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"Length", "[", 
       RowBox[{"kSpan", "[", "krange", "]"}], "]"}]], 
     RowBox[{"Sum", "[", " ", 
      RowBox[{
       RowBox[{"Fermi", "[", 
        RowBox[{"\[Beta]", ",", " ", 
         RowBox[{
          RowBox[{"EnerMF", "[", 
           RowBox[{
           "nup", ",", "ndn", ",", " ", "spls", ",", " ", "smns", ",", "k", 
            ",", "\[Mu]", ",", "U"}], "]"}], "[", 
          RowBox[{"[", "band", "]"}], "]"}]}], " ", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"band", ",", "1", " ", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", 
         RowBox[{"kSpan", "[", "krange", "]"}]}], "}"}]}], "]"}]}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.844180161455307*^9, 3.844180185297874*^9}, {
  3.84418037599235*^9, 3.844180551257277*^9}, {3.844181071770412*^9, 
  3.84418121011119*^9}, {3.844181399453413*^9, 3.844181433066454*^9}, {
  3.844247060565483*^9, 3.844247065836556*^9}, {3.844250289414217*^9, 
  3.844250296965117*^9}, {3.844258128846704*^9, 3.844258128994137*^9}, {
  3.844258172690751*^9, 3.844258175098768*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"c795fa47-334c-47a5-9865-366e59efb9bf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", "FindMu", "]"}], ";", 
  RowBox[{
   RowBox[{"FindMu", "[", 
    RowBox[{
    "nup_", ",", " ", "ndn_", ",", " ", "spls_", ",", " ", "smns_", ",", "U_",
      ",", "fil_", ",", "\[Beta]_", ",", "krange_"}], "]"}], " ", ":=", 
   RowBox[{
    RowBox[{"FindMu", "[", 
     RowBox[{
     "nup", ",", "ndn", ",", " ", "spls", ",", " ", "smns", ",", "U", ",", 
      "fil", ",", "\[Beta]", ",", "krange"}], "]"}], "=", 
    RowBox[{"\[Mu]", "/.", 
     RowBox[{"FindRoot", "[", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"NumEq", "[", 
         RowBox[{
         "nup", ",", "ndn", ",", " ", "spls", ",", " ", "smns", ",", "U", ",",
           "\[Mu]", ",", "\[Beta]", ",", "krange"}], "]"}], "-", "fil"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Mu]", ",", 
         RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", 
       RowBox[{"Evaluated", "\[Rule]", "False"}], ",", " ", 
       RowBox[{"MaxIterations", "\[Rule]", "20"}], ",", 
       RowBox[{"PrecisionGoal", "\[Rule]", "3"}]}], "]"}]}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.844180161455307*^9, 3.844180185297874*^9}, {
  3.84418037599235*^9, 3.844180551257277*^9}, {3.844181071770412*^9, 
  3.84418121011119*^9}, {3.844181399453413*^9, 3.84418149823566*^9}, {
  3.84424706945612*^9, 3.84424707422995*^9}, {3.8442503245198183`*^9, 
  3.8442503290601597`*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"09411c75-cfd8-4738-94bf-516c7eed4c89"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", "ItrFnMF", "]"}], ";", 
  RowBox[{
   RowBox[{"ItrFnMF", "[", 
    RowBox[{"U_", ",", "fil_", ",", "\[Beta]_", ",", "krange_"}], "]"}], ":=",
    " ", 
   RowBox[{
    RowBox[{"ItrFnMF", "[", 
     RowBox[{"U", ",", "fil", ",", "\[Beta]", ",", "krange"}], "]"}], "=", 
    "  ", 
    RowBox[{
     RowBox[{"NestList", "[", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"FindMu", "[", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
            RowBox[{"#", "[", 
             RowBox[{"[", "4", "]"}], "]"}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "5", "]"}], "]"}], ",", "U", ",", "fil", ",", 
            "\[Beta]", ",", "krange"}], "]"}], ",", 
          RowBox[{"nupMF", "[", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
            RowBox[{"#", "[", 
             RowBox[{"[", "4", "]"}], "]"}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "5", "]"}], "]"}], ",", "U", ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", "\[Beta]", ",", "krange"}], 
           "]"}], ",", 
          RowBox[{"ndnMF", "[", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
            RowBox[{"#", "[", 
             RowBox[{"[", "4", "]"}], "]"}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "5", "]"}], "]"}], ",", "U", ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", "\[Beta]", ",", "krange"}], 
           "]"}], " ", ",", " ", 
          RowBox[{"splsMF", "[", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
            RowBox[{"#", "[", 
             RowBox[{"[", "4", "]"}], "]"}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "5", "]"}], "]"}], ",", "U", ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", "\[Beta]", ",", "krange"}], 
           "]"}], ",", 
          RowBox[{"smnsMF", "[", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
            RowBox[{"#", "[", 
             RowBox[{"[", "4", "]"}], "]"}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "5", "]"}], "]"}], ",", "U", ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", "\[Beta]", ",", "krange"}], 
           "]"}]}], "}"}], "&"}], ",", 
       RowBox[{"{", 
        RowBox[{"U", ",", 
         RowBox[{"RandomReal", "[", "]"}], ",", 
         RowBox[{"RandomReal", "[", "]"}], ",", 
         RowBox[{"RandomReal", "[", "]"}], ",", 
         RowBox[{"RandomReal", "[", "]"}]}], "}"}], ",", "10"}], "]"}], "[", 
     RowBox[{"[", "10", "]"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.844181251123393*^9, 3.844181297226589*^9}, {
  3.844181503595025*^9, 3.8441816932211*^9}, {3.844182395042077*^9, 
  3.8441823963267937`*^9}, {3.8442470783294983`*^9, 3.844247096635865*^9}, {
  3.844250337162695*^9, 3.84425034909442*^9}, {3.844423303881329*^9, 
  3.84442330994595*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"f75367fe-c6db-4440-b71c-044a9d2e71ff"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", "ItrFnMFCheck", "]"}], ";", 
  RowBox[{
   RowBox[{"ItrFnMFCheck", "[", 
    RowBox[{"U_", ",", "fil_", ",", "\[Beta]_", ",", "krange_"}], "]"}], ":=",
    " ", 
   RowBox[{
    RowBox[{"ItrFnMFCheck", "[", 
     RowBox[{"U", ",", "fil", ",", "\[Beta]", ",", "krange"}], "]"}], "=", 
    "  ", 
    RowBox[{"NestList", "[", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"FindMu", "[", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", 
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
           RowBox[{"#", "[", 
            RowBox[{"[", "4", "]"}], "]"}], ",", 
           RowBox[{"#", "[", 
            RowBox[{"[", "5", "]"}], "]"}], ",", "U", ",", "fil", ",", 
           "\[Beta]", ",", "krange"}], "]"}], ",", 
         RowBox[{"nupMF", "[", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", 
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
           RowBox[{"#", "[", 
            RowBox[{"[", "4", "]"}], "]"}], ",", 
           RowBox[{"#", "[", 
            RowBox[{"[", "5", "]"}], "]"}], ",", "U", ",", 
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "\[Beta]", ",", "krange"}], 
          "]"}], ",", 
         RowBox[{"ndnMF", "[", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", 
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
           RowBox[{"#", "[", 
            RowBox[{"[", "4", "]"}], "]"}], ",", 
           RowBox[{"#", "[", 
            RowBox[{"[", "5", "]"}], "]"}], ",", "U", ",", 
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "\[Beta]", ",", "krange"}], 
          "]"}], " ", ",", " ", 
         RowBox[{"splsMF", "[", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", 
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
           RowBox[{"#", "[", 
            RowBox[{"[", "4", "]"}], "]"}], ",", 
           RowBox[{"#", "[", 
            RowBox[{"[", "5", "]"}], "]"}], ",", "U", ",", 
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "\[Beta]", ",", "krange"}], 
          "]"}], ",", 
         RowBox[{"smnsMF", "[", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", 
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
           RowBox[{"#", "[", 
            RowBox[{"[", "4", "]"}], "]"}], ",", 
           RowBox[{"#", "[", 
            RowBox[{"[", "5", "]"}], "]"}], ",", "U", ",", 
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "\[Beta]", ",", "krange"}], 
          "]"}]}], "}"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"U", ",", 
        RowBox[{"RandomReal", "[", "]"}], ",", 
        RowBox[{"RandomReal", "[", "]"}], ",", 
        RowBox[{"RandomReal", "[", "]"}], ",", 
        RowBox[{"RandomReal", "[", "]"}]}], "}"}], ",", "10"}], "]"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.844181251123393*^9, 3.844181297226589*^9}, {
  3.844181503595025*^9, 3.8441816932211*^9}, {3.844182395042077*^9, 
  3.8441823963267937`*^9}, {3.8442470783294983`*^9, 3.844247096635865*^9}, {
  3.844248815369299*^9, 3.844248825135146*^9}, {3.844248920905835*^9, 
  3.84424892388699*^9}, {3.8442503532546463`*^9, 3.844250365412775*^9}, {
  3.844250510698724*^9, 3.844250531181822*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"054e3b76-e779-4c61-8e1b-a447221687a3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"U", "=", "0.0"}], ",", 
     RowBox[{"fil", "=", "0.7"}], ",", " ", 
     RowBox[{"\[Beta]", "=", "100"}], ",", " ", 
     RowBox[{"krange", "=", "30"}]}], "}"}], ",", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"itr", "=", 
       RowBox[{"ItrFnMFCheck", "[", 
        RowBox[{"U", ",", "fil", ",", "\[Beta]", ",", "krange"}], "]"}]}], 
      "}"}], ",", " ", "itr"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.844183122234922*^9, 3.8441831562302637`*^9}, {
   3.844183186945485*^9, 3.84418320475804*^9}, {3.844243950726796*^9, 
   3.844243951073165*^9}, {3.844243984522008*^9, 3.844243986149353*^9}, {
   3.844244141560079*^9, 3.84424414186125*^9}, {3.844247196500412*^9, 
   3.844247201035017*^9}, {3.844247234800523*^9, 3.844247235774076*^9}, {
   3.844248021092081*^9, 3.8442480426942472`*^9}, 3.844248266084436*^9, {
   3.844248828576066*^9, 3.8442488297553787`*^9}, {3.844248904464493*^9, 
   3.84424890505888*^9}, {3.844248952557397*^9, 3.844248953147929*^9}, {
   3.8442490041521873`*^9, 3.844249004315577*^9}, {3.844250375195917*^9, 
   3.844250382595174*^9}, {3.844250550353443*^9, 3.8442505509111843`*^9}, 
   3.844250605862742*^9, {3.844250646760456*^9, 3.844250682170951*^9}, 
   3.8442578252212467`*^9, 3.844258214369657*^9, 3.844258606382092*^9, {
   3.844258755033504*^9, 3.844258755366727*^9}, 3.844258925198661*^9, {
   3.844258963678175*^9, 3.844258975414447*^9}, {3.8442590108075333`*^9, 
   3.844259011405119*^9}, 3.844260453225614*^9, 3.844261285674708*^9},
 CellLabel->"In[25]:=",ExpressionUUID->"1a34ca2d-03b6-4810-92d6-2ee01e17111f"],

Cell[BoxData[
 TemplateBox[{
  "General", "munfl", 
   "\"\\!\\(\\*RowBox[{\\\"2.54266749813943177145172172`13.086417728946705*^-\
321\\\"}]\\) is too small to represent as a normalized machine number; \
precision may be lost.\"", 2, 25, 1, 24811194428503911372, "D1"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.8442612757188807`*^9, 3.8442612863592463`*^9}, 
   3.844423014122666*^9},
 CellLabel->
  "During evaluation of \
In[25]:=",ExpressionUUID->"79829243-8e94-4385-89c7-0eb1eebdd0bb"],

Cell[BoxData[
 TemplateBox[{
  "General", "munfl", 
   "\"\\!\\(\\*RowBox[{\\\"4.401912821049206323074829471`13.062999739115066*^-\
339\\\"}]\\) is too small to represent as a normalized machine number; \
precision may be lost.\"", 2, 25, 2, 24811194428503911372, "D1"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.8442612757188807`*^9, 3.8442612863592463`*^9}, 
   3.844423014156356*^9},
 CellLabel->
  "During evaluation of \
In[25]:=",ExpressionUUID->"b2dadbe5-9fc1-4bf2-a088-f83193f5ddda"],

Cell[BoxData[
 TemplateBox[{
  "General", "munfl", 
   "\"\\!\\(\\*RowBox[{\\\"3.0562404373219765612320244784`13.040296502855641*^\
-357\\\"}]\\) is too small to represent as a normalized machine number; \
precision may be lost.\"", 2, 25, 3, 24811194428503911372, "D1"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.8442612757188807`*^9, 3.8442612863592463`*^9}, 
   3.8444230141677837`*^9},
 CellLabel->
  "During evaluation of \
In[25]:=",ExpressionUUID->"f37ae354-2d75-44c1-82f9-3c674305ef9a"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"General\\\", \
\\\"::\\\", \\\"munfl\\\"}], \\\"MessageName\\\"]\\) will be suppressed \
during this calculation.\"", 2, 25, 4, 24811194428503911372, "D1"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.8442612757188807`*^9, 3.8442612863592463`*^9}, 
   3.844423014177411*^9},
 CellLabel->
  "During evaluation of \
In[25]:=",ExpressionUUID->"10e038f8-4307-407e-be9d-2b98df7f5ae3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0.`", ",", "0.4166808490185605`", ",", "0.14421938485485075`", ",", 
     "0.37814648332084766`", ",", "0.3638196462777674`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.7310997039471169`"}], ",", "0.4999999999999938`", ",", 
     "0.4999999999999938`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.7310997039471169`"}], ",", "0.3499999988285654`", ",", 
     "0.3499999988285654`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.7310997039471169`"}], ",", "0.3499999988285654`", ",", 
     "0.3499999988285654`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.7310997039471169`"}], ",", "0.3499999988285654`", ",", 
     "0.3499999988285654`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.7310997039471169`"}], ",", "0.3499999988285654`", ",", 
     "0.3499999988285654`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.7310997039471169`"}], ",", "0.3499999988285654`", ",", 
     "0.3499999988285654`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.7310997039471169`"}], ",", "0.3499999988285654`", ",", 
     "0.3499999988285654`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.7310997039471169`"}], ",", "0.3499999988285654`", ",", 
     "0.3499999988285654`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.7310997039471169`"}], ",", "0.3499999988285654`", ",", 
     "0.3499999988285654`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.7310997039471169`"}], ",", "0.3499999988285654`", ",", 
     "0.3499999988285654`", ",", "0.`", ",", "0.`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.844250479857129*^9, {3.844250520742049*^9, 3.844250557593356*^9}, {
   3.8442505976431007`*^9, 3.844250607971716*^9}, {3.8442506482086697`*^9, 
   3.8442506887643127`*^9}, 3.844250754629023*^9, 3.844257653424852*^9, 
   3.8442577738819323`*^9, 3.844257826959338*^9, {3.844258207012218*^9, 
   3.844258232757441*^9}, {3.8442586090820637`*^9, 3.8442586518511267`*^9}, 
   3.8442587656327343`*^9, 3.844258811740774*^9, 3.844258853725933*^9, {
   3.84425891142848*^9, 3.844258934731*^9}, {3.844258967231769*^9, 
   3.844258985205765*^9}, 3.8442590228142548`*^9, 3.844260456764968*^9, 
   3.844261078476955*^9, {3.844261278935226*^9, 3.8442612889418373`*^9}, 
   3.844423017641409*^9},
 CellLabel->"Out[25]=",ExpressionUUID->"564270f8-8776-49dd-8ea9-83209f296d47"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NumEq", "[", 
  RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0.0", ",", 
   RowBox[{"-", "0.7310997039471169`"}], ",", "100", ",", "30"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.84426109187846*^9, 3.844261108400998*^9}, {
  3.8444230262120934`*^9, 3.844423028665244*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"d95843cd-7b36-4ba1-ae9e-32b564fdd895"],

Cell[BoxData["0.6999999976571308`"], "Output",
 CellChangeTimes->{{3.844261109069622*^9, 3.8442611130922422`*^9}, {
  3.844261279007522*^9, 3.8442612824962893`*^9}, {3.844423020193129*^9, 
  3.844423029290247*^9}},
 CellLabel->"Out[27]=",ExpressionUUID->"8fe96d97-8b24-4623-9f7d-ec2de1eb2c25"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fil", "=", "0.7"}], ",", " ", 
     RowBox[{"\[Beta]", "=", "100"}], ",", " ", 
     RowBox[{"krange", "=", "30"}]}], "}"}], ",", 
   RowBox[{"DiscretePlot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ItrFnMF", "[", 
       RowBox[{"U", ",", "fil", ",", "\[Beta]", ",", "krange"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"U", ",", "0", ",", "1", ",", "0.1"}], "}"}]}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.844183122234922*^9, 3.8441831562302637`*^9}, {
   3.844183186945485*^9, 3.84418320475804*^9}, {3.844243950726796*^9, 
   3.844243951073165*^9}, {3.844243984522008*^9, 3.844243986149353*^9}, {
   3.844244141560079*^9, 3.84424414186125*^9}, {3.844247196500412*^9, 
   3.844247201035017*^9}, {3.844247234800523*^9, 3.844247235774076*^9}, {
   3.844248021092081*^9, 3.8442480426942472`*^9}, 3.844248266084436*^9, {
   3.844248828576066*^9, 3.8442488297553787`*^9}, {3.844248904464493*^9, 
   3.84424890505888*^9}, {3.844248952557397*^9, 3.844248953147929*^9}, {
   3.8442490041521873`*^9, 3.844249004315577*^9}, {3.844250375195917*^9, 
   3.844250382595174*^9}, {3.844250550353443*^9, 3.8442505509111843`*^9}, 
   3.844250605862742*^9, {3.844250646760456*^9, 3.844250682170951*^9}, 
   3.8442578252212467`*^9, 3.844258214369657*^9, 3.844258606382092*^9, {
   3.844258755033504*^9, 3.844258755366727*^9}, 3.844258925198661*^9, {
   3.844258963678175*^9, 3.844258975414447*^9}, {3.8442590108075333`*^9, 
   3.844259011405119*^9}, 3.844260453225614*^9, 3.844261285674708*^9, {
   3.844423044190209*^9, 3.844423088044482*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"e8ea4a86-2fc0-4386-b6bc-98771ddb6169"],

Cell[BoxData[
 GraphicsBox[{{
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.012833333333333334`],
      AbsoluteThickness[1.6], 
     TagBox[{},
      Annotation[#, "Charting`Private`Tag$171058#1"]& ]}, 
    TagBox[
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
      0.012833333333333334`], AbsoluteThickness[1.6], 
      LineBox[{{{0., -0.7310997039471169}, {0.1, -0.6960996952944009}, {
       0.2, -0.6610999786934696}, {0.30000000000000004`, -0.62610024164208}, {
       0.4, -0.5911038324815251}, {0.5, -0.5561171283371539}, {
       0.6000000000000001, -0.5211324971998668}, {
       0.7000000000000001, -0.48621753360149395`}, {
       0.8, -0.45120353017993436`}, {0.9, -0.4164523229760213}, {
       1., -0.3816188284780131}}}], {}, {}},
     Annotation[#, "Charting`Private`Tag$171058#1"]& ]}, {}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesOrigin->{0, -0.7310997039471169},
  DisplayFunction->Identity,
  Frame->True,
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImageSize->Medium,
  LabelStyle->{FontSize -> 18, FontFamily -> "Times", 
    GrayLevel[0]},
  Method->{
   "MessagesHead" -> DiscretePlot, "AxisPadding" -> Scaled[0.02], 
    "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "DefaultPlotStyle" -> {
      Directive[
       RGBColor[0.368417, 0.506779, 0.709798], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.880722, 0.611041, 0.142051], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.560181, 0.691569, 0.194885], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.922526, 0.385626, 0.209179], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.528488, 0.470624, 0.701351], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.772079, 0.431554, 0.102387], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.363898, 0.618501, 0.782349], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[1, 0.75, 0], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.647624, 0.37816, 0.614037], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.571589, 0.586483, 0.], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.915, 0.3325, 0.2125], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.40082222609352647`, 0.5220066643438841, 0.85], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.9728288904374106, 0.621644452187053, 0.07336199581899142], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.736782672705901, 0.358, 0.5030266573755369], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.28026441037696703`, 0.715, 0.4292089322474965], 
       AbsoluteThickness[1.6]]}, "DomainPadding" -> Scaled[0.02], 
    "PointSizeFunction" -> "SmallPointSize", "RangePadding" -> Scaled[0.05]},
  PlotRange->{{0., 1.}, {-0.7310997039471169, -0.3816188284780131}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.8444230703699427`*^9, 3.8444230863879004`*^9}, {
   3.844423232214717*^9, 3.8444232474404707`*^9}, 3.844423299080162*^9, 
   3.844423416067539*^9},
 CellLabel->"Out[35]=",ExpressionUUID->"51bcdeb9-de90-480d-9e92-c6e5b71fdc29"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fil", "=", "1.0"}], ",", " ", 
     RowBox[{"\[Beta]", "=", "100"}], ",", " ", 
     RowBox[{"krange", "=", "30"}]}], "}"}], ",", 
   RowBox[{"DiscretePlot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ItrFnMF", "[", 
       RowBox[{"U", ",", "fil", ",", "\[Beta]", ",", "krange"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"U", ",", "0", ",", "1", ",", "0.1"}], "}"}]}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.844183122234922*^9, 3.8441831562302637`*^9}, {
   3.844183186945485*^9, 3.84418320475804*^9}, {3.844243950726796*^9, 
   3.844243951073165*^9}, {3.844243984522008*^9, 3.844243986149353*^9}, {
   3.844244141560079*^9, 3.84424414186125*^9}, {3.844247196500412*^9, 
   3.844247201035017*^9}, {3.844247234800523*^9, 3.844247235774076*^9}, {
   3.844248021092081*^9, 3.8442480426942472`*^9}, 3.844248266084436*^9, {
   3.844248828576066*^9, 3.8442488297553787`*^9}, {3.844248904464493*^9, 
   3.84424890505888*^9}, {3.844248952557397*^9, 3.844248953147929*^9}, {
   3.8442490041521873`*^9, 3.844249004315577*^9}, {3.844250375195917*^9, 
   3.844250382595174*^9}, {3.844250550353443*^9, 3.8442505509111843`*^9}, 
   3.844250605862742*^9, {3.844250646760456*^9, 3.844250682170951*^9}, 
   3.8442578252212467`*^9, 3.844258214369657*^9, 3.844258606382092*^9, {
   3.844258755033504*^9, 3.844258755366727*^9}, 3.844258925198661*^9, {
   3.844258963678175*^9, 3.844258975414447*^9}, {3.8442590108075333`*^9, 
   3.844259011405119*^9}, 3.844260453225614*^9, 3.844261285674708*^9, {
   3.844423044190209*^9, 3.8444230907077703`*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"4aebd10d-2dfd-4fcb-b0f5-b862ae6ebca7"],

Cell[BoxData[
 GraphicsBox[{{
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.012833333333333334`],
      AbsoluteThickness[1.6], 
     TagBox[{},
      Annotation[#, "Charting`Private`Tag$902929#1"]& ]}, 
    TagBox[
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
      0.012833333333333334`], AbsoluteThickness[1.6], 
      LineBox[{{{0., 5.660376673023012*^-13}, {0.1, 0.04999711693742268}, {
       0.2, 0.09917394196260473}, {0.30000000000000004`, 
       0.14840347844727148`}, {0.4, 0.1925400652901827}, {0.5, 
       0.2352826798056323}, {0.6000000000000001, 0.28029972274656323`}, {
       0.7000000000000001, 0.3258715106355184}, {0.8, 0.37158213434993176`}, {
       0.9, 0.4174825628031221}, {1., 0.46357576515290466`}}}], {}, {}},
     Annotation[#, "Charting`Private`Tag$902929#1"]& ]}, {}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->True,
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImageSize->Medium,
  LabelStyle->{FontSize -> 18, FontFamily -> "Times", 
    GrayLevel[0]},
  Method->{
   "MessagesHead" -> DiscretePlot, "AxisPadding" -> Scaled[0.02], 
    "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "DefaultPlotStyle" -> {
      Directive[
       RGBColor[0.368417, 0.506779, 0.709798], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.880722, 0.611041, 0.142051], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.560181, 0.691569, 0.194885], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.922526, 0.385626, 0.209179], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.528488, 0.470624, 0.701351], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.772079, 0.431554, 0.102387], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.363898, 0.618501, 0.782349], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[1, 0.75, 0], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.647624, 0.37816, 0.614037], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.571589, 0.586483, 0.], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.915, 0.3325, 0.2125], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.40082222609352647`, 0.5220066643438841, 0.85], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.9728288904374106, 0.621644452187053, 0.07336199581899142], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.736782672705901, 0.358, 0.5030266573755369], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.28026441037696703`, 0.715, 0.4292089322474965], 
       AbsoluteThickness[1.6]]}, "DomainPadding" -> Scaled[0.02], 
    "PointSizeFunction" -> "SmallPointSize", "RangePadding" -> Scaled[0.05]},
  PlotRange->{{0., 1.}, {0, 0.46357576515290466`}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{3.8444243750564404`*^9},
 CellLabel->"Out[36]=",ExpressionUUID->"6f2b41b5-9673-4e0c-88f0-aef45d2ffd23"]
}, Open  ]]
}, Open  ]]
},
Evaluator->"D1",
WindowSize->{808, 596},
WindowMargins->{{20, Automatic}, {Automatic, 44}},
FrontEndVersion->"12.3 for Mac OS X x86 (64-bit) (July 9, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"c1234971-8b07-482c-bf2b-0c0797d153c1"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 175, 3, 35, "Text",ExpressionUUID->"2b27f0d7-8173-4305-8b3b-7b0527f38ef0"],
Cell[CellGroupData[{
Cell[758, 27, 159, 3, 54, "Subsection",ExpressionUUID->"c9750e18-84bd-4320-b6b9-c16a14fe9039"],
Cell[920, 32, 171, 3, 35, "Text",ExpressionUUID->"963bec2e-ee12-4f45-915f-5c34b171b375"],
Cell[1094, 37, 1411, 33, 115, "Input",ExpressionUUID->"167ed483-f1d9-41fc-baa8-0dfc1d0eeb06"],
Cell[2508, 72, 1140, 27, 94, "Input",ExpressionUUID->"e6e14c0c-c5ec-45e7-8257-0f4e2f9ff439"],
Cell[3651, 101, 1317, 28, 94, "Input",ExpressionUUID->"609e0fef-4a8b-4927-9a42-693e445a7aca"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5005, 134, 158, 3, 54, "Subsection",ExpressionUUID->"7d7b0e6f-4b4f-4524-ac55-a1170003e310"],
Cell[5166, 139, 199, 3, 35, "Text",ExpressionUUID->"f51f806c-460c-46f2-9ea6-a5ab122cb254"],
Cell[5368, 144, 706, 14, 30, "Input",ExpressionUUID->"864772d7-e983-4e5b-a538-6cc0696b44fc"],
Cell[6077, 160, 170, 3, 35, "Text",ExpressionUUID->"37234416-b18d-440d-a2b6-050d76ab78ce"],
Cell[6250, 165, 774, 21, 94, "Input",ExpressionUUID->"b707e040-a6ef-4acf-8e07-2cd9d8c55eed"],
Cell[7027, 188, 220, 5, 35, "Text",ExpressionUUID->"ac8bd3e2-49eb-4447-87cb-e970c49f683d"],
Cell[7250, 195, 752, 20, 52, "Input",ExpressionUUID->"da305296-ea08-4266-bf21-0312b3c45702"],
Cell[8005, 217, 873, 23, 73, "Input",ExpressionUUID->"16e791ca-8401-4798-84d5-6e029b48a920"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8915, 245, 165, 3, 54, "Subsection",ExpressionUUID->"ccd39444-a18b-43d4-a06d-7a049b5a2a4c"],
Cell[9083, 250, 2151, 39, 30, "Input",ExpressionUUID->"183cff9e-fb05-4bb6-9dd9-3e1e73f94c58"],
Cell[11237, 291, 1147, 27, 73, "Input",ExpressionUUID->"479296fa-05be-4331-acce-897984005df4"],
Cell[12387, 320, 1342, 29, 94, "Input",ExpressionUUID->"e77669d5-788e-4b50-bfb5-78f288a5a396"],
Cell[13732, 351, 2506, 45, 94, "Input",ExpressionUUID->"09488173-293c-4033-99ce-bf3f35c6b973"],
Cell[16241, 398, 1394, 32, 178, "Input",ExpressionUUID->"3abd47ca-0f71-4875-89c4-af38cac07d17"],
Cell[17638, 432, 757, 20, 73, "Input",ExpressionUUID->"a0c3c7e7-d6cf-447a-bdcd-043f0555da2c"],
Cell[18398, 454, 2970, 66, 179, "Input",ExpressionUUID->"94695af1-3ebe-4eeb-83f8-8d992236d6c0"],
Cell[21371, 522, 2957, 67, 179, "Input",ExpressionUUID->"75858435-8f2c-4b7e-81a1-927273041fa7"],
Cell[24331, 591, 2847, 66, 179, "Input",ExpressionUUID->"2b10e82e-2d65-42f5-8a3e-21d605205d4e"],
Cell[27181, 659, 2711, 63, 179, "Input",ExpressionUUID->"a267bd39-ae6b-4e3e-95ce-5202e655bc60"],
Cell[29895, 724, 1668, 39, 137, "Input",ExpressionUUID->"c795fa47-334c-47a5-9865-366e59efb9bf"],
Cell[31566, 765, 1462, 33, 115, "Input",ExpressionUUID->"09411c75-cfd8-4738-94bf-516c7eed4c89"],
Cell[33031, 800, 3776, 92, 199, "Input",ExpressionUUID->"f75367fe-c6db-4440-b71c-044a9d2e71ff"],
Cell[36810, 894, 3761, 92, 199, "Input",ExpressionUUID->"054e3b76-e779-4c61-8e1b-a447221687a3"],
Cell[CellGroupData[{
Cell[40596, 990, 1688, 31, 52, "Input",ExpressionUUID->"1a34ca2d-03b6-4810-92d6-2ee01e17111f"],
Cell[42287, 1023, 511, 11, 46, "Message",ExpressionUUID->"79829243-8e94-4385-89c7-0eb1eebdd0bb"],
Cell[42801, 1036, 512, 11, 46, "Message",ExpressionUUID->"b2dadbe5-9fc1-4bf2-a088-f83193f5ddda"],
Cell[43316, 1049, 515, 11, 46, "Message",ExpressionUUID->"f37ae354-2d75-44c1-82f9-3c674305ef9a"],
Cell[43834, 1062, 503, 11, 28, "Message",ExpressionUUID->"10e038f8-4307-407e-be9d-2b98df7f5ae3"],
Cell[44340, 1075, 2756, 59, 140, "Output",ExpressionUUID->"564270f8-8776-49dd-8ea9-83209f296d47"]
}, Open  ]],
Cell[CellGroupData[{
Cell[47133, 1139, 381, 7, 30, "Input",ExpressionUUID->"d95843cd-7b36-4ba1-ae9e-32b564fdd895"],
Cell[47517, 1148, 293, 4, 34, "Output",ExpressionUUID->"8fe96d97-8b24-4623-9f7d-ec2de1eb2c25"]
}, Open  ]],
Cell[CellGroupData[{
Cell[47847, 1157, 1771, 33, 52, "Input",ExpressionUUID->"e8ea4a86-2fc0-4386-b6bc-98771ddb6169"],
Cell[49621, 1192, 3879, 97, 229, "Output",ExpressionUUID->"51bcdeb9-de90-480d-9e92-c6e5b71fdc29"]
}, Open  ]],
Cell[CellGroupData[{
Cell[53537, 1294, 1773, 33, 52, "Input",ExpressionUUID->"4aebd10d-2dfd-4fcb-b0f5-b862ae6ebca7"],
Cell[55313, 1329, 3711, 94, 242, "Output",ExpressionUUID->"6f2b41b5-9673-4e0c-88f0-aef45d2ffd23"]
}, Open  ]]
}, Open  ]]
}
]
*)

